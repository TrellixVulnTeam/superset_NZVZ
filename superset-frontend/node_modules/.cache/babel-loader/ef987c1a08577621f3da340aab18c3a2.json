{"ast":null,"code":"import { css as _css } from \"@emotion/react\"; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { styled, t, SupersetClient, css } from '@superset-ui/core';\nimport rison from 'rison';\nimport { useSingleViewResource } from 'src/views/CRUD/hooks';\nimport Icons from 'src/components/Icons';\nimport { Switch } from 'src/components/Switch';\nimport Modal from 'src/components/Modal';\nimport TimezoneSelector from 'src/components/TimezoneSelector';\nimport { Radio } from 'src/components/Radio';\nimport { Select } from 'src/components';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport TextAreaControl from 'src/explore/components/controls/TextAreaControl';\nimport { useCommonConf } from 'src/views/CRUD/data/database/state';\nimport { AlertReportCronScheduler } from './components/AlertReportCronScheduler';\nimport { NotificationMethod } from './components/NotificationMethod';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst TIMEOUT_MIN = 1;\nconst TEXT_BASED_VISUALIZATION_TYPES = [\n'pivot_table',\n'pivot_table_v2',\n'table',\n'paired_ttest'];\n\nconst DEFAULT_NOTIFICATION_METHODS = ['Email'];\nconst DEFAULT_NOTIFICATION_FORMAT = 'PNG';\nconst CONDITIONS = [\n{\n  label: t('< (Smaller than)'),\n  value: '<' },\n\n{\n  label: t('> (Larger than)'),\n  value: '>' },\n\n{\n  label: t('<= (Smaller or equal)'),\n  value: '<=' },\n\n{\n  label: t('>= (Larger or equal)'),\n  value: '>=' },\n\n{\n  label: t('== (Is equal)'),\n  value: '==' },\n\n{\n  label: t('!= (Is not equal)'),\n  value: '!=' },\n\n{\n  label: t('Not null'),\n  value: 'not null' }];\n\n\nconst RETENTION_OPTIONS = [\n{\n  label: t('None'),\n  value: 0 },\n\n{\n  label: t('30 days'),\n  value: 30 },\n\n{\n  label: t('60 days'),\n  value: 60 },\n\n{\n  label: t('90 days'),\n  value: 90 }];\n\n\nconst DEFAULT_RETENTION = 90;\nconst DEFAULT_WORKING_TIMEOUT = 3600;\nconst DEFAULT_CRON_VALUE = '0 * * * *'; // every hour\nconst DEFAULT_ALERT = {\n  active: true,\n  creation_method: 'alerts_reports',\n  crontab: DEFAULT_CRON_VALUE,\n  log_retention: DEFAULT_RETENTION,\n  working_timeout: DEFAULT_WORKING_TIMEOUT,\n  name: '',\n  owners: [],\n  recipients: [],\n  sql: '',\n  validator_config_json: {},\n  validator_type: '',\n  grace_period: undefined };\n\nconst StyledModal = styled(Modal)`\n  .ant-modal-body {\n    overflow: initial;\n  }\n`;\nconst StyledIcon = (theme) => css`\n  margin: auto ${theme.gridUnit * 2}px auto 0;\n  color: ${theme.colors.grayscale.base};\n`;\nconst StyledSectionContainer = styled.div`\n  display: flex;\n  min-width: 1000px;\n  flex-direction: column;\n\n  .header-section {\n    display: flex;\n    flex: 0 0 auto;\n    align-items: center;\n    width: 100%;\n    padding: ${({ theme }) => theme.gridUnit * 4}px;\n    border-bottom: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n  }\n\n  .column-section {\n    display: flex;\n    flex: 1 1 auto;\n\n    .column {\n      flex: 1 1 auto;\n      min-width: calc(33.33% - ${({ theme }) => theme.gridUnit * 8}px);\n      padding: ${({ theme }) => theme.gridUnit * 4}px;\n\n      .async-select {\n        margin: 10px 0 20px;\n      }\n\n      &.condition {\n        border-right: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n      }\n\n      &.message {\n        border-left: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n      }\n    }\n  }\n\n  .inline-container {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    &.wrap {\n      flex-wrap: wrap;\n    }\n\n    > div {\n      flex: 1 1 auto;\n    }\n\n    &.add-margin {\n      margin-bottom: 5px;\n    }\n\n    .styled-input {\n      margin: 0 0 0 10px;\n\n      input {\n        flex: 0 0 auto;\n      }\n    }\n  }\n`;\nconst StyledSectionTitle = styled.div`\n  display: flex;\n  align-items: center;\n  margin: ${({ theme }) => theme.gridUnit * 2}px auto\n    ${({ theme }) => theme.gridUnit * 4}px auto;\n\n  h4 {\n    margin: 0;\n  }\n\n  .required {\n    margin-left: ${({ theme }) => theme.gridUnit}px;\n    color: ${({ theme }) => theme.colors.error.base};\n  }\n`;\nconst StyledSwitchContainer = styled.div`\n  display: flex;\n  align-items: center;\n  margin-top: 10px;\n\n  .switch-label {\n    margin-left: 10px;\n  }\n`;\nexport const StyledInputContainer = styled.div`\n  flex: 1;\n  margin: ${({ theme }) => theme.gridUnit * 2}px;\n  margin-top: 0;\n\n  .helper {\n    display: block;\n    color: ${({ theme }) => theme.colors.grayscale.base};\n    font-size: ${({ theme }) => theme.typography.sizes.s - 1}px;\n    padding: ${({ theme }) => theme.gridUnit}px 0;\n    text-align: left;\n  }\n\n  .required {\n    margin-left: ${({ theme }) => theme.gridUnit / 2}px;\n    color: ${({ theme }) => theme.colors.error.base};\n  }\n\n  .input-container {\n    display: flex;\n    align-items: center;\n\n    > div {\n      width: 100%;\n    }\n\n    label {\n      display: flex;\n      margin-right: ${({ theme }) => theme.gridUnit * 2}px;\n    }\n\n    i {\n      margin: 0 ${({ theme }) => theme.gridUnit}px;\n    }\n  }\n\n  input,\n  textarea {\n    flex: 1 1 auto;\n  }\n\n  input[disabled] {\n    color: ${({ theme }) => theme.colors.grayscale.base};\n  }\n\n  textarea {\n    height: 300px;\n    resize: none;\n  }\n\n  input::placeholder,\n  textarea::placeholder {\n    color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n\n  textarea,\n  input[type='text'],\n  input[type='number'] {\n    padding: ${({ theme }) => theme.gridUnit}px\n      ${({ theme }) => theme.gridUnit * 2}px;\n    border-style: none;\n    border: 1px solid ${({ theme }) => theme.colors.grayscale.light2};\n    border-radius: ${({ theme }) => theme.gridUnit}px;\n\n    &[name='description'] {\n      flex: 1 1 auto;\n    }\n  }\n\n  .input-label {\n    margin-left: 10px;\n  }\n`;\nconst StyledRadio = styled(Radio)`\n  display: block;\n  line-height: ${({ theme }) => theme.gridUnit * 7}px;\n`;\nconst StyledRadioGroup = styled(Radio.Group)`\n  margin-left: ${({ theme }) => theme.gridUnit * 5.5}px;\n`;\n// Notification Method components\nconst StyledNotificationAddButton = styled.div`\n  color: ${({ theme }) => theme.colors.primary.dark1};\n  cursor: pointer;\n\n  i {\n    margin-right: ${({ theme }) => theme.gridUnit * 2}px;\n  }\n\n  &.disabled {\n    color: ${({ theme }) => theme.colors.grayscale.light1};\n    cursor: default;\n  }\n`;\nconst timezoneHeaderStyle = (theme) => css`\n  margin: ${theme.gridUnit * 3}px 0;\n`;\nconst NotificationMethodAdd = ({ status = 'active', onClick }) => {\n  if (status === 'hidden') {\n    return null;\n  }\n  const checkStatus = () => {\n    if (status !== 'disabled') {\n      onClick();\n    }\n  };\n  return ___EmotionJSX(StyledNotificationAddButton, { className: status, onClick: checkStatus },\n  ___EmotionJSX(\"i\", { className: \"fa fa-plus\" }), ' ',\n  status === 'active' ?\n  t('Add notification method') :\n  t('Add delivery method'));\n\n};\nconst AlertReportModal = ({ addDangerToast, onAdd, onHide, show, alert = null, isReport = false }) => {var _currentAlert$databas2, _currentAlert$databas3, _currentAlert$validat5, _currentAlert$chart2, _currentAlert$chart3, _currentAlert$dashboa2, _currentAlert$dashboa3;\n  const conf = useCommonConf();\n  const allowedNotificationMethods = (conf == null ? void 0 : conf.ALERT_REPORTS_NOTIFICATION_METHODS) || DEFAULT_NOTIFICATION_METHODS;\n  const [disableSave, setDisableSave] = useState(true);\n  const [currentAlert, setCurrentAlert] = useState();\n  const [isHidden, setIsHidden] = useState(true);\n  const [contentType, setContentType] = useState('dashboard');\n  const [reportFormat, setReportFormat] = useState(DEFAULT_NOTIFICATION_FORMAT);\n  // Dropdown options\n  const [conditionNotNull, setConditionNotNull] = useState(false);\n  const [sourceOptions, setSourceOptions] = useState([]);\n  const [dashboardOptions, setDashboardOptions] = useState([]);\n  const [chartOptions, setChartOptions] = useState([]);\n  // Chart metadata\n  const [chartVizType, setChartVizType] = useState('');\n  const isEditMode = alert !== null;\n  const formatOptionEnabled = contentType === 'chart' && (\n  isFeatureEnabled(FeatureFlag.ALERTS_ATTACH_REPORTS) || isReport);\n  const [notificationAddState, setNotificationAddState] = useState('active');\n  const [notificationSettings, setNotificationSettings] = useState([]);\n  const onNotificationAdd = () => {\n    const settings = notificationSettings.slice();\n    settings.push({\n      recipients: '',\n      options: allowedNotificationMethods });\n\n    setNotificationSettings(settings);\n    setNotificationAddState(settings.length === allowedNotificationMethods.length ?\n    'hidden' :\n    'disabled');\n  };\n  const updateNotificationSetting = (index, setting) => {\n    const settings = notificationSettings.slice();\n    settings[index] = setting;\n    setNotificationSettings(settings);\n    if (setting.method !== undefined && notificationAddState !== 'hidden') {\n      setNotificationAddState('active');\n    }\n  };\n  const removeNotificationSetting = (index) => {\n    const settings = notificationSettings.slice();\n    settings.splice(index, 1);\n    setNotificationSettings(settings);\n    setNotificationAddState('active');\n  };\n  // Alert fetch logic\n  const { state: { loading, resource, error: fetchError }, fetchResource, createResource, updateResource, clearError } = useSingleViewResource('report', t('report'), addDangerToast);\n  // Functions\n  const hide = () => {\n    clearError();\n    setIsHidden(true);\n    onHide();\n    setNotificationSettings([]);\n    setCurrentAlert({ ...DEFAULT_ALERT });\n    setNotificationAddState('active');\n  };\n  const onSave = () => {var _currentAlert$chart, _currentAlert$dashboa, _currentAlert$databas;\n    // Notification Settings\n    const recipients = [];\n    notificationSettings.forEach((setting) => {\n      if (setting.method && setting.recipients.length) {\n        recipients.push({\n          recipient_config_json: {\n            target: setting.recipients },\n\n          type: setting.method });\n\n      }\n    });\n    const data = {\n      ...currentAlert,\n      type: isReport ? 'Report' : 'Alert',\n      validator_type: conditionNotNull ? 'not null' : 'operator',\n      validator_config_json: conditionNotNull ?\n      {} :\n      currentAlert == null ? void 0 : currentAlert.validator_config_json,\n      chart: contentType === 'chart' ? currentAlert == null ? void 0 : (_currentAlert$chart = currentAlert.chart) == null ? void 0 : _currentAlert$chart.value : null,\n      dashboard: contentType === 'dashboard' ? currentAlert == null ? void 0 : (_currentAlert$dashboa = currentAlert.dashboard) == null ? void 0 : _currentAlert$dashboa.value : null,\n      database: currentAlert == null ? void 0 : (_currentAlert$databas = currentAlert.database) == null ? void 0 : _currentAlert$databas.value,\n      owners: ((currentAlert == null ? void 0 : currentAlert.owners) || []).map((owner) => owner.value),\n      recipients,\n      report_format: contentType === 'dashboard' ?\n      DEFAULT_NOTIFICATION_FORMAT :\n      reportFormat || DEFAULT_NOTIFICATION_FORMAT };\n\n    if (data.recipients && !data.recipients.length) {\n      delete data.recipients;\n    }\n    data.context_markdown = 'string';\n    if (isEditMode) {\n      // Edit\n      if (currentAlert && currentAlert.id) {\n        const update_id = currentAlert.id;\n        delete data.id;\n        delete data.created_by;\n        delete data.last_eval_dttm;\n        delete data.last_state;\n        delete data.last_value;\n        delete data.last_value_row_json;\n        updateResource(update_id, data).then((response) => {\n          if (!response) {\n            return;\n          }\n          if (onAdd) {\n            onAdd();\n          }\n          hide();\n        });\n      }\n    } else\n    if (currentAlert) {\n      // Create\n      createResource(data).then((response) => {\n        if (!response) {\n          return;\n        }\n        if (onAdd) {\n          onAdd(response);\n        }\n        hide();\n      });\n    }\n  };\n  // Fetch data to populate form dropdowns\n  const loadOwnerOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({ filter: input, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/owners?q=${query}` }).\n    then((response) => ({\n      data: response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text })),\n\n      totalCount: response.json.count }));\n\n  }, []);\n  const getSourceData = useCallback((db) => {\n    const database = db || (currentAlert == null ? void 0 : currentAlert.database);\n    if (!database || database.label) {\n      return null;\n    }\n    let result;\n    // Cycle through source options to find the selected option\n    sourceOptions.forEach((source) => {\n      if (source.value === database.value || source.value === database.id) {\n        result = source;\n      }\n    });\n    return result;\n  }, [currentAlert == null ? void 0 : currentAlert.database, sourceOptions]);\n  // Updating alert/report state\n  const updateAlertState = (name, value) => {\n    setCurrentAlert((currentAlertData) => ({\n      ...currentAlertData,\n      [name]: value }));\n\n  };\n  const loadSourceOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({ filter: input, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/database?q=${query}` }).\n    then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text }));\n\n      setSourceOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const databaseLabel = currentAlert && currentAlert.database && !currentAlert.database.label;\n  useEffect(() => {\n    // Find source if current alert has one set\n    if (databaseLabel) {\n      updateAlertState('database', getSourceData());\n    }\n  }, [databaseLabel, getSourceData]);\n  const loadDashboardOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({ filter: input, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/dashboard?q=${query}` }).\n    then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text }));\n\n      setDashboardOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const getDashboardData = (db) => {\n    const dashboard = db || (currentAlert == null ? void 0 : currentAlert.dashboard);\n    if (!dashboard || dashboard.label) {\n      return null;\n    }\n    let result;\n    // Cycle through dashboard options to find the selected option\n    dashboardOptions.forEach((dash) => {\n      if (dash.value === dashboard.value || dash.value === dashboard.id) {\n        result = dash;\n      }\n    });\n    return result;\n  };\n  const getChartData = useCallback((chartData) => {\n    const chart = chartData || (currentAlert == null ? void 0 : currentAlert.chart);\n    if (!chart || chart.label) {\n      return null;\n    }\n    let result;\n    // Cycle through chart options to find the selected option\n    chartOptions.forEach((slice) => {\n      if (slice.value === chart.value || slice.value === chart.id) {\n        result = slice;\n      }\n    });\n    return result;\n  }, [chartOptions, currentAlert == null ? void 0 : currentAlert.chart]);\n  const noChartLabel = currentAlert && currentAlert.chart && !currentAlert.chart.label;\n  useEffect(() => {\n    // Find source if current alert has one set\n    if (noChartLabel) {\n      updateAlertState('chart', getChartData());\n    }\n  }, [getChartData, noChartLabel]);\n  const loadChartOptions = useMemo(() => (input = '', page, pageSize) => {\n    const query = rison.encode({ filter: input, page, page_size: pageSize });\n    return SupersetClient.get({\n      endpoint: `/api/v1/report/related/chart?q=${query}` }).\n    then((response) => {\n      const list = response.json.result.map((item) => ({\n        value: item.value,\n        label: item.text }));\n\n      setChartOptions(list);\n      return { data: list, totalCount: response.json.count };\n    });\n  }, []);\n  const getChartVisualizationType = (chart) => SupersetClient.get({\n    endpoint: `/api/v1/chart/${chart.value}` }).\n  then((response) => setChartVizType(response.json.result.viz_type));\n  // Handle input/textarea updates\n  const onTextChange = (event) => {\n    const { target } = event;\n    updateAlertState(target.name, target.value);\n  };\n  const onTimeoutVerifyChange = (event) => {\n    const { target } = event;\n    const value = +target.value;\n    // Need to make sure grace period is not lower than TIMEOUT_MIN\n    if (value === 0) {\n      updateAlertState(target.name, null);\n    } else\n    {\n      updateAlertState(target.name, value ? Math.max(value, TIMEOUT_MIN) : value);\n    }\n  };\n  const onSQLChange = (value) => {\n    updateAlertState('sql', value || '');\n  };\n  const onOwnersChange = (value) => {\n    updateAlertState('owners', value || []);\n  };\n  const onSourceChange = (value) => {\n    updateAlertState('database', value || []);\n  };\n  const onDashboardChange = (dashboard) => {\n    updateAlertState('dashboard', dashboard || undefined);\n    updateAlertState('chart', null);\n  };\n  const onChartChange = (chart) => {\n    getChartVisualizationType(chart);\n    updateAlertState('chart', chart || undefined);\n    updateAlertState('dashboard', null);\n  };\n  const onActiveSwitch = (checked) => {\n    updateAlertState('active', checked);\n  };\n  const onConditionChange = (op) => {var _currentAlert$validat;\n    setConditionNotNull(op === 'not null');\n    const config = {\n      op,\n      threshold: currentAlert ? (_currentAlert$validat =\n      currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat.threshold :\n      undefined };\n\n    updateAlertState('validator_config_json', config);\n  };\n  const onThresholdChange = (event) => {var _currentAlert$validat2;\n    const { target } = event;\n    const config = {\n      op: currentAlert ? (_currentAlert$validat2 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat2.op : undefined,\n      threshold: target.value };\n\n    updateAlertState('validator_config_json', config);\n  };\n  const onLogRetentionChange = (retention) => {\n    updateAlertState('log_retention', retention);\n  };\n  const onTimezoneChange = (timezone) => {\n    updateAlertState('timezone', timezone);\n  };\n  const onContentTypeChange = (event) => {\n    const { target } = event;\n    // Gives time to close the select before changing the type\n    setTimeout(() => setContentType(target.value), 200);\n  };\n  const onFormatChange = (event) => {\n    const { target } = event;\n    setReportFormat(target.value);\n  };\n  // Make sure notification settings has the required info\n  const checkNotificationSettings = () => {\n    if (!notificationSettings.length) {\n      return false;\n    }\n    let hasInfo = false;\n    notificationSettings.forEach((setting) => {var _setting$recipients;\n      if (!!setting.method && (_setting$recipients = setting.recipients) != null && _setting$recipients.length) {\n        hasInfo = true;\n      }\n    });\n    return hasInfo;\n  };\n  const validate = () => {var _currentAlert$name, _currentAlert$owners, _currentAlert$crontab;\n    if (currentAlert && (_currentAlert$name =\n    currentAlert.name) != null && _currentAlert$name.length && (_currentAlert$owners =\n    currentAlert.owners) != null && _currentAlert$owners.length && (_currentAlert$crontab =\n    currentAlert.crontab) != null && _currentAlert$crontab.length &&\n    currentAlert.working_timeout !== undefined && (\n    contentType === 'dashboard' && !!currentAlert.dashboard ||\n    contentType === 'chart' && !!currentAlert.chart) &&\n    checkNotificationSettings()) {var _currentAlert$sql, _currentAlert$validat3, _currentAlert$validat4;\n      if (isReport) {\n        setDisableSave(false);\n      } else\n      if (!!currentAlert.database && (_currentAlert$sql =\n      currentAlert.sql) != null && _currentAlert$sql.length && (\n      conditionNotNull || !!((_currentAlert$validat3 = currentAlert.validator_config_json) != null && _currentAlert$validat3.op)) && (\n      conditionNotNull ||\n      ((_currentAlert$validat4 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat4.threshold) !== undefined)) {\n        setDisableSave(false);\n      } else\n      {\n        setDisableSave(true);\n      }\n    } else\n    {\n      setDisableSave(true);\n    }\n  };\n  // Initialize\n  useEffect(() => {\n    if (isEditMode && (\n    !(currentAlert != null && currentAlert.id) || (alert == null ? void 0 : alert.id) !== currentAlert.id || isHidden && show)) {\n      if (alert && alert.id !== null && !loading && !fetchError) {\n        const id = alert.id || 0;\n        fetchResource(id);\n      }\n    } else\n    if (!isEditMode && (\n    !currentAlert || currentAlert.id || isHidden && show)) {\n      setCurrentAlert({ ...DEFAULT_ALERT });\n      setNotificationSettings([]);\n      setNotificationAddState('active');\n    }\n  }, [alert]);\n  useEffect(() => {\n    if (resource) {\n      // Add notification settings\n      const settings = (resource.recipients || []).map((setting) => {\n        const config = typeof setting.recipient_config_json === 'string' ?\n        JSON.parse(setting.recipient_config_json) :\n        {};\n        return {\n          method: setting.type,\n          // @ts-ignore: Type not assignable\n          recipients: config.target || setting.recipient_config_json,\n          options: allowedNotificationMethods };\n\n      });\n      setNotificationSettings(settings);\n      setNotificationAddState(settings.length === allowedNotificationMethods.length ?\n      'hidden' :\n      'active');\n      setContentType(resource.chart ? 'chart' : 'dashboard');\n      setReportFormat(resource.chart ?\n      resource.report_format || DEFAULT_NOTIFICATION_FORMAT :\n      DEFAULT_NOTIFICATION_FORMAT);\n      const validatorConfig = typeof resource.validator_config_json === 'string' ?\n      JSON.parse(resource.validator_config_json) :\n      resource.validator_config_json;\n      setConditionNotNull(resource.validator_type === 'not null');\n      if (resource.chart) {\n        setChartVizType(resource.chart.viz_type);\n      }\n      setCurrentAlert({\n        ...resource,\n        chart: resource.chart ?\n        getChartData(resource.chart) || {\n          value: resource.chart.id,\n          label: resource.chart.slice_name } :\n\n        undefined,\n        dashboard: resource.dashboard ?\n        getDashboardData(resource.dashboard) || {\n          value: resource.dashboard.id,\n          label: resource.dashboard.dashboard_title } :\n\n        undefined,\n        database: resource.database ?\n        getSourceData(resource.database) || {\n          value: resource.database.id,\n          label: resource.database.database_name } :\n\n        undefined,\n        owners: (resource.owners || []).map((owner) => ({\n          value: owner.id,\n          label: `${owner.first_name} ${owner.last_name}` })),\n\n        // @ts-ignore: Type not assignable\n        validator_config_json: resource.validator_type === 'not null' ?\n        {\n          op: 'not null' } :\n\n        validatorConfig });\n\n    }\n  }, [resource]);\n  // Validation\n  const currentAlertSafe = currentAlert || {};\n  useEffect(() => {\n    validate();\n  }, [\n  currentAlertSafe.name,\n  currentAlertSafe.owners,\n  currentAlertSafe.database,\n  currentAlertSafe.sql,\n  currentAlertSafe.validator_config_json,\n  currentAlertSafe.crontab,\n  currentAlertSafe.working_timeout,\n  currentAlertSafe.dashboard,\n  currentAlertSafe.chart,\n  contentType,\n  notificationSettings,\n  conditionNotNull]);\n\n  // Show/hide\n  if (isHidden && show) {\n    setIsHidden(false);\n  }\n  return ___EmotionJSX(StyledModal, { className: \"no-content-padding\", responsive: true, disablePrimaryButton: disableSave, onHandledPrimaryAction: onSave, onHide: hide, primaryButtonName: isEditMode ? t('Save') : t('Add'), show: show, width: \"100%\", maxWidth: \"1450px\", title: ___EmotionJSX(\"h4\", null,\n    isEditMode ? ___EmotionJSX(Icons.EditAlt, { css: StyledIcon }) : ___EmotionJSX(Icons.PlusLarge, { css: StyledIcon }),\n    isEditMode ?\n    t(`Edit ${isReport ? 'Report' : 'Alert'}`) :\n    t(`Add ${isReport ? 'Report' : 'Alert'}`)) },\n\n  ___EmotionJSX(StyledSectionContainer, null,\n  ___EmotionJSX(\"div\", { className: \"header-section\" },\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  isReport ? t('Report name') : t('Alert name'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"text\", name: \"name\", value: currentAlert ? currentAlert.name : '', placeholder: isReport ? t('Report name') : t('Alert name'), onChange: onTextChange }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Owners'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Owners'), allowClear: true, name: \"owners\", mode: \"multiple\", value: (currentAlert == null ? void 0 : currentAlert.owners) || [], options: loadOwnerOptions, onChange: onOwnersChange }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Description')),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"text\", name: \"description\", value: currentAlert ? currentAlert.description || '' : '', placeholder: t('Description'), onChange: onTextChange }))),\n\n\n  ___EmotionJSX(StyledSwitchContainer, null,\n  ___EmotionJSX(Switch, { onChange: onActiveSwitch, checked: currentAlert ? currentAlert.active : true }),\n  ___EmotionJSX(\"div\", { className: \"switch-label\" }, \"Active\"))),\n\n\n  ___EmotionJSX(\"div\", { className: \"column-section\" },\n  !isReport && ___EmotionJSX(\"div\", { className: \"column condition\" },\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null, t('Alert condition'))),\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Database'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Database'), name: \"source\", value: currentAlert != null && (_currentAlert$databas2 = currentAlert.database) != null && _currentAlert$databas2.label &&\n    currentAlert != null && (_currentAlert$databas3 = currentAlert.database) != null && _currentAlert$databas3.value ?\n    {\n      value: currentAlert.database.value,\n      label: currentAlert.database.label } :\n\n    undefined, options: loadSourceOptions, onChange: onSourceChange }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('SQL Query'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(TextAreaControl, { name: \"sql\", language: \"sql\", offerEditInModal: false, minLines: 15, maxLines: 15, onChange: onSQLChange, readOnly: false, initialValue: resource == null ? void 0 : resource.sql, key: currentAlert == null ? void 0 : currentAlert.id })),\n\n  ___EmotionJSX(\"div\", { className: \"inline-container wrap\" },\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Trigger Alert If...'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Condition'), onChange: onConditionChange, placeholder: \"Condition\", value: (currentAlert == null ? void 0 : (_currentAlert$validat5 = currentAlert.validator_config_json) == null ? void 0 : _currentAlert$validat5.op) || undefined, options: CONDITIONS }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Value'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"number\", name: \"threshold\", disabled: conditionNotNull, value: currentAlert &&\n    currentAlert.validator_config_json &&\n    currentAlert.validator_config_json.threshold !==\n    undefined ?\n    currentAlert.validator_config_json.threshold :\n    '', placeholder: t('Value'), onChange: onThresholdChange }))))),\n\n\n\n\n  ___EmotionJSX(\"div\", { className: \"column schedule\" },\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null,\n  isReport ?\n  t('Report schedule') :\n  t('Alert condition schedule')),\n\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(AlertReportCronScheduler, { value: (currentAlert == null ? void 0 : currentAlert.crontab) || DEFAULT_CRON_VALUE, onChange: (newVal) => updateAlertState('crontab', newVal) }),\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Timezone')),\n  ___EmotionJSX(\"div\", { className: \"input-container\", css: (theme) => timezoneHeaderStyle(theme) },\n  ___EmotionJSX(TimezoneSelector, { onTimezoneChange: onTimezoneChange, timezone: currentAlert == null ? void 0 : currentAlert.timezone })),\n\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null, t('Schedule settings'))),\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Log retention'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(Select, { ariaLabel: t('Log retention'), placeholder: t('Log retention'), onChange: onLogRetentionChange, value: (currentAlert == null ? void 0 : currentAlert.log_retention) || DEFAULT_RETENTION, options: RETENTION_OPTIONS }))),\n\n\n  ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" },\n  t('Working timeout'),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"number\", min: \"1\", name: \"working_timeout\", value: (currentAlert == null ? void 0 : currentAlert.working_timeout) || '', placeholder: t('Time in seconds'), onChange: onTimeoutVerifyChange }),\n  ___EmotionJSX(\"span\", { className: \"input-label\" }, \"seconds\"))),\n\n\n  !isReport && ___EmotionJSX(StyledInputContainer, null,\n  ___EmotionJSX(\"div\", { className: \"control-label\" }, t('Grace period')),\n  ___EmotionJSX(\"div\", { className: \"input-container\" },\n  ___EmotionJSX(\"input\", { type: \"number\", min: \"1\", name: \"grace_period\", value: (currentAlert == null ? void 0 : currentAlert.grace_period) || '', placeholder: t('Time in seconds'), onChange: onTimeoutVerifyChange }),\n  ___EmotionJSX(\"span\", { className: \"input-label\" }, \"seconds\")))),\n\n\n\n  ___EmotionJSX(\"div\", { className: \"column message\" },\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null, t('Message content')),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  ___EmotionJSX(Radio.Group, { onChange: onContentTypeChange, value: contentType },\n  ___EmotionJSX(StyledRadio, { value: \"dashboard\" }, t('Dashboard')),\n  ___EmotionJSX(StyledRadio, { value: \"chart\" }, t('Chart'))),\n\n  ___EmotionJSX(Select, { ariaLabel: t('Chart'), css: /*#__PURE__*/_css({\n      display: contentType === 'chart' ? 'inline' : 'none' }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:AlertReportModal;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9teV9wbHVnaW4vc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL3ZpZXdzL0NSVUQvYWxlcnQvQWxlcnRSZXBvcnRNb2RhbC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBODRCMkMiLCJmaWxlIjoiL2hvbWUvdWJ1bnR1L215X3BsdWdpbi9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvdmlld3MvQ1JVRC9hbGVydC9BbGVydFJlcG9ydE1vZGFsLnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VDYWxsYmFjaywgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBzdHlsZWQsIHQsIFN1cGVyc2V0Q2xpZW50LCBjc3MsIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHJpc29uIGZyb20gJ3Jpc29uJztcbmltcG9ydCB7IHVzZVNpbmdsZVZpZXdSZXNvdXJjZSB9IGZyb20gJ3NyYy92aWV3cy9DUlVEL2hvb2tzJztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQgeyBTd2l0Y2ggfSBmcm9tICdzcmMvY29tcG9uZW50cy9Td2l0Y2gnO1xuaW1wb3J0IE1vZGFsIGZyb20gJ3NyYy9jb21wb25lbnRzL01vZGFsJztcbmltcG9ydCBUaW1lem9uZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL1RpbWV6b25lU2VsZWN0b3InO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgeyBTZWxlY3QgfSBmcm9tICdzcmMvY29tcG9uZW50cyc7XG5pbXBvcnQgeyBGZWF0dXJlRmxhZywgaXNGZWF0dXJlRW5hYmxlZCB9IGZyb20gJ3NyYy9mZWF0dXJlRmxhZ3MnO1xuaW1wb3J0IHdpdGhUb2FzdHMgZnJvbSAnc3JjL2NvbXBvbmVudHMvTWVzc2FnZVRvYXN0cy93aXRoVG9hc3RzJztcbmltcG9ydCBUZXh0QXJlYUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9UZXh0QXJlYUNvbnRyb2wnO1xuaW1wb3J0IHsgdXNlQ29tbW9uQ29uZiB9IGZyb20gJ3NyYy92aWV3cy9DUlVEL2RhdGEvZGF0YWJhc2Uvc3RhdGUnO1xuaW1wb3J0IHsgQWxlcnRSZXBvcnRDcm9uU2NoZWR1bGVyIH0gZnJvbSAnLi9jb21wb25lbnRzL0FsZXJ0UmVwb3J0Q3JvblNjaGVkdWxlcic7XG5pbXBvcnQgeyBOb3RpZmljYXRpb25NZXRob2QgfSBmcm9tICcuL2NvbXBvbmVudHMvTm90aWZpY2F0aW9uTWV0aG9kJztcbmNvbnN0IFRJTUVPVVRfTUlOID0gMTtcbmNvbnN0IFRFWFRfQkFTRURfVklTVUFMSVpBVElPTl9UWVBFUyA9IFtcbiAgICAncGl2b3RfdGFibGUnLFxuICAgICdwaXZvdF90YWJsZV92MicsXG4gICAgJ3RhYmxlJyxcbiAgICAncGFpcmVkX3R0ZXN0Jyxcbl07XG5jb25zdCBERUZBVUxUX05PVElGSUNBVElPTl9NRVRIT0RTID0gWydFbWFpbCddO1xuY29uc3QgREVGQVVMVF9OT1RJRklDQVRJT05fRk9STUFUID0gJ1BORyc7XG5jb25zdCBDT05ESVRJT05TID0gW1xuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJzwgKFNtYWxsZXIgdGhhbiknKSxcbiAgICAgICAgdmFsdWU6ICc8JyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJz4gKExhcmdlciB0aGFuKScpLFxuICAgICAgICB2YWx1ZTogJz4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnPD0gKFNtYWxsZXIgb3IgZXF1YWwpJyksXG4gICAgICAgIHZhbHVlOiAnPD0nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnPj0gKExhcmdlciBvciBlcXVhbCknKSxcbiAgICAgICAgdmFsdWU6ICc+PScsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCc9PSAoSXMgZXF1YWwpJyksXG4gICAgICAgIHZhbHVlOiAnPT0nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnIT0gKElzIG5vdCBlcXVhbCknKSxcbiAgICAgICAgdmFsdWU6ICchPScsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCdOb3QgbnVsbCcpLFxuICAgICAgICB2YWx1ZTogJ25vdCBudWxsJyxcbiAgICB9LFxuXTtcbmNvbnN0IFJFVEVOVElPTl9PUFRJT05TID0gW1xuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJ05vbmUnKSxcbiAgICAgICAgdmFsdWU6IDAsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCczMCBkYXlzJyksXG4gICAgICAgIHZhbHVlOiAzMCxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJzYwIGRheXMnKSxcbiAgICAgICAgdmFsdWU6IDYwLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnOTAgZGF5cycpLFxuICAgICAgICB2YWx1ZTogOTAsXG4gICAgfSxcbl07XG5jb25zdCBERUZBVUxUX1JFVEVOVElPTiA9IDkwO1xuY29uc3QgREVGQVVMVF9XT1JLSU5HX1RJTUVPVVQgPSAzNjAwO1xuY29uc3QgREVGQVVMVF9DUk9OX1ZBTFVFID0gJzAgKiAqICogKic7IC8vIGV2ZXJ5IGhvdXJcbmNvbnN0IERFRkFVTFRfQUxFUlQgPSB7XG4gICAgYWN0aXZlOiB0cnVlLFxuICAgIGNyZWF0aW9uX21ldGhvZDogJ2FsZXJ0c19yZXBvcnRzJyxcbiAgICBjcm9udGFiOiBERUZBVUxUX0NST05fVkFMVUUsXG4gICAgbG9nX3JldGVudGlvbjogREVGQVVMVF9SRVRFTlRJT04sXG4gICAgd29ya2luZ190aW1lb3V0OiBERUZBVUxUX1dPUktJTkdfVElNRU9VVCxcbiAgICBuYW1lOiAnJyxcbiAgICBvd25lcnM6IFtdLFxuICAgIHJlY2lwaWVudHM6IFtdLFxuICAgIHNxbDogJycsXG4gICAgdmFsaWRhdG9yX2NvbmZpZ19qc29uOiB7fSxcbiAgICB2YWxpZGF0b3JfdHlwZTogJycsXG4gICAgZ3JhY2VfcGVyaW9kOiB1bmRlZmluZWQsXG59O1xuY29uc3QgU3R5bGVkTW9kYWwgPSBzdHlsZWQoTW9kYWwpIGBcbiAgLmFudC1tb2RhbC1ib2R5IHtcbiAgICBvdmVyZmxvdzogaW5pdGlhbDtcbiAgfVxuYDtcbmNvbnN0IFN0eWxlZEljb24gPSAodGhlbWUpID0+IGNzcyBgXG4gIG1hcmdpbjogYXV0byAke3RoZW1lLmdyaWRVbml0ICogMn1weCBhdXRvIDA7XG4gIGNvbG9yOiAke3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG5gO1xuY29uc3QgU3R5bGVkU2VjdGlvbkNvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBkaXNwbGF5OiBmbGV4O1xuICBtaW4td2lkdGg6IDEwMDBweDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblxuICAuaGVhZGVyLXNlY3Rpb24ge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleDogMCAwIGF1dG87XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBwYWRkaW5nOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gIH1cblxuICAuY29sdW1uLXNlY3Rpb24ge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleDogMSAxIGF1dG87XG5cbiAgICAuY29sdW1uIHtcbiAgICAgIGZsZXg6IDEgMSBhdXRvO1xuICAgICAgbWluLXdpZHRoOiBjYWxjKDMzLjMzJSAtICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA4fXB4KTtcbiAgICAgIHBhZGRpbmc6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA0fXB4O1xuXG4gICAgICAuYXN5bmMtc2VsZWN0IHtcbiAgICAgICAgbWFyZ2luOiAxMHB4IDAgMjBweDtcbiAgICAgIH1cblxuICAgICAgJi5jb25kaXRpb24ge1xuICAgICAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbiAgICAgIH1cblxuICAgICAgJi5tZXNzYWdlIHtcbiAgICAgICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAuaW5saW5lLWNvbnRhaW5lciB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgJi53cmFwIHtcbiAgICAgIGZsZXgtd3JhcDogd3JhcDtcbiAgICB9XG5cbiAgICA+IGRpdiB7XG4gICAgICBmbGV4OiAxIDEgYXV0bztcbiAgICB9XG5cbiAgICAmLmFkZC1tYXJnaW4ge1xuICAgICAgbWFyZ2luLWJvdHRvbTogNXB4O1xuICAgIH1cblxuICAgIC5zdHlsZWQtaW5wdXQge1xuICAgICAgbWFyZ2luOiAwIDAgMCAxMHB4O1xuXG4gICAgICBpbnB1dCB7XG4gICAgICAgIGZsZXg6IDAgMCBhdXRvO1xuICAgICAgfVxuICAgIH1cbiAgfVxuYDtcbmNvbnN0IFN0eWxlZFNlY3Rpb25UaXRsZSA9IHN0eWxlZC5kaXYgYFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBtYXJnaW46ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4IGF1dG9cbiAgICAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weCBhdXRvO1xuXG4gIGg0IHtcbiAgICBtYXJnaW46IDA7XG4gIH1cblxuICAucmVxdWlyZWQge1xuICAgIG1hcmdpbi1sZWZ0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5lcnJvci5iYXNlfTtcbiAgfVxuYDtcbmNvbnN0IFN0eWxlZFN3aXRjaENvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBtYXJnaW4tdG9wOiAxMHB4O1xuXG4gIC5zd2l0Y2gtbGFiZWwge1xuICAgIG1hcmdpbi1sZWZ0OiAxMHB4O1xuICB9XG5gO1xuZXhwb3J0IGNvbnN0IFN0eWxlZElucHV0Q29udGFpbmVyID0gc3R5bGVkLmRpdiBgXG4gIGZsZXg6IDE7XG4gIG1hcmdpbjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gIG1hcmdpbi10b3A6IDA7XG5cbiAgLmhlbHBlciB7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfTtcbiAgICBmb250LXNpemU6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS5zaXplcy5zIC0gMX1weDtcbiAgICBwYWRkaW5nOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4IDA7XG4gICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgfVxuXG4gIC5yZXF1aXJlZCB7XG4gICAgbWFyZ2luLWxlZnQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgLyAyfXB4O1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5lcnJvci5iYXNlfTtcbiAgfVxuXG4gIC5pbnB1dC1jb250YWluZXIge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcblxuICAgID4gZGl2IHtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cblxuICAgIGxhYmVsIHtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICAgIH1cblxuICAgIGkge1xuICAgICAgbWFyZ2luOiAwICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gICAgfVxuICB9XG5cbiAgaW5wdXQsXG4gIHRleHRhcmVhIHtcbiAgICBmbGV4OiAxIDEgYXV0bztcbiAgfVxuXG4gIGlucHV0W2Rpc2FibGVkXSB7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfTtcbiAgfVxuXG4gIHRleHRhcmVhIHtcbiAgICBoZWlnaHQ6IDMwMHB4O1xuICAgIHJlc2l6ZTogbm9uZTtcbiAgfVxuXG4gIGlucHV0OjpwbGFjZWhvbGRlcixcbiAgdGV4dGFyZWE6OnBsYWNlaG9sZGVyIHtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0MX07XG4gIH1cblxuICB0ZXh0YXJlYSxcbiAgaW5wdXRbdHlwZT0ndGV4dCddLFxuICBpbnB1dFt0eXBlPSdudW1iZXInXSB7XG4gICAgcGFkZGluZzogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weFxuICAgICAgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gICAgYm9yZGVyLXN0eWxlOiBub25lO1xuICAgIGJvcmRlcjogMXB4IHNvbGlkICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDJ9O1xuICAgIGJvcmRlci1yYWRpdXM6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG5cbiAgICAmW25hbWU9J2Rlc2NyaXB0aW9uJ10ge1xuICAgICAgZmxleDogMSAxIGF1dG87XG4gICAgfVxuICB9XG5cbiAgLmlucHV0LWxhYmVsIHtcbiAgICBtYXJnaW4tbGVmdDogMTBweDtcbiAgfVxuYDtcbmNvbnN0IFN0eWxlZFJhZGlvID0gc3R5bGVkKFJhZGlvKSBgXG4gIGRpc3BsYXk6IGJsb2NrO1xuICBsaW5lLWhlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDd9cHg7XG5gO1xuY29uc3QgU3R5bGVkUmFkaW9Hcm91cCA9IHN0eWxlZChSYWRpby5Hcm91cCkgYFxuICBtYXJnaW4tbGVmdDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDUuNX1weDtcbmA7XG4vLyBOb3RpZmljYXRpb24gTWV0aG9kIGNvbXBvbmVudHNcbmNvbnN0IFN0eWxlZE5vdGlmaWNhdGlvbkFkZEJ1dHRvbiA9IHN0eWxlZC5kaXYgYFxuICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMucHJpbWFyeS5kYXJrMX07XG4gIGN1cnNvcjogcG9pbnRlcjtcblxuICBpIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICB9XG5cbiAgJi5kaXNhYmxlZCB7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDF9O1xuICAgIGN1cnNvcjogZGVmYXVsdDtcbiAgfVxuYDtcbmNvbnN0IHRpbWV6b25lSGVhZGVyU3R5bGUgPSAodGhlbWUpID0+IGNzcyBgXG4gIG1hcmdpbjogJHt0aGVtZS5ncmlkVW5pdCAqIDN9cHggMDtcbmA7XG5jb25zdCBOb3RpZmljYXRpb25NZXRob2RBZGQgPSAoeyBzdGF0dXMgPSAnYWN0aXZlJywgb25DbGljaywgfSkgPT4ge1xuICAgIGlmIChzdGF0dXMgPT09ICdoaWRkZW4nKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBjaGVja1N0YXR1cyA9ICgpID0+IHtcbiAgICAgICAgaWYgKHN0YXR1cyAhPT0gJ2Rpc2FibGVkJykge1xuICAgICAgICAgICAgb25DbGljaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gKDxTdHlsZWROb3RpZmljYXRpb25BZGRCdXR0b24gY2xhc3NOYW1lPXtzdGF0dXN9IG9uQ2xpY2s9e2NoZWNrU3RhdHVzfT5cbiAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXBsdXNcIi8+eycgJ31cbiAgICAgIHtzdGF0dXMgPT09ICdhY3RpdmUnXG4gICAgICAgICAgICA/IHQoJ0FkZCBub3RpZmljYXRpb24gbWV0aG9kJylcbiAgICAgICAgICAgIDogdCgnQWRkIGRlbGl2ZXJ5IG1ldGhvZCcpfVxuICAgIDwvU3R5bGVkTm90aWZpY2F0aW9uQWRkQnV0dG9uPik7XG59O1xuY29uc3QgQWxlcnRSZXBvcnRNb2RhbCA9ICh7IGFkZERhbmdlclRvYXN0LCBvbkFkZCwgb25IaWRlLCBzaG93LCBhbGVydCA9IG51bGwsIGlzUmVwb3J0ID0gZmFsc2UsIH0pID0+IHtcbiAgICBjb25zdCBjb25mID0gdXNlQ29tbW9uQ29uZigpO1xuICAgIGNvbnN0IGFsbG93ZWROb3RpZmljYXRpb25NZXRob2RzID0gY29uZj8uQUxFUlRfUkVQT1JUU19OT1RJRklDQVRJT05fTUVUSE9EUyB8fCBERUZBVUxUX05PVElGSUNBVElPTl9NRVRIT0RTO1xuICAgIGNvbnN0IFtkaXNhYmxlU2F2ZSwgc2V0RGlzYWJsZVNhdmVdID0gdXNlU3RhdGUodHJ1ZSk7XG4gICAgY29uc3QgW2N1cnJlbnRBbGVydCwgc2V0Q3VycmVudEFsZXJ0LF0gPSB1c2VTdGF0ZSgpO1xuICAgIGNvbnN0IFtpc0hpZGRlbiwgc2V0SXNIaWRkZW5dID0gdXNlU3RhdGUodHJ1ZSk7XG4gICAgY29uc3QgW2NvbnRlbnRUeXBlLCBzZXRDb250ZW50VHlwZV0gPSB1c2VTdGF0ZSgnZGFzaGJvYXJkJyk7XG4gICAgY29uc3QgW3JlcG9ydEZvcm1hdCwgc2V0UmVwb3J0Rm9ybWF0XSA9IHVzZVN0YXRlKERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVCk7XG4gICAgLy8gRHJvcGRvd24gb3B0aW9uc1xuICAgIGNvbnN0IFtjb25kaXRpb25Ob3ROdWxsLCBzZXRDb25kaXRpb25Ob3ROdWxsXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbc291cmNlT3B0aW9ucywgc2V0U291cmNlT3B0aW9uc10gPSB1c2VTdGF0ZShbXSk7XG4gICAgY29uc3QgW2Rhc2hib2FyZE9wdGlvbnMsIHNldERhc2hib2FyZE9wdGlvbnNdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IFtjaGFydE9wdGlvbnMsIHNldENoYXJ0T3B0aW9uc10gPSB1c2VTdGF0ZShbXSk7XG4gICAgLy8gQ2hhcnQgbWV0YWRhdGFcbiAgICBjb25zdCBbY2hhcnRWaXpUeXBlLCBzZXRDaGFydFZpelR5cGVdID0gdXNlU3RhdGUoJycpO1xuICAgIGNvbnN0IGlzRWRpdE1vZGUgPSBhbGVydCAhPT0gbnVsbDtcbiAgICBjb25zdCBmb3JtYXRPcHRpb25FbmFibGVkID0gY29udGVudFR5cGUgPT09ICdjaGFydCcgJiZcbiAgICAgICAgKGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuQUxFUlRTX0FUVEFDSF9SRVBPUlRTKSB8fCBpc1JlcG9ydCk7XG4gICAgY29uc3QgW25vdGlmaWNhdGlvbkFkZFN0YXRlLCBzZXROb3RpZmljYXRpb25BZGRTdGF0ZSxdID0gdXNlU3RhdGUoJ2FjdGl2ZScpO1xuICAgIGNvbnN0IFtub3RpZmljYXRpb25TZXR0aW5ncywgc2V0Tm90aWZpY2F0aW9uU2V0dGluZ3NdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IG9uTm90aWZpY2F0aW9uQWRkID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IG5vdGlmaWNhdGlvblNldHRpbmdzLnNsaWNlKCk7XG4gICAgICAgIHNldHRpbmdzLnB1c2goe1xuICAgICAgICAgICAgcmVjaXBpZW50czogJycsXG4gICAgICAgICAgICBvcHRpb25zOiBhbGxvd2VkTm90aWZpY2F0aW9uTWV0aG9kcyxcbiAgICAgICAgfSk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9uQWRkU3RhdGUoc2V0dGluZ3MubGVuZ3RoID09PSBhbGxvd2VkTm90aWZpY2F0aW9uTWV0aG9kcy5sZW5ndGhcbiAgICAgICAgICAgID8gJ2hpZGRlbidcbiAgICAgICAgICAgIDogJ2Rpc2FibGVkJyk7XG4gICAgfTtcbiAgICBjb25zdCB1cGRhdGVOb3RpZmljYXRpb25TZXR0aW5nID0gKGluZGV4LCBzZXR0aW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gbm90aWZpY2F0aW9uU2V0dGluZ3Muc2xpY2UoKTtcbiAgICAgICAgc2V0dGluZ3NbaW5kZXhdID0gc2V0dGluZztcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9uU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgICAgICBpZiAoc2V0dGluZy5tZXRob2QgIT09IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb25BZGRTdGF0ZSAhPT0gJ2hpZGRlbicpIHtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgcmVtb3ZlTm90aWZpY2F0aW9uU2V0dGluZyA9IChpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IG5vdGlmaWNhdGlvblNldHRpbmdzLnNsaWNlKCk7XG4gICAgICAgIHNldHRpbmdzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9uQWRkU3RhdGUoJ2FjdGl2ZScpO1xuICAgIH07XG4gICAgLy8gQWxlcnQgZmV0Y2ggbG9naWNcbiAgICBjb25zdCB7IHN0YXRlOiB7IGxvYWRpbmcsIHJlc291cmNlLCBlcnJvcjogZmV0Y2hFcnJvciB9LCBmZXRjaFJlc291cmNlLCBjcmVhdGVSZXNvdXJjZSwgdXBkYXRlUmVzb3VyY2UsIGNsZWFyRXJyb3IsIH0gPSB1c2VTaW5nbGVWaWV3UmVzb3VyY2UoJ3JlcG9ydCcsIHQoJ3JlcG9ydCcpLCBhZGREYW5nZXJUb2FzdCk7XG4gICAgLy8gRnVuY3Rpb25zXG4gICAgY29uc3QgaGlkZSA9ICgpID0+IHtcbiAgICAgICAgY2xlYXJFcnJvcigpO1xuICAgICAgICBzZXRJc0hpZGRlbih0cnVlKTtcbiAgICAgICAgb25IaWRlKCk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKFtdKTtcbiAgICAgICAgc2V0Q3VycmVudEFsZXJ0KHsgLi4uREVGQVVMVF9BTEVSVCB9KTtcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9uQWRkU3RhdGUoJ2FjdGl2ZScpO1xuICAgIH07XG4gICAgY29uc3Qgb25TYXZlID0gKCkgPT4ge1xuICAgICAgICAvLyBOb3RpZmljYXRpb24gU2V0dGluZ3NcbiAgICAgICAgY29uc3QgcmVjaXBpZW50cyA9IFtdO1xuICAgICAgICBub3RpZmljYXRpb25TZXR0aW5ncy5mb3JFYWNoKHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgaWYgKHNldHRpbmcubWV0aG9kICYmIHNldHRpbmcucmVjaXBpZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZWNpcGllbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRfY29uZmlnX2pzb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogc2V0dGluZy5yZWNpcGllbnRzLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBzZXR0aW5nLm1ldGhvZCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAuLi5jdXJyZW50QWxlcnQsXG4gICAgICAgICAgICB0eXBlOiBpc1JlcG9ydCA/ICdSZXBvcnQnIDogJ0FsZXJ0JyxcbiAgICAgICAgICAgIHZhbGlkYXRvcl90eXBlOiBjb25kaXRpb25Ob3ROdWxsID8gJ25vdCBudWxsJyA6ICdvcGVyYXRvcicsXG4gICAgICAgICAgICB2YWxpZGF0b3JfY29uZmlnX2pzb246IGNvbmRpdGlvbk5vdE51bGxcbiAgICAgICAgICAgICAgICA/IHt9XG4gICAgICAgICAgICAgICAgOiBjdXJyZW50QWxlcnQ/LnZhbGlkYXRvcl9jb25maWdfanNvbixcbiAgICAgICAgICAgIGNoYXJ0OiBjb250ZW50VHlwZSA9PT0gJ2NoYXJ0JyA/IGN1cnJlbnRBbGVydD8uY2hhcnQ/LnZhbHVlIDogbnVsbCxcbiAgICAgICAgICAgIGRhc2hib2FyZDogY29udGVudFR5cGUgPT09ICdkYXNoYm9hcmQnID8gY3VycmVudEFsZXJ0Py5kYXNoYm9hcmQ/LnZhbHVlIDogbnVsbCxcbiAgICAgICAgICAgIGRhdGFiYXNlOiBjdXJyZW50QWxlcnQ/LmRhdGFiYXNlPy52YWx1ZSxcbiAgICAgICAgICAgIG93bmVyczogKGN1cnJlbnRBbGVydD8ub3duZXJzIHx8IFtdKS5tYXAob3duZXIgPT4gb3duZXIudmFsdWUpLFxuICAgICAgICAgICAgcmVjaXBpZW50cyxcbiAgICAgICAgICAgIHJlcG9ydF9mb3JtYXQ6IGNvbnRlbnRUeXBlID09PSAnZGFzaGJvYXJkJ1xuICAgICAgICAgICAgICAgID8gREVGQVVMVF9OT1RJRklDQVRJT05fRk9STUFUXG4gICAgICAgICAgICAgICAgOiByZXBvcnRGb3JtYXQgfHwgREVGQVVMVF9OT1RJRklDQVRJT05fRk9STUFULFxuICAgICAgICB9O1xuICAgICAgICBpZiAoZGF0YS5yZWNpcGllbnRzICYmICFkYXRhLnJlY2lwaWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBkZWxldGUgZGF0YS5yZWNpcGllbnRzO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEuY29udGV4dF9tYXJrZG93biA9ICdzdHJpbmcnO1xuICAgICAgICBpZiAoaXNFZGl0TW9kZSkge1xuICAgICAgICAgICAgLy8gRWRpdFxuICAgICAgICAgICAgaWYgKGN1cnJlbnRBbGVydCAmJiBjdXJyZW50QWxlcnQuaWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVfaWQgPSBjdXJyZW50QWxlcnQuaWQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEuaWQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEuY3JlYXRlZF9ieTtcbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5sYXN0X2V2YWxfZHR0bTtcbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5sYXN0X3N0YXRlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLmxhc3RfdmFsdWU7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEubGFzdF92YWx1ZV9yb3dfanNvbjtcbiAgICAgICAgICAgICAgICB1cGRhdGVSZXNvdXJjZSh1cGRhdGVfaWQsIGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9uQWRkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkFkZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGhpZGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjdXJyZW50QWxlcnQpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZVxuICAgICAgICAgICAgY3JlYXRlUmVzb3VyY2UoZGF0YSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvbkFkZCkge1xuICAgICAgICAgICAgICAgICAgICBvbkFkZChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhpZGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBGZXRjaCBkYXRhIHRvIHBvcHVsYXRlIGZvcm0gZHJvcGRvd25zXG4gICAgY29uc3QgbG9hZE93bmVyT3B0aW9ucyA9IHVzZU1lbW8oKCkgPT4gKGlucHV0ID0gJycsIHBhZ2UsIHBhZ2VTaXplKSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gcmlzb24uZW5jb2RlKHsgZmlsdGVyOiBpbnB1dCwgcGFnZSwgcGFnZV9zaXplOiBwYWdlU2l6ZSB9KTtcbiAgICAgICAgcmV0dXJuIFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvcmVwb3J0L3JlbGF0ZWQvb3duZXJzP3E9JHtxdWVyeX1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+ICh7XG4gICAgICAgICAgICBkYXRhOiByZXNwb25zZS5qc29uLnJlc3VsdC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQsXG4gICAgICAgIH0pKTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgZ2V0U291cmNlRGF0YSA9IHVzZUNhbGxiYWNrKChkYikgPT4ge1xuICAgICAgICBjb25zdCBkYXRhYmFzZSA9IGRiIHx8IGN1cnJlbnRBbGVydD8uZGF0YWJhc2U7XG4gICAgICAgIGlmICghZGF0YWJhc2UgfHwgZGF0YWJhc2UubGFiZWwpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgIC8vIEN5Y2xlIHRocm91Z2ggc291cmNlIG9wdGlvbnMgdG8gZmluZCB0aGUgc2VsZWN0ZWQgb3B0aW9uXG4gICAgICAgIHNvdXJjZU9wdGlvbnMuZm9yRWFjaChzb3VyY2UgPT4ge1xuICAgICAgICAgICAgaWYgKHNvdXJjZS52YWx1ZSA9PT0gZGF0YWJhc2UudmFsdWUgfHwgc291cmNlLnZhbHVlID09PSBkYXRhYmFzZS5pZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNvdXJjZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSwgW2N1cnJlbnRBbGVydD8uZGF0YWJhc2UsIHNvdXJjZU9wdGlvbnNdKTtcbiAgICAvLyBVcGRhdGluZyBhbGVydC9yZXBvcnQgc3RhdGVcbiAgICBjb25zdCB1cGRhdGVBbGVydFN0YXRlID0gKG5hbWUsIHZhbHVlKSA9PiB7XG4gICAgICAgIHNldEN1cnJlbnRBbGVydChjdXJyZW50QWxlcnREYXRhID0+ICh7XG4gICAgICAgICAgICAuLi5jdXJyZW50QWxlcnREYXRhLFxuICAgICAgICAgICAgW25hbWVdOiB2YWx1ZSxcbiAgICAgICAgfSkpO1xuICAgIH07XG4gICAgY29uc3QgbG9hZFNvdXJjZU9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IChpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogaW5wdXQsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL3JlcG9ydC9yZWxhdGVkL2RhdGFiYXNlP3E9JHtxdWVyeX1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSByZXNwb25zZS5qc29uLnJlc3VsdC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHNldFNvdXJjZU9wdGlvbnMobGlzdCk7XG4gICAgICAgICAgICByZXR1cm4geyBkYXRhOiBsaXN0LCB0b3RhbENvdW50OiByZXNwb25zZS5qc29uLmNvdW50IH07XG4gICAgICAgIH0pO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBkYXRhYmFzZUxhYmVsID0gY3VycmVudEFsZXJ0ICYmIGN1cnJlbnRBbGVydC5kYXRhYmFzZSAmJiAhY3VycmVudEFsZXJ0LmRhdGFiYXNlLmxhYmVsO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIEZpbmQgc291cmNlIGlmIGN1cnJlbnQgYWxlcnQgaGFzIG9uZSBzZXRcbiAgICAgICAgaWYgKGRhdGFiYXNlTGFiZWwpIHtcbiAgICAgICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2RhdGFiYXNlJywgZ2V0U291cmNlRGF0YSgpKTtcbiAgICAgICAgfVxuICAgIH0sIFtkYXRhYmFzZUxhYmVsLCBnZXRTb3VyY2VEYXRhXSk7XG4gICAgY29uc3QgbG9hZERhc2hib2FyZE9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IChpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogaW5wdXQsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL3JlcG9ydC9yZWxhdGVkL2Rhc2hib2FyZD9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ID0gcmVzcG9uc2UuanNvbi5yZXN1bHQubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBzZXREYXNoYm9hcmRPcHRpb25zKGxpc3QpO1xuICAgICAgICAgICAgcmV0dXJuIHsgZGF0YTogbGlzdCwgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCB9O1xuICAgICAgICB9KTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgZ2V0RGFzaGJvYXJkRGF0YSA9IChkYikgPT4ge1xuICAgICAgICBjb25zdCBkYXNoYm9hcmQgPSBkYiB8fCBjdXJyZW50QWxlcnQ/LmRhc2hib2FyZDtcbiAgICAgICAgaWYgKCFkYXNoYm9hcmQgfHwgZGFzaGJvYXJkLmxhYmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAvLyBDeWNsZSB0aHJvdWdoIGRhc2hib2FyZCBvcHRpb25zIHRvIGZpbmQgdGhlIHNlbGVjdGVkIG9wdGlvblxuICAgICAgICBkYXNoYm9hcmRPcHRpb25zLmZvckVhY2goZGFzaCA9PiB7XG4gICAgICAgICAgICBpZiAoZGFzaC52YWx1ZSA9PT0gZGFzaGJvYXJkLnZhbHVlIHx8IGRhc2gudmFsdWUgPT09IGRhc2hib2FyZC5pZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGRhc2g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgY29uc3QgZ2V0Q2hhcnREYXRhID0gdXNlQ2FsbGJhY2soKGNoYXJ0RGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBjaGFydCA9IGNoYXJ0RGF0YSB8fCBjdXJyZW50QWxlcnQ/LmNoYXJ0O1xuICAgICAgICBpZiAoIWNoYXJ0IHx8IGNoYXJ0LmxhYmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAvLyBDeWNsZSB0aHJvdWdoIGNoYXJ0IG9wdGlvbnMgdG8gZmluZCB0aGUgc2VsZWN0ZWQgb3B0aW9uXG4gICAgICAgIGNoYXJ0T3B0aW9ucy5mb3JFYWNoKHNsaWNlID0+IHtcbiAgICAgICAgICAgIGlmIChzbGljZS52YWx1ZSA9PT0gY2hhcnQudmFsdWUgfHwgc2xpY2UudmFsdWUgPT09IGNoYXJ0LmlkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gc2xpY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sIFtjaGFydE9wdGlvbnMsIGN1cnJlbnRBbGVydD8uY2hhcnRdKTtcbiAgICBjb25zdCBub0NoYXJ0TGFiZWwgPSBjdXJyZW50QWxlcnQgJiYgY3VycmVudEFsZXJ0LmNoYXJ0ICYmICFjdXJyZW50QWxlcnQuY2hhcnQubGFiZWw7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgLy8gRmluZCBzb3VyY2UgaWYgY3VycmVudCBhbGVydCBoYXMgb25lIHNldFxuICAgICAgICBpZiAobm9DaGFydExhYmVsKSB7XG4gICAgICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdjaGFydCcsIGdldENoYXJ0RGF0YSgpKTtcbiAgICAgICAgfVxuICAgIH0sIFtnZXRDaGFydERhdGEsIG5vQ2hhcnRMYWJlbF0pO1xuICAgIGNvbnN0IGxvYWRDaGFydE9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IChpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogaW5wdXQsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL3JlcG9ydC9yZWxhdGVkL2NoYXJ0P3E9JHtxdWVyeX1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSByZXNwb25zZS5qc29uLnJlc3VsdC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHNldENoYXJ0T3B0aW9ucyhsaXN0KTtcbiAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IGxpc3QsIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQgfTtcbiAgICAgICAgfSk7XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IGdldENoYXJ0VmlzdWFsaXphdGlvblR5cGUgPSAoY2hhcnQpID0+IFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9jaGFydC8ke2NoYXJ0LnZhbHVlfWAsXG4gICAgfSkudGhlbihyZXNwb25zZSA9PiBzZXRDaGFydFZpelR5cGUocmVzcG9uc2UuanNvbi5yZXN1bHQudml6X3R5cGUpKTtcbiAgICAvLyBIYW5kbGUgaW5wdXQvdGV4dGFyZWEgdXBkYXRlc1xuICAgIGNvbnN0IG9uVGV4dENoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnQ7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUodGFyZ2V0Lm5hbWUsIHRhcmdldC52YWx1ZSk7XG4gICAgfTtcbiAgICBjb25zdCBvblRpbWVvdXRWZXJpZnlDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGV2ZW50O1xuICAgICAgICBjb25zdCB2YWx1ZSA9ICt0YXJnZXQudmFsdWU7XG4gICAgICAgIC8vIE5lZWQgdG8gbWFrZSBzdXJlIGdyYWNlIHBlcmlvZCBpcyBub3QgbG93ZXIgdGhhbiBUSU1FT1VUX01JTlxuICAgICAgICBpZiAodmFsdWUgPT09IDApIHtcbiAgICAgICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUodGFyZ2V0Lm5hbWUsIG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSh0YXJnZXQubmFtZSwgdmFsdWUgPyBNYXRoLm1heCh2YWx1ZSwgVElNRU9VVF9NSU4pIDogdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBvblNRTENoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdzcWwnLCB2YWx1ZSB8fCAnJyk7XG4gICAgfTtcbiAgICBjb25zdCBvbk93bmVyc0NoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdvd25lcnMnLCB2YWx1ZSB8fCBbXSk7XG4gICAgfTtcbiAgICBjb25zdCBvblNvdXJjZUNoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdkYXRhYmFzZScsIHZhbHVlIHx8IFtdKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uRGFzaGJvYXJkQ2hhbmdlID0gKGRhc2hib2FyZCkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdkYXNoYm9hcmQnLCBkYXNoYm9hcmQgfHwgdW5kZWZpbmVkKTtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnY2hhcnQnLCBudWxsKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uQ2hhcnRDaGFuZ2UgPSAoY2hhcnQpID0+IHtcbiAgICAgICAgZ2V0Q2hhcnRWaXN1YWxpemF0aW9uVHlwZShjaGFydCk7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2NoYXJ0JywgY2hhcnQgfHwgdW5kZWZpbmVkKTtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnZGFzaGJvYXJkJywgbnVsbCk7XG4gICAgfTtcbiAgICBjb25zdCBvbkFjdGl2ZVN3aXRjaCA9IChjaGVja2VkKSA9PiB7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2FjdGl2ZScsIGNoZWNrZWQpO1xuICAgIH07XG4gICAgY29uc3Qgb25Db25kaXRpb25DaGFuZ2UgPSAob3ApID0+IHtcbiAgICAgICAgc2V0Q29uZGl0aW9uTm90TnVsbChvcCA9PT0gJ25vdCBudWxsJyk7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHtcbiAgICAgICAgICAgIG9wLFxuICAgICAgICAgICAgdGhyZXNob2xkOiBjdXJyZW50QWxlcnRcbiAgICAgICAgICAgICAgICA/IGN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24/LnRocmVzaG9sZFxuICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICB9O1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCd2YWxpZGF0b3JfY29uZmlnX2pzb24nLCBjb25maWcpO1xuICAgIH07XG4gICAgY29uc3Qgb25UaHJlc2hvbGRDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGV2ZW50O1xuICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICBvcDogY3VycmVudEFsZXJ0ID8gY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbj8ub3AgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICB0aHJlc2hvbGQ6IHRhcmdldC52YWx1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgndmFsaWRhdG9yX2NvbmZpZ19qc29uJywgY29uZmlnKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uTG9nUmV0ZW50aW9uQ2hhbmdlID0gKHJldGVudGlvbikgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdsb2dfcmV0ZW50aW9uJywgcmV0ZW50aW9uKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uVGltZXpvbmVDaGFuZ2UgPSAodGltZXpvbmUpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgndGltZXpvbmUnLCB0aW1lem9uZSk7XG4gICAgfTtcbiAgICBjb25zdCBvbkNvbnRlbnRUeXBlQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0IH0gPSBldmVudDtcbiAgICAgICAgLy8gR2l2ZXMgdGltZSB0byBjbG9zZSB0aGUgc2VsZWN0IGJlZm9yZSBjaGFuZ2luZyB0aGUgdHlwZVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHNldENvbnRlbnRUeXBlKHRhcmdldC52YWx1ZSksIDIwMCk7XG4gICAgfTtcbiAgICBjb25zdCBvbkZvcm1hdENoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnQ7XG4gICAgICAgIHNldFJlcG9ydEZvcm1hdCh0YXJnZXQudmFsdWUpO1xuICAgIH07XG4gICAgLy8gTWFrZSBzdXJlIG5vdGlmaWNhdGlvbiBzZXR0aW5ncyBoYXMgdGhlIHJlcXVpcmVkIGluZm9cbiAgICBjb25zdCBjaGVja05vdGlmaWNhdGlvblNldHRpbmdzID0gKCkgPT4ge1xuICAgICAgICBpZiAoIW5vdGlmaWNhdGlvblNldHRpbmdzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBoYXNJbmZvID0gZmFsc2U7XG4gICAgICAgIG5vdGlmaWNhdGlvblNldHRpbmdzLmZvckVhY2goc2V0dGluZyA9PiB7XG4gICAgICAgICAgICBpZiAoISFzZXR0aW5nLm1ldGhvZCAmJiBzZXR0aW5nLnJlY2lwaWVudHM/Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGhhc0luZm8gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGhhc0luZm87XG4gICAgfTtcbiAgICBjb25zdCB2YWxpZGF0ZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKGN1cnJlbnRBbGVydCAmJlxuICAgICAgICAgICAgY3VycmVudEFsZXJ0Lm5hbWU/Lmxlbmd0aCAmJlxuICAgICAgICAgICAgY3VycmVudEFsZXJ0Lm93bmVycz8ubGVuZ3RoICYmXG4gICAgICAgICAgICBjdXJyZW50QWxlcnQuY3JvbnRhYj8ubGVuZ3RoICYmXG4gICAgICAgICAgICBjdXJyZW50QWxlcnQud29ya2luZ190aW1lb3V0ICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICgoY29udGVudFR5cGUgPT09ICdkYXNoYm9hcmQnICYmICEhY3VycmVudEFsZXJ0LmRhc2hib2FyZCkgfHxcbiAgICAgICAgICAgICAgICAoY29udGVudFR5cGUgPT09ICdjaGFydCcgJiYgISFjdXJyZW50QWxlcnQuY2hhcnQpKSAmJlxuICAgICAgICAgICAgY2hlY2tOb3RpZmljYXRpb25TZXR0aW5ncygpKSB7XG4gICAgICAgICAgICBpZiAoaXNSZXBvcnQpIHtcbiAgICAgICAgICAgICAgICBzZXREaXNhYmxlU2F2ZShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghIWN1cnJlbnRBbGVydC5kYXRhYmFzZSAmJlxuICAgICAgICAgICAgICAgIGN1cnJlbnRBbGVydC5zcWw/Lmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgIChjb25kaXRpb25Ob3ROdWxsIHx8ICEhY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbj8ub3ApICYmXG4gICAgICAgICAgICAgICAgKGNvbmRpdGlvbk5vdE51bGwgfHxcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbj8udGhyZXNob2xkICE9PSB1bmRlZmluZWQpKSB7XG4gICAgICAgICAgICAgICAgc2V0RGlzYWJsZVNhdmUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0RGlzYWJsZVNhdmUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZXREaXNhYmxlU2F2ZSh0cnVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gSW5pdGlhbGl6ZVxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChpc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAoIWN1cnJlbnRBbGVydD8uaWQgfHwgYWxlcnQ/LmlkICE9PSBjdXJyZW50QWxlcnQuaWQgfHwgKGlzSGlkZGVuICYmIHNob3cpKSkge1xuICAgICAgICAgICAgaWYgKGFsZXJ0ICYmIGFsZXJ0LmlkICE9PSBudWxsICYmICFsb2FkaW5nICYmICFmZXRjaEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWQgPSBhbGVydC5pZCB8fCAwO1xuICAgICAgICAgICAgICAgIGZldGNoUmVzb3VyY2UoaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFpc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAoIWN1cnJlbnRBbGVydCB8fCBjdXJyZW50QWxlcnQuaWQgfHwgKGlzSGlkZGVuICYmIHNob3cpKSkge1xuICAgICAgICAgICAgc2V0Q3VycmVudEFsZXJ0KHsgLi4uREVGQVVMVF9BTEVSVCB9KTtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKFtdKTtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH0sIFthbGVydF0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChyZXNvdXJjZSkge1xuICAgICAgICAgICAgLy8gQWRkIG5vdGlmaWNhdGlvbiBzZXR0aW5nc1xuICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSAocmVzb3VyY2UucmVjaXBpZW50cyB8fCBbXSkubWFwKHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHR5cGVvZiBzZXR0aW5nLnJlY2lwaWVudF9jb25maWdfanNvbiA9PT0gJ3N0cmluZydcbiAgICAgICAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKHNldHRpbmcucmVjaXBpZW50X2NvbmZpZ19qc29uKVxuICAgICAgICAgICAgICAgICAgICA6IHt9O1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogc2V0dGluZy50eXBlLFxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlOiBUeXBlIG5vdCBhc3NpZ25hYmxlXG4gICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHM6IGNvbmZpZy50YXJnZXQgfHwgc2V0dGluZy5yZWNpcGllbnRfY29uZmlnX2pzb24sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGFsbG93ZWROb3RpZmljYXRpb25NZXRob2RzLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKHNldHRpbmdzLmxlbmd0aCA9PT0gYWxsb3dlZE5vdGlmaWNhdGlvbk1ldGhvZHMubGVuZ3RoXG4gICAgICAgICAgICAgICAgPyAnaGlkZGVuJ1xuICAgICAgICAgICAgICAgIDogJ2FjdGl2ZScpO1xuICAgICAgICAgICAgc2V0Q29udGVudFR5cGUocmVzb3VyY2UuY2hhcnQgPyAnY2hhcnQnIDogJ2Rhc2hib2FyZCcpO1xuICAgICAgICAgICAgc2V0UmVwb3J0Rm9ybWF0KHJlc291cmNlLmNoYXJ0XG4gICAgICAgICAgICAgICAgPyByZXNvdXJjZS5yZXBvcnRfZm9ybWF0IHx8IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVFxuICAgICAgICAgICAgICAgIDogREVGQVVMVF9OT1RJRklDQVRJT05fRk9STUFUKTtcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRvckNvbmZpZyA9IHR5cGVvZiByZXNvdXJjZS52YWxpZGF0b3JfY29uZmlnX2pzb24gPT09ICdzdHJpbmcnXG4gICAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKHJlc291cmNlLnZhbGlkYXRvcl9jb25maWdfanNvbilcbiAgICAgICAgICAgICAgICA6IHJlc291cmNlLnZhbGlkYXRvcl9jb25maWdfanNvbjtcbiAgICAgICAgICAgIHNldENvbmRpdGlvbk5vdE51bGwocmVzb3VyY2UudmFsaWRhdG9yX3R5cGUgPT09ICdub3QgbnVsbCcpO1xuICAgICAgICAgICAgaWYgKHJlc291cmNlLmNoYXJ0KSB7XG4gICAgICAgICAgICAgICAgc2V0Q2hhcnRWaXpUeXBlKHJlc291cmNlLmNoYXJ0LnZpel90eXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldEN1cnJlbnRBbGVydCh7XG4gICAgICAgICAgICAgICAgLi4ucmVzb3VyY2UsXG4gICAgICAgICAgICAgICAgY2hhcnQ6IHJlc291cmNlLmNoYXJ0XG4gICAgICAgICAgICAgICAgICAgID8gZ2V0Q2hhcnREYXRhKHJlc291cmNlLmNoYXJ0KSB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcmVzb3VyY2UuY2hhcnQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogcmVzb3VyY2UuY2hhcnQuc2xpY2VfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmQ6IHJlc291cmNlLmRhc2hib2FyZFxuICAgICAgICAgICAgICAgICAgICA/IGdldERhc2hib2FyZERhdGEocmVzb3VyY2UuZGFzaGJvYXJkKSB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcmVzb3VyY2UuZGFzaGJvYXJkLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHJlc291cmNlLmRhc2hib2FyZC5kYXNoYm9hcmRfdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgZGF0YWJhc2U6IHJlc291cmNlLmRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgID8gZ2V0U291cmNlRGF0YShyZXNvdXJjZS5kYXRhYmFzZSkgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlc291cmNlLmRhdGFiYXNlLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHJlc291cmNlLmRhdGFiYXNlLmRhdGFiYXNlX25hbWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgb3duZXJzOiAocmVzb3VyY2Uub3duZXJzIHx8IFtdKS5tYXAob3duZXIgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG93bmVyLmlkLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogYCR7b3duZXIuZmlyc3RfbmFtZX0gJHtvd25lci5sYXN0X25hbWV9YCxcbiAgICAgICAgICAgICAgICB9KSksXG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZTogVHlwZSBub3QgYXNzaWduYWJsZVxuICAgICAgICAgICAgICAgIHZhbGlkYXRvcl9jb25maWdfanNvbjogcmVzb3VyY2UudmFsaWRhdG9yX3R5cGUgPT09ICdub3QgbnVsbCdcbiAgICAgICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcDogJ25vdCBudWxsJyxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA6IHZhbGlkYXRvckNvbmZpZyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwgW3Jlc291cmNlXSk7XG4gICAgLy8gVmFsaWRhdGlvblxuICAgIGNvbnN0IGN1cnJlbnRBbGVydFNhZmUgPSBjdXJyZW50QWxlcnQgfHwge307XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgdmFsaWRhdGUoKTtcbiAgICB9LCBbXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUubmFtZSxcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS5vd25lcnMsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuZGF0YWJhc2UsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuc3FsLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLnZhbGlkYXRvcl9jb25maWdfanNvbixcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS5jcm9udGFiLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLndvcmtpbmdfdGltZW91dCxcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS5kYXNoYm9hcmQsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuY2hhcnQsXG4gICAgICAgIGNvbnRlbnRUeXBlLFxuICAgICAgICBub3RpZmljYXRpb25TZXR0aW5ncyxcbiAgICAgICAgY29uZGl0aW9uTm90TnVsbCxcbiAgICBdKTtcbiAgICAvLyBTaG93L2hpZGVcbiAgICBpZiAoaXNIaWRkZW4gJiYgc2hvdykge1xuICAgICAgICBzZXRJc0hpZGRlbihmYWxzZSk7XG4gICAgfVxuICAgIHJldHVybiAoPFN0eWxlZE1vZGFsIGNsYXNzTmFtZT1cIm5vLWNvbnRlbnQtcGFkZGluZ1wiIHJlc3BvbnNpdmUgZGlzYWJsZVByaW1hcnlCdXR0b249e2Rpc2FibGVTYXZlfSBvbkhhbmRsZWRQcmltYXJ5QWN0aW9uPXtvblNhdmV9IG9uSGlkZT17aGlkZX0gcHJpbWFyeUJ1dHRvbk5hbWU9e2lzRWRpdE1vZGUgPyB0KCdTYXZlJykgOiB0KCdBZGQnKX0gc2hvdz17c2hvd30gd2lkdGg9XCIxMDAlXCIgbWF4V2lkdGg9XCIxNDUwcHhcIiB0aXRsZT17PGg0IGRhdGEtdGVzdD1cImFsZXJ0LXJlcG9ydC1tb2RhbC10aXRsZVwiPlxuICAgICAgICAgIHtpc0VkaXRNb2RlID8gKDxJY29ucy5FZGl0QWx0IGNzcz17U3R5bGVkSWNvbn0vPikgOiAoPEljb25zLlBsdXNMYXJnZSBjc3M9e1N0eWxlZEljb259Lz4pfVxuICAgICAgICAgIHtpc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgPyB0KGBFZGl0ICR7aXNSZXBvcnQgPyAnUmVwb3J0JyA6ICdBbGVydCd9YClcbiAgICAgICAgICAgICAgICA6IHQoYEFkZCAke2lzUmVwb3J0ID8gJ1JlcG9ydCcgOiAnQWxlcnQnfWApfVxuICAgICAgICA8L2g0Pn0+XG4gICAgICA8U3R5bGVkU2VjdGlvbkNvbnRhaW5lcj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFkZXItc2VjdGlvblwiPlxuICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICB7aXNSZXBvcnQgPyB0KCdSZXBvcnQgbmFtZScpIDogdCgnQWxlcnQgbmFtZScpfVxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJuYW1lXCIgdmFsdWU9e2N1cnJlbnRBbGVydCA/IGN1cnJlbnRBbGVydC5uYW1lIDogJyd9IHBsYWNlaG9sZGVyPXtpc1JlcG9ydCA/IHQoJ1JlcG9ydCBuYW1lJykgOiB0KCdBbGVydCBuYW1lJyl9IG9uQ2hhbmdlPXtvblRleHRDaGFuZ2V9Lz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgIHt0KCdPd25lcnMnKX1cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdD1cIm93bmVycy1zZWxlY3RcIiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgPFNlbGVjdCBhcmlhTGFiZWw9e3QoJ093bmVycycpfSBhbGxvd0NsZWFyIG5hbWU9XCJvd25lcnNcIiBtb2RlPVwibXVsdGlwbGVcIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py5vd25lcnMgfHwgW119IG9wdGlvbnM9e2xvYWRPd25lck9wdGlvbnN9IG9uQ2hhbmdlPXtvbk93bmVyc0NoYW5nZX0vPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj57dCgnRGVzY3JpcHRpb24nKX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJkZXNjcmlwdGlvblwiIHZhbHVlPXtjdXJyZW50QWxlcnQgPyBjdXJyZW50QWxlcnQuZGVzY3JpcHRpb24gfHwgJycgOiAnJ30gcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9IG9uQ2hhbmdlPXtvblRleHRDaGFuZ2V9Lz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgPFN0eWxlZFN3aXRjaENvbnRhaW5lcj5cbiAgICAgICAgICAgIDxTd2l0Y2ggb25DaGFuZ2U9e29uQWN0aXZlU3dpdGNofSBjaGVja2VkPXtjdXJyZW50QWxlcnQgPyBjdXJyZW50QWxlcnQuYWN0aXZlIDogdHJ1ZX0vPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzd2l0Y2gtbGFiZWxcIj5BY3RpdmU8L2Rpdj5cbiAgICAgICAgICA8L1N0eWxlZFN3aXRjaENvbnRhaW5lcj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sdW1uLXNlY3Rpb25cIj5cbiAgICAgICAgICB7IWlzUmVwb3J0ICYmICg8ZGl2IGNsYXNzTmFtZT1cImNvbHVtbiBjb25kaXRpb25cIj5cbiAgICAgICAgICAgICAgPFN0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgICA8aDQ+e3QoJ0FsZXJ0IGNvbmRpdGlvbicpfTwvaDQ+XG4gICAgICAgICAgICAgIDwvU3R5bGVkU2VjdGlvblRpdGxlPlxuICAgICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAgICB7dCgnRGF0YWJhc2UnKX1cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgPFNlbGVjdCBhcmlhTGFiZWw9e3QoJ0RhdGFiYXNlJyl9IG5hbWU9XCJzb3VyY2VcIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py5kYXRhYmFzZT8ubGFiZWwgJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxlcnQ/LmRhdGFiYXNlPy52YWx1ZVxuICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY3VycmVudEFsZXJ0LmRhdGFiYXNlLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogY3VycmVudEFsZXJ0LmRhdGFiYXNlLmxhYmVsLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZH0gb3B0aW9ucz17bG9hZFNvdXJjZU9wdGlvbnN9IG9uQ2hhbmdlPXtvblNvdXJjZUNoYW5nZX0vPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAgICB7dCgnU1FMIFF1ZXJ5Jyl9XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbCBuYW1lPVwic3FsXCIgbGFuZ3VhZ2U9XCJzcWxcIiBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX0gbWluTGluZXM9ezE1fSBtYXhMaW5lcz17MTV9IG9uQ2hhbmdlPXtvblNRTENoYW5nZX0gcmVhZE9ubHk9e2ZhbHNlfSBpbml0aWFsVmFsdWU9e3Jlc291cmNlPy5zcWx9IGtleT17Y3VycmVudEFsZXJ0Py5pZH0vPlxuICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlubGluZS1jb250YWluZXIgd3JhcFwiPlxuICAgICAgICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnVHJpZ2dlciBBbGVydCBJZi4uLicpfVxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdDb25kaXRpb24nKX0gb25DaGFuZ2U9e29uQ29uZGl0aW9uQ2hhbmdlfSBwbGFjZWhvbGRlcj1cIkNvbmRpdGlvblwiIHZhbHVlPXtjdXJyZW50QWxlcnQ/LnZhbGlkYXRvcl9jb25maWdfanNvbj8ub3AgfHwgdW5kZWZpbmVkfSBvcHRpb25zPXtDT05ESVRJT05TfS8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnVmFsdWUnKX1cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG5hbWU9XCJ0aHJlc2hvbGRcIiBkaXNhYmxlZD17Y29uZGl0aW9uTm90TnVsbH0gdmFsdWU9e2N1cnJlbnRBbGVydCAmJlxuICAgICAgICAgICAgICAgIGN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24gJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxlcnQudmFsaWRhdG9yX2NvbmZpZ19qc29uLnRocmVzaG9sZCAhPT1cbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgPyBjdXJyZW50QWxlcnQudmFsaWRhdG9yX2NvbmZpZ19qc29uLnRocmVzaG9sZFxuICAgICAgICAgICAgICAgIDogJyd9IHBsYWNlaG9sZGVyPXt0KCdWYWx1ZScpfSBvbkNoYW5nZT17b25UaHJlc2hvbGRDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+KX1cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbHVtbiBzY2hlZHVsZVwiPlxuICAgICAgICAgICAgPFN0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgPGg0PlxuICAgICAgICAgICAgICAgIHtpc1JlcG9ydFxuICAgICAgICAgICAgPyB0KCdSZXBvcnQgc2NoZWR1bGUnKVxuICAgICAgICAgICAgOiB0KCdBbGVydCBjb25kaXRpb24gc2NoZWR1bGUnKX1cbiAgICAgICAgICAgICAgPC9oND5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgPC9TdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICA8QWxlcnRSZXBvcnRDcm9uU2NoZWR1bGVyIHZhbHVlPXtjdXJyZW50QWxlcnQ/LmNyb250YWIgfHwgREVGQVVMVF9DUk9OX1ZBTFVFfSBvbkNoYW5nZT17bmV3VmFsID0+IHVwZGF0ZUFsZXJ0U3RhdGUoJ2Nyb250YWInLCBuZXdWYWwpfS8+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj57dCgnVGltZXpvbmUnKX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCIgY3NzPXsodGhlbWUpID0+IHRpbWV6b25lSGVhZGVyU3R5bGUodGhlbWUpfT5cbiAgICAgICAgICAgICAgPFRpbWV6b25lU2VsZWN0b3Igb25UaW1lem9uZUNoYW5nZT17b25UaW1lem9uZUNoYW5nZX0gdGltZXpvbmU9e2N1cnJlbnRBbGVydD8udGltZXpvbmV9Lz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPFN0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgPGg0Pnt0KCdTY2hlZHVsZSBzZXR0aW5ncycpfTwvaDQ+XG4gICAgICAgICAgICA8L1N0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAge3QoJ0xvZyByZXRlbnRpb24nKX1cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdMb2cgcmV0ZW50aW9uJyl9IHBsYWNlaG9sZGVyPXt0KCdMb2cgcmV0ZW50aW9uJyl9IG9uQ2hhbmdlPXtvbkxvZ1JldGVudGlvbkNoYW5nZX0gdmFsdWU9e2N1cnJlbnRBbGVydD8ubG9nX3JldGVudGlvbiB8fCBERUZBVUxUX1JFVEVOVElPTn0gb3B0aW9ucz17UkVURU5USU9OX09QVElPTlN9Lz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICB7dCgnV29ya2luZyB0aW1lb3V0Jyl9XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG1pbj1cIjFcIiBuYW1lPVwid29ya2luZ190aW1lb3V0XCIgdmFsdWU9e2N1cnJlbnRBbGVydD8ud29ya2luZ190aW1lb3V0IHx8ICcnfSBwbGFjZWhvbGRlcj17dCgnVGltZSBpbiBzZWNvbmRzJyl9IG9uQ2hhbmdlPXtvblRpbWVvdXRWZXJpZnlDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJpbnB1dC1sYWJlbFwiPnNlY29uZHM8L3NwYW4+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgIHshaXNSZXBvcnQgJiYgKDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj57dCgnR3JhY2UgcGVyaW9kJyl9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgbWluPVwiMVwiIG5hbWU9XCJncmFjZV9wZXJpb2RcIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py5ncmFjZV9wZXJpb2QgfHwgJyd9IHBsYWNlaG9sZGVyPXt0KCdUaW1lIGluIHNlY29uZHMnKX0gb25DaGFuZ2U9e29uVGltZW91dFZlcmlmeUNoYW5nZX0vPlxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaW5wdXQtbGFiZWxcIj5zZWNvbmRzPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPil9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2x1bW4gbWVzc2FnZVwiPlxuICAgICAgICAgICAgPFN0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgPGg0Pnt0KCdNZXNzYWdlIGNvbnRlbnQnKX08L2g0PlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICA8L1N0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgIDxSYWRpby5Hcm91cCBvbkNoYW5nZT17b25Db250ZW50VHlwZUNoYW5nZX0gdmFsdWU9e2NvbnRlbnRUeXBlfT5cbiAgICAgICAgICAgICAgPFN0eWxlZFJhZGlvIHZhbHVlPVwiZGFzaGJvYXJkXCI+e3QoJ0Rhc2hib2FyZCcpfTwvU3R5bGVkUmFkaW8+XG4gICAgICAgICAgICAgIDxTdHlsZWRSYWRpbyB2YWx1ZT1cImNoYXJ0XCI+e3QoJ0NoYXJ0Jyl9PC9TdHlsZWRSYWRpbz5cbiAgICAgICAgICAgIDwvUmFkaW8uR3JvdXA+XG4gICAgICAgICAgICA8U2VsZWN0IGFyaWFMYWJlbD17dCgnQ2hhcnQnKX0gY3NzPXt7XG4gICAgICAgICAgICBkaXNwbGF5OiBjb250ZW50VHlwZSA9PT0gJ2NoYXJ0JyA/ICdpbmxpbmUnIDogJ25vbmUnLFxuICAgICAgICB9fSBuYW1lPVwiY2hhcnRcIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py5jaGFydD8ubGFiZWwgJiYgY3VycmVudEFsZXJ0Py5jaGFydD8udmFsdWVcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBjdXJyZW50QWxlcnQuY2hhcnQudmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGN1cnJlbnRBbGVydC5jaGFydC5sYWJlbCxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDogdW5kZWZpbmVkfSBvcHRpb25zPXtsb2FkQ2hhcnRPcHRpb25zfSBvbkNoYW5nZT17b25DaGFydENoYW5nZX0vPlxuICAgICAgICAgICAgPFNlbGVjdCBhcmlhTGFiZWw9e3QoJ0Rhc2hib2FyZCcpfSBjc3M9e3tcbiAgICAgICAgICAgIGRpc3BsYXk6IGNvbnRlbnRUeXBlID09PSAnZGFzaGJvYXJkJyA/ICdpbmxpbmUnIDogJ25vbmUnLFxuICAgICAgICB9fSBuYW1lPVwiZGFzaGJvYXJkXCIgdmFsdWU9e2N1cnJlbnRBbGVydD8uZGFzaGJvYXJkPy5sYWJlbCAmJiBjdXJyZW50QWxlcnQ/LmRhc2hib2FyZD8udmFsdWVcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBjdXJyZW50QWxlcnQuZGFzaGJvYXJkLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBjdXJyZW50QWxlcnQuZGFzaGJvYXJkLmxhYmVsLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiB1bmRlZmluZWR9IG9wdGlvbnM9e2xvYWREYXNoYm9hcmRPcHRpb25zfSBvbkNoYW5nZT17b25EYXNoYm9hcmRDaGFuZ2V9Lz5cbiAgICAgICAgICAgIHtmb3JtYXRPcHRpb25FbmFibGVkICYmICg8ZGl2IGNsYXNzTmFtZT1cImlubGluZS1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICA8U3R5bGVkUmFkaW9Hcm91cCBvbkNoYW5nZT17b25Gb3JtYXRDaGFuZ2V9IHZhbHVlPXtyZXBvcnRGb3JtYXR9PlxuICAgICAgICAgICAgICAgICAgPFN0eWxlZFJhZGlvIHZhbHVlPVwiUE5HXCI+e3QoJ1NlbmQgYXMgUE5HJyl9PC9TdHlsZWRSYWRpbz5cbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRSYWRpbyB2YWx1ZT1cIkNTVlwiPnt0KCdTZW5kIGFzIENTVicpfTwvU3R5bGVkUmFkaW8+XG4gICAgICAgICAgICAgICAgICB7VEVYVF9CQVNFRF9WSVNVQUxJWkFUSU9OX1RZUEVTLmluY2x1ZGVzKGNoYXJ0Vml6VHlwZSkgJiYgKDxTdHlsZWRSYWRpbyB2YWx1ZT1cIlRFWFRcIj57dCgnU2VuZCBhcyB0ZXh0Jyl9PC9TdHlsZWRSYWRpbz4pfVxuICAgICAgICAgICAgICAgIDwvU3R5bGVkUmFkaW9Hcm91cD5cbiAgICAgICAgICAgICAgPC9kaXY+KX1cbiAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgIDxoND57dCgnTm90aWZpY2F0aW9uIG1ldGhvZCcpfTwvaDQ+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgIDwvU3R5bGVkU2VjdGlvblRpdGxlPlxuICAgICAgICAgICAge25vdGlmaWNhdGlvblNldHRpbmdzLm1hcCgobm90aWZpY2F0aW9uU2V0dGluZywgaSkgPT4gKDxOb3RpZmljYXRpb25NZXRob2Qgc2V0dGluZz17bm90aWZpY2F0aW9uU2V0dGluZ30gaW5kZXg9e2l9IGtleT17YE5vdGlmaWNhdGlvbk1ldGhvZC0ke2l9YH0gb25VcGRhdGU9e3VwZGF0ZU5vdGlmaWNhdGlvblNldHRpbmd9IG9uUmVtb3ZlPXtyZW1vdmVOb3RpZmljYXRpb25TZXR0aW5nfS8+KSl9XG4gICAgICAgICAgICA8Tm90aWZpY2F0aW9uTWV0aG9kQWRkIGRhdGEtdGVzdD1cIm5vdGlmaWNhdGlvbi1hZGRcIiBzdGF0dXM9e25vdGlmaWNhdGlvbkFkZFN0YXRlfSBvbkNsaWNrPXtvbk5vdGlmaWNhdGlvbkFkZH0vPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvU3R5bGVkU2VjdGlvbkNvbnRhaW5lcj5cbiAgICA8L1N0eWxlZE1vZGFsPik7XG59O1xuZXhwb3J0IGRlZmF1bHQgd2l0aFRvYXN0cyhBbGVydFJlcG9ydE1vZGFsKTtcbiJdfQ== */\"),\n    name: \"chart\", value: currentAlert != null && (_currentAlert$chart2 = currentAlert.chart) != null && _currentAlert$chart2.label && currentAlert != null && (_currentAlert$chart3 = currentAlert.chart) != null && _currentAlert$chart3.value ?\n    {\n      value: currentAlert.chart.value,\n      label: currentAlert.chart.label } :\n\n    undefined, options: loadChartOptions, onChange: onChartChange }),\n  ___EmotionJSX(Select, { ariaLabel: t('Dashboard'), css: /*#__PURE__*/_css({\n      display: contentType === 'dashboard' ? 'inline' : 'none' }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:AlertReportModal;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9teV9wbHVnaW4vc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL3ZpZXdzL0NSVUQvYWxlcnQvQWxlcnRSZXBvcnRNb2RhbC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBczVCK0MiLCJmaWxlIjoiL2hvbWUvdWJ1bnR1L215X3BsdWdpbi9zdXBlcnNldC9zdXBlcnNldC1mcm9udGVuZC9zcmMvdmlld3MvQ1JVRC9hbGVydC9BbGVydFJlcG9ydE1vZGFsLnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VDYWxsYmFjaywgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBzdHlsZWQsIHQsIFN1cGVyc2V0Q2xpZW50LCBjc3MsIH0gZnJvbSAnQHN1cGVyc2V0LXVpL2NvcmUnO1xuaW1wb3J0IHJpc29uIGZyb20gJ3Jpc29uJztcbmltcG9ydCB7IHVzZVNpbmdsZVZpZXdSZXNvdXJjZSB9IGZyb20gJ3NyYy92aWV3cy9DUlVEL2hvb2tzJztcbmltcG9ydCBJY29ucyBmcm9tICdzcmMvY29tcG9uZW50cy9JY29ucyc7XG5pbXBvcnQgeyBTd2l0Y2ggfSBmcm9tICdzcmMvY29tcG9uZW50cy9Td2l0Y2gnO1xuaW1wb3J0IE1vZGFsIGZyb20gJ3NyYy9jb21wb25lbnRzL01vZGFsJztcbmltcG9ydCBUaW1lem9uZVNlbGVjdG9yIGZyb20gJ3NyYy9jb21wb25lbnRzL1RpbWV6b25lU2VsZWN0b3InO1xuaW1wb3J0IHsgUmFkaW8gfSBmcm9tICdzcmMvY29tcG9uZW50cy9SYWRpbyc7XG5pbXBvcnQgeyBTZWxlY3QgfSBmcm9tICdzcmMvY29tcG9uZW50cyc7XG5pbXBvcnQgeyBGZWF0dXJlRmxhZywgaXNGZWF0dXJlRW5hYmxlZCB9IGZyb20gJ3NyYy9mZWF0dXJlRmxhZ3MnO1xuaW1wb3J0IHdpdGhUb2FzdHMgZnJvbSAnc3JjL2NvbXBvbmVudHMvTWVzc2FnZVRvYXN0cy93aXRoVG9hc3RzJztcbmltcG9ydCBUZXh0QXJlYUNvbnRyb2wgZnJvbSAnc3JjL2V4cGxvcmUvY29tcG9uZW50cy9jb250cm9scy9UZXh0QXJlYUNvbnRyb2wnO1xuaW1wb3J0IHsgdXNlQ29tbW9uQ29uZiB9IGZyb20gJ3NyYy92aWV3cy9DUlVEL2RhdGEvZGF0YWJhc2Uvc3RhdGUnO1xuaW1wb3J0IHsgQWxlcnRSZXBvcnRDcm9uU2NoZWR1bGVyIH0gZnJvbSAnLi9jb21wb25lbnRzL0FsZXJ0UmVwb3J0Q3JvblNjaGVkdWxlcic7XG5pbXBvcnQgeyBOb3RpZmljYXRpb25NZXRob2QgfSBmcm9tICcuL2NvbXBvbmVudHMvTm90aWZpY2F0aW9uTWV0aG9kJztcbmNvbnN0IFRJTUVPVVRfTUlOID0gMTtcbmNvbnN0IFRFWFRfQkFTRURfVklTVUFMSVpBVElPTl9UWVBFUyA9IFtcbiAgICAncGl2b3RfdGFibGUnLFxuICAgICdwaXZvdF90YWJsZV92MicsXG4gICAgJ3RhYmxlJyxcbiAgICAncGFpcmVkX3R0ZXN0Jyxcbl07XG5jb25zdCBERUZBVUxUX05PVElGSUNBVElPTl9NRVRIT0RTID0gWydFbWFpbCddO1xuY29uc3QgREVGQVVMVF9OT1RJRklDQVRJT05fRk9STUFUID0gJ1BORyc7XG5jb25zdCBDT05ESVRJT05TID0gW1xuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJzwgKFNtYWxsZXIgdGhhbiknKSxcbiAgICAgICAgdmFsdWU6ICc8JyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJz4gKExhcmdlciB0aGFuKScpLFxuICAgICAgICB2YWx1ZTogJz4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnPD0gKFNtYWxsZXIgb3IgZXF1YWwpJyksXG4gICAgICAgIHZhbHVlOiAnPD0nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnPj0gKExhcmdlciBvciBlcXVhbCknKSxcbiAgICAgICAgdmFsdWU6ICc+PScsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCc9PSAoSXMgZXF1YWwpJyksXG4gICAgICAgIHZhbHVlOiAnPT0nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnIT0gKElzIG5vdCBlcXVhbCknKSxcbiAgICAgICAgdmFsdWU6ICchPScsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCdOb3QgbnVsbCcpLFxuICAgICAgICB2YWx1ZTogJ25vdCBudWxsJyxcbiAgICB9LFxuXTtcbmNvbnN0IFJFVEVOVElPTl9PUFRJT05TID0gW1xuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJ05vbmUnKSxcbiAgICAgICAgdmFsdWU6IDAsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGxhYmVsOiB0KCczMCBkYXlzJyksXG4gICAgICAgIHZhbHVlOiAzMCxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbGFiZWw6IHQoJzYwIGRheXMnKSxcbiAgICAgICAgdmFsdWU6IDYwLFxuICAgIH0sXG4gICAge1xuICAgICAgICBsYWJlbDogdCgnOTAgZGF5cycpLFxuICAgICAgICB2YWx1ZTogOTAsXG4gICAgfSxcbl07XG5jb25zdCBERUZBVUxUX1JFVEVOVElPTiA9IDkwO1xuY29uc3QgREVGQVVMVF9XT1JLSU5HX1RJTUVPVVQgPSAzNjAwO1xuY29uc3QgREVGQVVMVF9DUk9OX1ZBTFVFID0gJzAgKiAqICogKic7IC8vIGV2ZXJ5IGhvdXJcbmNvbnN0IERFRkFVTFRfQUxFUlQgPSB7XG4gICAgYWN0aXZlOiB0cnVlLFxuICAgIGNyZWF0aW9uX21ldGhvZDogJ2FsZXJ0c19yZXBvcnRzJyxcbiAgICBjcm9udGFiOiBERUZBVUxUX0NST05fVkFMVUUsXG4gICAgbG9nX3JldGVudGlvbjogREVGQVVMVF9SRVRFTlRJT04sXG4gICAgd29ya2luZ190aW1lb3V0OiBERUZBVUxUX1dPUktJTkdfVElNRU9VVCxcbiAgICBuYW1lOiAnJyxcbiAgICBvd25lcnM6IFtdLFxuICAgIHJlY2lwaWVudHM6IFtdLFxuICAgIHNxbDogJycsXG4gICAgdmFsaWRhdG9yX2NvbmZpZ19qc29uOiB7fSxcbiAgICB2YWxpZGF0b3JfdHlwZTogJycsXG4gICAgZ3JhY2VfcGVyaW9kOiB1bmRlZmluZWQsXG59O1xuY29uc3QgU3R5bGVkTW9kYWwgPSBzdHlsZWQoTW9kYWwpIGBcbiAgLmFudC1tb2RhbC1ib2R5IHtcbiAgICBvdmVyZmxvdzogaW5pdGlhbDtcbiAgfVxuYDtcbmNvbnN0IFN0eWxlZEljb24gPSAodGhlbWUpID0+IGNzcyBgXG4gIG1hcmdpbjogYXV0byAke3RoZW1lLmdyaWRVbml0ICogMn1weCBhdXRvIDA7XG4gIGNvbG9yOiAke3RoZW1lLmNvbG9ycy5ncmF5c2NhbGUuYmFzZX07XG5gO1xuY29uc3QgU3R5bGVkU2VjdGlvbkNvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBkaXNwbGF5OiBmbGV4O1xuICBtaW4td2lkdGg6IDEwMDBweDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblxuICAuaGVhZGVyLXNlY3Rpb24ge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleDogMCAwIGF1dG87XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBwYWRkaW5nOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weDtcbiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0Mn07XG4gIH1cblxuICAuY29sdW1uLXNlY3Rpb24ge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleDogMSAxIGF1dG87XG5cbiAgICAuY29sdW1uIHtcbiAgICAgIGZsZXg6IDEgMSBhdXRvO1xuICAgICAgbWluLXdpZHRoOiBjYWxjKDMzLjMzJSAtICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA4fXB4KTtcbiAgICAgIHBhZGRpbmc6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiA0fXB4O1xuXG4gICAgICAuYXN5bmMtc2VsZWN0IHtcbiAgICAgICAgbWFyZ2luOiAxMHB4IDAgMjBweDtcbiAgICAgIH1cblxuICAgICAgJi5jb25kaXRpb24ge1xuICAgICAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbiAgICAgIH1cblxuICAgICAgJi5tZXNzYWdlIHtcbiAgICAgICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5ncmF5c2NhbGUubGlnaHQyfTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAuaW5saW5lLWNvbnRhaW5lciB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgJi53cmFwIHtcbiAgICAgIGZsZXgtd3JhcDogd3JhcDtcbiAgICB9XG5cbiAgICA+IGRpdiB7XG4gICAgICBmbGV4OiAxIDEgYXV0bztcbiAgICB9XG5cbiAgICAmLmFkZC1tYXJnaW4ge1xuICAgICAgbWFyZ2luLWJvdHRvbTogNXB4O1xuICAgIH1cblxuICAgIC5zdHlsZWQtaW5wdXQge1xuICAgICAgbWFyZ2luOiAwIDAgMCAxMHB4O1xuXG4gICAgICBpbnB1dCB7XG4gICAgICAgIGZsZXg6IDAgMCBhdXRvO1xuICAgICAgfVxuICAgIH1cbiAgfVxuYDtcbmNvbnN0IFN0eWxlZFNlY3Rpb25UaXRsZSA9IHN0eWxlZC5kaXYgYFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBtYXJnaW46ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4IGF1dG9cbiAgICAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogNH1weCBhdXRvO1xuXG4gIGg0IHtcbiAgICBtYXJnaW46IDA7XG4gIH1cblxuICAucmVxdWlyZWQge1xuICAgIG1hcmdpbi1sZWZ0OiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4O1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5lcnJvci5iYXNlfTtcbiAgfVxuYDtcbmNvbnN0IFN0eWxlZFN3aXRjaENvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICBtYXJnaW4tdG9wOiAxMHB4O1xuXG4gIC5zd2l0Y2gtbGFiZWwge1xuICAgIG1hcmdpbi1sZWZ0OiAxMHB4O1xuICB9XG5gO1xuZXhwb3J0IGNvbnN0IFN0eWxlZElucHV0Q29udGFpbmVyID0gc3R5bGVkLmRpdiBgXG4gIGZsZXg6IDE7XG4gIG1hcmdpbjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gIG1hcmdpbi10b3A6IDA7XG5cbiAgLmhlbHBlciB7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfTtcbiAgICBmb250LXNpemU6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUudHlwb2dyYXBoeS5zaXplcy5zIC0gMX1weDtcbiAgICBwYWRkaW5nOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0fXB4IDA7XG4gICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgfVxuXG4gIC5yZXF1aXJlZCB7XG4gICAgbWFyZ2luLWxlZnQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgLyAyfXB4O1xuICAgIGNvbG9yOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmNvbG9ycy5lcnJvci5iYXNlfTtcbiAgfVxuXG4gIC5pbnB1dC1jb250YWluZXIge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcblxuICAgID4gZGl2IHtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cblxuICAgIGxhYmVsIHtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICAgIH1cblxuICAgIGkge1xuICAgICAgbWFyZ2luOiAwICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG4gICAgfVxuICB9XG5cbiAgaW5wdXQsXG4gIHRleHRhcmVhIHtcbiAgICBmbGV4OiAxIDEgYXV0bztcbiAgfVxuXG4gIGlucHV0W2Rpc2FibGVkXSB7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5iYXNlfTtcbiAgfVxuXG4gIHRleHRhcmVhIHtcbiAgICBoZWlnaHQ6IDMwMHB4O1xuICAgIHJlc2l6ZTogbm9uZTtcbiAgfVxuXG4gIGlucHV0OjpwbGFjZWhvbGRlcixcbiAgdGV4dGFyZWE6OnBsYWNlaG9sZGVyIHtcbiAgICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMuZ3JheXNjYWxlLmxpZ2h0MX07XG4gIH1cblxuICB0ZXh0YXJlYSxcbiAgaW5wdXRbdHlwZT0ndGV4dCddLFxuICBpbnB1dFt0eXBlPSdudW1iZXInXSB7XG4gICAgcGFkZGluZzogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdH1weFxuICAgICAgJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDJ9cHg7XG4gICAgYm9yZGVyLXN0eWxlOiBub25lO1xuICAgIGJvcmRlcjogMXB4IHNvbGlkICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDJ9O1xuICAgIGJvcmRlci1yYWRpdXM6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXR9cHg7XG5cbiAgICAmW25hbWU9J2Rlc2NyaXB0aW9uJ10ge1xuICAgICAgZmxleDogMSAxIGF1dG87XG4gICAgfVxuICB9XG5cbiAgLmlucHV0LWxhYmVsIHtcbiAgICBtYXJnaW4tbGVmdDogMTBweDtcbiAgfVxuYDtcbmNvbnN0IFN0eWxlZFJhZGlvID0gc3R5bGVkKFJhZGlvKSBgXG4gIGRpc3BsYXk6IGJsb2NrO1xuICBsaW5lLWhlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDd9cHg7XG5gO1xuY29uc3QgU3R5bGVkUmFkaW9Hcm91cCA9IHN0eWxlZChSYWRpby5Hcm91cCkgYFxuICBtYXJnaW4tbGVmdDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5ncmlkVW5pdCAqIDUuNX1weDtcbmA7XG4vLyBOb3RpZmljYXRpb24gTWV0aG9kIGNvbXBvbmVudHNcbmNvbnN0IFN0eWxlZE5vdGlmaWNhdGlvbkFkZEJ1dHRvbiA9IHN0eWxlZC5kaXYgYFxuICBjb2xvcjogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS5jb2xvcnMucHJpbWFyeS5kYXJrMX07XG4gIGN1cnNvcjogcG9pbnRlcjtcblxuICBpIHtcbiAgICBtYXJnaW4tcmlnaHQ6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuZ3JpZFVuaXQgKiAyfXB4O1xuICB9XG5cbiAgJi5kaXNhYmxlZCB7XG4gICAgY29sb3I6ICR7KHsgdGhlbWUgfSkgPT4gdGhlbWUuY29sb3JzLmdyYXlzY2FsZS5saWdodDF9O1xuICAgIGN1cnNvcjogZGVmYXVsdDtcbiAgfVxuYDtcbmNvbnN0IHRpbWV6b25lSGVhZGVyU3R5bGUgPSAodGhlbWUpID0+IGNzcyBgXG4gIG1hcmdpbjogJHt0aGVtZS5ncmlkVW5pdCAqIDN9cHggMDtcbmA7XG5jb25zdCBOb3RpZmljYXRpb25NZXRob2RBZGQgPSAoeyBzdGF0dXMgPSAnYWN0aXZlJywgb25DbGljaywgfSkgPT4ge1xuICAgIGlmIChzdGF0dXMgPT09ICdoaWRkZW4nKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBjaGVja1N0YXR1cyA9ICgpID0+IHtcbiAgICAgICAgaWYgKHN0YXR1cyAhPT0gJ2Rpc2FibGVkJykge1xuICAgICAgICAgICAgb25DbGljaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gKDxTdHlsZWROb3RpZmljYXRpb25BZGRCdXR0b24gY2xhc3NOYW1lPXtzdGF0dXN9IG9uQ2xpY2s9e2NoZWNrU3RhdHVzfT5cbiAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXBsdXNcIi8+eycgJ31cbiAgICAgIHtzdGF0dXMgPT09ICdhY3RpdmUnXG4gICAgICAgICAgICA/IHQoJ0FkZCBub3RpZmljYXRpb24gbWV0aG9kJylcbiAgICAgICAgICAgIDogdCgnQWRkIGRlbGl2ZXJ5IG1ldGhvZCcpfVxuICAgIDwvU3R5bGVkTm90aWZpY2F0aW9uQWRkQnV0dG9uPik7XG59O1xuY29uc3QgQWxlcnRSZXBvcnRNb2RhbCA9ICh7IGFkZERhbmdlclRvYXN0LCBvbkFkZCwgb25IaWRlLCBzaG93LCBhbGVydCA9IG51bGwsIGlzUmVwb3J0ID0gZmFsc2UsIH0pID0+IHtcbiAgICBjb25zdCBjb25mID0gdXNlQ29tbW9uQ29uZigpO1xuICAgIGNvbnN0IGFsbG93ZWROb3RpZmljYXRpb25NZXRob2RzID0gY29uZj8uQUxFUlRfUkVQT1JUU19OT1RJRklDQVRJT05fTUVUSE9EUyB8fCBERUZBVUxUX05PVElGSUNBVElPTl9NRVRIT0RTO1xuICAgIGNvbnN0IFtkaXNhYmxlU2F2ZSwgc2V0RGlzYWJsZVNhdmVdID0gdXNlU3RhdGUodHJ1ZSk7XG4gICAgY29uc3QgW2N1cnJlbnRBbGVydCwgc2V0Q3VycmVudEFsZXJ0LF0gPSB1c2VTdGF0ZSgpO1xuICAgIGNvbnN0IFtpc0hpZGRlbiwgc2V0SXNIaWRkZW5dID0gdXNlU3RhdGUodHJ1ZSk7XG4gICAgY29uc3QgW2NvbnRlbnRUeXBlLCBzZXRDb250ZW50VHlwZV0gPSB1c2VTdGF0ZSgnZGFzaGJvYXJkJyk7XG4gICAgY29uc3QgW3JlcG9ydEZvcm1hdCwgc2V0UmVwb3J0Rm9ybWF0XSA9IHVzZVN0YXRlKERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVCk7XG4gICAgLy8gRHJvcGRvd24gb3B0aW9uc1xuICAgIGNvbnN0IFtjb25kaXRpb25Ob3ROdWxsLCBzZXRDb25kaXRpb25Ob3ROdWxsXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbc291cmNlT3B0aW9ucywgc2V0U291cmNlT3B0aW9uc10gPSB1c2VTdGF0ZShbXSk7XG4gICAgY29uc3QgW2Rhc2hib2FyZE9wdGlvbnMsIHNldERhc2hib2FyZE9wdGlvbnNdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IFtjaGFydE9wdGlvbnMsIHNldENoYXJ0T3B0aW9uc10gPSB1c2VTdGF0ZShbXSk7XG4gICAgLy8gQ2hhcnQgbWV0YWRhdGFcbiAgICBjb25zdCBbY2hhcnRWaXpUeXBlLCBzZXRDaGFydFZpelR5cGVdID0gdXNlU3RhdGUoJycpO1xuICAgIGNvbnN0IGlzRWRpdE1vZGUgPSBhbGVydCAhPT0gbnVsbDtcbiAgICBjb25zdCBmb3JtYXRPcHRpb25FbmFibGVkID0gY29udGVudFR5cGUgPT09ICdjaGFydCcgJiZcbiAgICAgICAgKGlzRmVhdHVyZUVuYWJsZWQoRmVhdHVyZUZsYWcuQUxFUlRTX0FUVEFDSF9SRVBPUlRTKSB8fCBpc1JlcG9ydCk7XG4gICAgY29uc3QgW25vdGlmaWNhdGlvbkFkZFN0YXRlLCBzZXROb3RpZmljYXRpb25BZGRTdGF0ZSxdID0gdXNlU3RhdGUoJ2FjdGl2ZScpO1xuICAgIGNvbnN0IFtub3RpZmljYXRpb25TZXR0aW5ncywgc2V0Tm90aWZpY2F0aW9uU2V0dGluZ3NdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IG9uTm90aWZpY2F0aW9uQWRkID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IG5vdGlmaWNhdGlvblNldHRpbmdzLnNsaWNlKCk7XG4gICAgICAgIHNldHRpbmdzLnB1c2goe1xuICAgICAgICAgICAgcmVjaXBpZW50czogJycsXG4gICAgICAgICAgICBvcHRpb25zOiBhbGxvd2VkTm90aWZpY2F0aW9uTWV0aG9kcyxcbiAgICAgICAgfSk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9uQWRkU3RhdGUoc2V0dGluZ3MubGVuZ3RoID09PSBhbGxvd2VkTm90aWZpY2F0aW9uTWV0aG9kcy5sZW5ndGhcbiAgICAgICAgICAgID8gJ2hpZGRlbidcbiAgICAgICAgICAgIDogJ2Rpc2FibGVkJyk7XG4gICAgfTtcbiAgICBjb25zdCB1cGRhdGVOb3RpZmljYXRpb25TZXR0aW5nID0gKGluZGV4LCBzZXR0aW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gbm90aWZpY2F0aW9uU2V0dGluZ3Muc2xpY2UoKTtcbiAgICAgICAgc2V0dGluZ3NbaW5kZXhdID0gc2V0dGluZztcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9uU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgICAgICBpZiAoc2V0dGluZy5tZXRob2QgIT09IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb25BZGRTdGF0ZSAhPT0gJ2hpZGRlbicpIHtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgcmVtb3ZlTm90aWZpY2F0aW9uU2V0dGluZyA9IChpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IG5vdGlmaWNhdGlvblNldHRpbmdzLnNsaWNlKCk7XG4gICAgICAgIHNldHRpbmdzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9uQWRkU3RhdGUoJ2FjdGl2ZScpO1xuICAgIH07XG4gICAgLy8gQWxlcnQgZmV0Y2ggbG9naWNcbiAgICBjb25zdCB7IHN0YXRlOiB7IGxvYWRpbmcsIHJlc291cmNlLCBlcnJvcjogZmV0Y2hFcnJvciB9LCBmZXRjaFJlc291cmNlLCBjcmVhdGVSZXNvdXJjZSwgdXBkYXRlUmVzb3VyY2UsIGNsZWFyRXJyb3IsIH0gPSB1c2VTaW5nbGVWaWV3UmVzb3VyY2UoJ3JlcG9ydCcsIHQoJ3JlcG9ydCcpLCBhZGREYW5nZXJUb2FzdCk7XG4gICAgLy8gRnVuY3Rpb25zXG4gICAgY29uc3QgaGlkZSA9ICgpID0+IHtcbiAgICAgICAgY2xlYXJFcnJvcigpO1xuICAgICAgICBzZXRJc0hpZGRlbih0cnVlKTtcbiAgICAgICAgb25IaWRlKCk7XG4gICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKFtdKTtcbiAgICAgICAgc2V0Q3VycmVudEFsZXJ0KHsgLi4uREVGQVVMVF9BTEVSVCB9KTtcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9uQWRkU3RhdGUoJ2FjdGl2ZScpO1xuICAgIH07XG4gICAgY29uc3Qgb25TYXZlID0gKCkgPT4ge1xuICAgICAgICAvLyBOb3RpZmljYXRpb24gU2V0dGluZ3NcbiAgICAgICAgY29uc3QgcmVjaXBpZW50cyA9IFtdO1xuICAgICAgICBub3RpZmljYXRpb25TZXR0aW5ncy5mb3JFYWNoKHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgaWYgKHNldHRpbmcubWV0aG9kICYmIHNldHRpbmcucmVjaXBpZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZWNpcGllbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRfY29uZmlnX2pzb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogc2V0dGluZy5yZWNpcGllbnRzLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBzZXR0aW5nLm1ldGhvZCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAuLi5jdXJyZW50QWxlcnQsXG4gICAgICAgICAgICB0eXBlOiBpc1JlcG9ydCA/ICdSZXBvcnQnIDogJ0FsZXJ0JyxcbiAgICAgICAgICAgIHZhbGlkYXRvcl90eXBlOiBjb25kaXRpb25Ob3ROdWxsID8gJ25vdCBudWxsJyA6ICdvcGVyYXRvcicsXG4gICAgICAgICAgICB2YWxpZGF0b3JfY29uZmlnX2pzb246IGNvbmRpdGlvbk5vdE51bGxcbiAgICAgICAgICAgICAgICA/IHt9XG4gICAgICAgICAgICAgICAgOiBjdXJyZW50QWxlcnQ/LnZhbGlkYXRvcl9jb25maWdfanNvbixcbiAgICAgICAgICAgIGNoYXJ0OiBjb250ZW50VHlwZSA9PT0gJ2NoYXJ0JyA/IGN1cnJlbnRBbGVydD8uY2hhcnQ/LnZhbHVlIDogbnVsbCxcbiAgICAgICAgICAgIGRhc2hib2FyZDogY29udGVudFR5cGUgPT09ICdkYXNoYm9hcmQnID8gY3VycmVudEFsZXJ0Py5kYXNoYm9hcmQ/LnZhbHVlIDogbnVsbCxcbiAgICAgICAgICAgIGRhdGFiYXNlOiBjdXJyZW50QWxlcnQ/LmRhdGFiYXNlPy52YWx1ZSxcbiAgICAgICAgICAgIG93bmVyczogKGN1cnJlbnRBbGVydD8ub3duZXJzIHx8IFtdKS5tYXAob3duZXIgPT4gb3duZXIudmFsdWUpLFxuICAgICAgICAgICAgcmVjaXBpZW50cyxcbiAgICAgICAgICAgIHJlcG9ydF9mb3JtYXQ6IGNvbnRlbnRUeXBlID09PSAnZGFzaGJvYXJkJ1xuICAgICAgICAgICAgICAgID8gREVGQVVMVF9OT1RJRklDQVRJT05fRk9STUFUXG4gICAgICAgICAgICAgICAgOiByZXBvcnRGb3JtYXQgfHwgREVGQVVMVF9OT1RJRklDQVRJT05fRk9STUFULFxuICAgICAgICB9O1xuICAgICAgICBpZiAoZGF0YS5yZWNpcGllbnRzICYmICFkYXRhLnJlY2lwaWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBkZWxldGUgZGF0YS5yZWNpcGllbnRzO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEuY29udGV4dF9tYXJrZG93biA9ICdzdHJpbmcnO1xuICAgICAgICBpZiAoaXNFZGl0TW9kZSkge1xuICAgICAgICAgICAgLy8gRWRpdFxuICAgICAgICAgICAgaWYgKGN1cnJlbnRBbGVydCAmJiBjdXJyZW50QWxlcnQuaWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVfaWQgPSBjdXJyZW50QWxlcnQuaWQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEuaWQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEuY3JlYXRlZF9ieTtcbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5sYXN0X2V2YWxfZHR0bTtcbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5sYXN0X3N0YXRlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBkYXRhLmxhc3RfdmFsdWU7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEubGFzdF92YWx1ZV9yb3dfanNvbjtcbiAgICAgICAgICAgICAgICB1cGRhdGVSZXNvdXJjZSh1cGRhdGVfaWQsIGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9uQWRkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkFkZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGhpZGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjdXJyZW50QWxlcnQpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZVxuICAgICAgICAgICAgY3JlYXRlUmVzb3VyY2UoZGF0YSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvbkFkZCkge1xuICAgICAgICAgICAgICAgICAgICBvbkFkZChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhpZGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBGZXRjaCBkYXRhIHRvIHBvcHVsYXRlIGZvcm0gZHJvcGRvd25zXG4gICAgY29uc3QgbG9hZE93bmVyT3B0aW9ucyA9IHVzZU1lbW8oKCkgPT4gKGlucHV0ID0gJycsIHBhZ2UsIHBhZ2VTaXplKSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gcmlzb24uZW5jb2RlKHsgZmlsdGVyOiBpbnB1dCwgcGFnZSwgcGFnZV9zaXplOiBwYWdlU2l6ZSB9KTtcbiAgICAgICAgcmV0dXJuIFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICAgICAgICBlbmRwb2ludDogYC9hcGkvdjEvcmVwb3J0L3JlbGF0ZWQvb3duZXJzP3E9JHtxdWVyeX1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+ICh7XG4gICAgICAgICAgICBkYXRhOiByZXNwb25zZS5qc29uLnJlc3VsdC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQsXG4gICAgICAgIH0pKTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgZ2V0U291cmNlRGF0YSA9IHVzZUNhbGxiYWNrKChkYikgPT4ge1xuICAgICAgICBjb25zdCBkYXRhYmFzZSA9IGRiIHx8IGN1cnJlbnRBbGVydD8uZGF0YWJhc2U7XG4gICAgICAgIGlmICghZGF0YWJhc2UgfHwgZGF0YWJhc2UubGFiZWwpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgIC8vIEN5Y2xlIHRocm91Z2ggc291cmNlIG9wdGlvbnMgdG8gZmluZCB0aGUgc2VsZWN0ZWQgb3B0aW9uXG4gICAgICAgIHNvdXJjZU9wdGlvbnMuZm9yRWFjaChzb3VyY2UgPT4ge1xuICAgICAgICAgICAgaWYgKHNvdXJjZS52YWx1ZSA9PT0gZGF0YWJhc2UudmFsdWUgfHwgc291cmNlLnZhbHVlID09PSBkYXRhYmFzZS5pZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNvdXJjZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSwgW2N1cnJlbnRBbGVydD8uZGF0YWJhc2UsIHNvdXJjZU9wdGlvbnNdKTtcbiAgICAvLyBVcGRhdGluZyBhbGVydC9yZXBvcnQgc3RhdGVcbiAgICBjb25zdCB1cGRhdGVBbGVydFN0YXRlID0gKG5hbWUsIHZhbHVlKSA9PiB7XG4gICAgICAgIHNldEN1cnJlbnRBbGVydChjdXJyZW50QWxlcnREYXRhID0+ICh7XG4gICAgICAgICAgICAuLi5jdXJyZW50QWxlcnREYXRhLFxuICAgICAgICAgICAgW25hbWVdOiB2YWx1ZSxcbiAgICAgICAgfSkpO1xuICAgIH07XG4gICAgY29uc3QgbG9hZFNvdXJjZU9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IChpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogaW5wdXQsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL3JlcG9ydC9yZWxhdGVkL2RhdGFiYXNlP3E9JHtxdWVyeX1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSByZXNwb25zZS5qc29uLnJlc3VsdC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHNldFNvdXJjZU9wdGlvbnMobGlzdCk7XG4gICAgICAgICAgICByZXR1cm4geyBkYXRhOiBsaXN0LCB0b3RhbENvdW50OiByZXNwb25zZS5qc29uLmNvdW50IH07XG4gICAgICAgIH0pO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBkYXRhYmFzZUxhYmVsID0gY3VycmVudEFsZXJ0ICYmIGN1cnJlbnRBbGVydC5kYXRhYmFzZSAmJiAhY3VycmVudEFsZXJ0LmRhdGFiYXNlLmxhYmVsO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8vIEZpbmQgc291cmNlIGlmIGN1cnJlbnQgYWxlcnQgaGFzIG9uZSBzZXRcbiAgICAgICAgaWYgKGRhdGFiYXNlTGFiZWwpIHtcbiAgICAgICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2RhdGFiYXNlJywgZ2V0U291cmNlRGF0YSgpKTtcbiAgICAgICAgfVxuICAgIH0sIFtkYXRhYmFzZUxhYmVsLCBnZXRTb3VyY2VEYXRhXSk7XG4gICAgY29uc3QgbG9hZERhc2hib2FyZE9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IChpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogaW5wdXQsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL3JlcG9ydC9yZWxhdGVkL2Rhc2hib2FyZD9xPSR7cXVlcnl9YCxcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ID0gcmVzcG9uc2UuanNvbi5yZXN1bHQubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBpdGVtLnRleHQsXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBzZXREYXNoYm9hcmRPcHRpb25zKGxpc3QpO1xuICAgICAgICAgICAgcmV0dXJuIHsgZGF0YTogbGlzdCwgdG90YWxDb3VudDogcmVzcG9uc2UuanNvbi5jb3VudCB9O1xuICAgICAgICB9KTtcbiAgICB9LCBbXSk7XG4gICAgY29uc3QgZ2V0RGFzaGJvYXJkRGF0YSA9IChkYikgPT4ge1xuICAgICAgICBjb25zdCBkYXNoYm9hcmQgPSBkYiB8fCBjdXJyZW50QWxlcnQ/LmRhc2hib2FyZDtcbiAgICAgICAgaWYgKCFkYXNoYm9hcmQgfHwgZGFzaGJvYXJkLmxhYmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAvLyBDeWNsZSB0aHJvdWdoIGRhc2hib2FyZCBvcHRpb25zIHRvIGZpbmQgdGhlIHNlbGVjdGVkIG9wdGlvblxuICAgICAgICBkYXNoYm9hcmRPcHRpb25zLmZvckVhY2goZGFzaCA9PiB7XG4gICAgICAgICAgICBpZiAoZGFzaC52YWx1ZSA9PT0gZGFzaGJvYXJkLnZhbHVlIHx8IGRhc2gudmFsdWUgPT09IGRhc2hib2FyZC5pZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGRhc2g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgY29uc3QgZ2V0Q2hhcnREYXRhID0gdXNlQ2FsbGJhY2soKGNoYXJ0RGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBjaGFydCA9IGNoYXJ0RGF0YSB8fCBjdXJyZW50QWxlcnQ/LmNoYXJ0O1xuICAgICAgICBpZiAoIWNoYXJ0IHx8IGNoYXJ0LmxhYmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAvLyBDeWNsZSB0aHJvdWdoIGNoYXJ0IG9wdGlvbnMgdG8gZmluZCB0aGUgc2VsZWN0ZWQgb3B0aW9uXG4gICAgICAgIGNoYXJ0T3B0aW9ucy5mb3JFYWNoKHNsaWNlID0+IHtcbiAgICAgICAgICAgIGlmIChzbGljZS52YWx1ZSA9PT0gY2hhcnQudmFsdWUgfHwgc2xpY2UudmFsdWUgPT09IGNoYXJ0LmlkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gc2xpY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sIFtjaGFydE9wdGlvbnMsIGN1cnJlbnRBbGVydD8uY2hhcnRdKTtcbiAgICBjb25zdCBub0NoYXJ0TGFiZWwgPSBjdXJyZW50QWxlcnQgJiYgY3VycmVudEFsZXJ0LmNoYXJ0ICYmICFjdXJyZW50QWxlcnQuY2hhcnQubGFiZWw7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgLy8gRmluZCBzb3VyY2UgaWYgY3VycmVudCBhbGVydCBoYXMgb25lIHNldFxuICAgICAgICBpZiAobm9DaGFydExhYmVsKSB7XG4gICAgICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdjaGFydCcsIGdldENoYXJ0RGF0YSgpKTtcbiAgICAgICAgfVxuICAgIH0sIFtnZXRDaGFydERhdGEsIG5vQ2hhcnRMYWJlbF0pO1xuICAgIGNvbnN0IGxvYWRDaGFydE9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IChpbnB1dCA9ICcnLCBwYWdlLCBwYWdlU2l6ZSkgPT4ge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHJpc29uLmVuY29kZSh7IGZpbHRlcjogaW5wdXQsIHBhZ2UsIHBhZ2Vfc2l6ZTogcGFnZVNpemUgfSk7XG4gICAgICAgIHJldHVybiBTdXBlcnNldENsaWVudC5nZXQoe1xuICAgICAgICAgICAgZW5kcG9pbnQ6IGAvYXBpL3YxL3JlcG9ydC9yZWxhdGVkL2NoYXJ0P3E9JHtxdWVyeX1gLFxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSByZXNwb25zZS5qc29uLnJlc3VsdC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0udGV4dCxcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHNldENoYXJ0T3B0aW9ucyhsaXN0KTtcbiAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IGxpc3QsIHRvdGFsQ291bnQ6IHJlc3BvbnNlLmpzb24uY291bnQgfTtcbiAgICAgICAgfSk7XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IGdldENoYXJ0VmlzdWFsaXphdGlvblR5cGUgPSAoY2hhcnQpID0+IFN1cGVyc2V0Q2xpZW50LmdldCh7XG4gICAgICAgIGVuZHBvaW50OiBgL2FwaS92MS9jaGFydC8ke2NoYXJ0LnZhbHVlfWAsXG4gICAgfSkudGhlbihyZXNwb25zZSA9PiBzZXRDaGFydFZpelR5cGUocmVzcG9uc2UuanNvbi5yZXN1bHQudml6X3R5cGUpKTtcbiAgICAvLyBIYW5kbGUgaW5wdXQvdGV4dGFyZWEgdXBkYXRlc1xuICAgIGNvbnN0IG9uVGV4dENoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnQ7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUodGFyZ2V0Lm5hbWUsIHRhcmdldC52YWx1ZSk7XG4gICAgfTtcbiAgICBjb25zdCBvblRpbWVvdXRWZXJpZnlDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGV2ZW50O1xuICAgICAgICBjb25zdCB2YWx1ZSA9ICt0YXJnZXQudmFsdWU7XG4gICAgICAgIC8vIE5lZWQgdG8gbWFrZSBzdXJlIGdyYWNlIHBlcmlvZCBpcyBub3QgbG93ZXIgdGhhbiBUSU1FT1VUX01JTlxuICAgICAgICBpZiAodmFsdWUgPT09IDApIHtcbiAgICAgICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUodGFyZ2V0Lm5hbWUsIG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSh0YXJnZXQubmFtZSwgdmFsdWUgPyBNYXRoLm1heCh2YWx1ZSwgVElNRU9VVF9NSU4pIDogdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBvblNRTENoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdzcWwnLCB2YWx1ZSB8fCAnJyk7XG4gICAgfTtcbiAgICBjb25zdCBvbk93bmVyc0NoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdvd25lcnMnLCB2YWx1ZSB8fCBbXSk7XG4gICAgfTtcbiAgICBjb25zdCBvblNvdXJjZUNoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdkYXRhYmFzZScsIHZhbHVlIHx8IFtdKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uRGFzaGJvYXJkQ2hhbmdlID0gKGRhc2hib2FyZCkgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdkYXNoYm9hcmQnLCBkYXNoYm9hcmQgfHwgdW5kZWZpbmVkKTtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnY2hhcnQnLCBudWxsKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uQ2hhcnRDaGFuZ2UgPSAoY2hhcnQpID0+IHtcbiAgICAgICAgZ2V0Q2hhcnRWaXN1YWxpemF0aW9uVHlwZShjaGFydCk7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2NoYXJ0JywgY2hhcnQgfHwgdW5kZWZpbmVkKTtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgnZGFzaGJvYXJkJywgbnVsbCk7XG4gICAgfTtcbiAgICBjb25zdCBvbkFjdGl2ZVN3aXRjaCA9IChjaGVja2VkKSA9PiB7XG4gICAgICAgIHVwZGF0ZUFsZXJ0U3RhdGUoJ2FjdGl2ZScsIGNoZWNrZWQpO1xuICAgIH07XG4gICAgY29uc3Qgb25Db25kaXRpb25DaGFuZ2UgPSAob3ApID0+IHtcbiAgICAgICAgc2V0Q29uZGl0aW9uTm90TnVsbChvcCA9PT0gJ25vdCBudWxsJyk7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHtcbiAgICAgICAgICAgIG9wLFxuICAgICAgICAgICAgdGhyZXNob2xkOiBjdXJyZW50QWxlcnRcbiAgICAgICAgICAgICAgICA/IGN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24/LnRocmVzaG9sZFxuICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICB9O1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCd2YWxpZGF0b3JfY29uZmlnX2pzb24nLCBjb25maWcpO1xuICAgIH07XG4gICAgY29uc3Qgb25UaHJlc2hvbGRDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGV2ZW50O1xuICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICBvcDogY3VycmVudEFsZXJ0ID8gY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbj8ub3AgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICB0aHJlc2hvbGQ6IHRhcmdldC52YWx1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgndmFsaWRhdG9yX2NvbmZpZ19qc29uJywgY29uZmlnKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uTG9nUmV0ZW50aW9uQ2hhbmdlID0gKHJldGVudGlvbikgPT4ge1xuICAgICAgICB1cGRhdGVBbGVydFN0YXRlKCdsb2dfcmV0ZW50aW9uJywgcmV0ZW50aW9uKTtcbiAgICB9O1xuICAgIGNvbnN0IG9uVGltZXpvbmVDaGFuZ2UgPSAodGltZXpvbmUpID0+IHtcbiAgICAgICAgdXBkYXRlQWxlcnRTdGF0ZSgndGltZXpvbmUnLCB0aW1lem9uZSk7XG4gICAgfTtcbiAgICBjb25zdCBvbkNvbnRlbnRUeXBlQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0IH0gPSBldmVudDtcbiAgICAgICAgLy8gR2l2ZXMgdGltZSB0byBjbG9zZSB0aGUgc2VsZWN0IGJlZm9yZSBjaGFuZ2luZyB0aGUgdHlwZVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHNldENvbnRlbnRUeXBlKHRhcmdldC52YWx1ZSksIDIwMCk7XG4gICAgfTtcbiAgICBjb25zdCBvbkZvcm1hdENoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnQ7XG4gICAgICAgIHNldFJlcG9ydEZvcm1hdCh0YXJnZXQudmFsdWUpO1xuICAgIH07XG4gICAgLy8gTWFrZSBzdXJlIG5vdGlmaWNhdGlvbiBzZXR0aW5ncyBoYXMgdGhlIHJlcXVpcmVkIGluZm9cbiAgICBjb25zdCBjaGVja05vdGlmaWNhdGlvblNldHRpbmdzID0gKCkgPT4ge1xuICAgICAgICBpZiAoIW5vdGlmaWNhdGlvblNldHRpbmdzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBoYXNJbmZvID0gZmFsc2U7XG4gICAgICAgIG5vdGlmaWNhdGlvblNldHRpbmdzLmZvckVhY2goc2V0dGluZyA9PiB7XG4gICAgICAgICAgICBpZiAoISFzZXR0aW5nLm1ldGhvZCAmJiBzZXR0aW5nLnJlY2lwaWVudHM/Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGhhc0luZm8gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGhhc0luZm87XG4gICAgfTtcbiAgICBjb25zdCB2YWxpZGF0ZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKGN1cnJlbnRBbGVydCAmJlxuICAgICAgICAgICAgY3VycmVudEFsZXJ0Lm5hbWU/Lmxlbmd0aCAmJlxuICAgICAgICAgICAgY3VycmVudEFsZXJ0Lm93bmVycz8ubGVuZ3RoICYmXG4gICAgICAgICAgICBjdXJyZW50QWxlcnQuY3JvbnRhYj8ubGVuZ3RoICYmXG4gICAgICAgICAgICBjdXJyZW50QWxlcnQud29ya2luZ190aW1lb3V0ICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICgoY29udGVudFR5cGUgPT09ICdkYXNoYm9hcmQnICYmICEhY3VycmVudEFsZXJ0LmRhc2hib2FyZCkgfHxcbiAgICAgICAgICAgICAgICAoY29udGVudFR5cGUgPT09ICdjaGFydCcgJiYgISFjdXJyZW50QWxlcnQuY2hhcnQpKSAmJlxuICAgICAgICAgICAgY2hlY2tOb3RpZmljYXRpb25TZXR0aW5ncygpKSB7XG4gICAgICAgICAgICBpZiAoaXNSZXBvcnQpIHtcbiAgICAgICAgICAgICAgICBzZXREaXNhYmxlU2F2ZShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghIWN1cnJlbnRBbGVydC5kYXRhYmFzZSAmJlxuICAgICAgICAgICAgICAgIGN1cnJlbnRBbGVydC5zcWw/Lmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgIChjb25kaXRpb25Ob3ROdWxsIHx8ICEhY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbj8ub3ApICYmXG4gICAgICAgICAgICAgICAgKGNvbmRpdGlvbk5vdE51bGwgfHxcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEFsZXJ0LnZhbGlkYXRvcl9jb25maWdfanNvbj8udGhyZXNob2xkICE9PSB1bmRlZmluZWQpKSB7XG4gICAgICAgICAgICAgICAgc2V0RGlzYWJsZVNhdmUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0RGlzYWJsZVNhdmUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZXREaXNhYmxlU2F2ZSh0cnVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gSW5pdGlhbGl6ZVxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChpc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAoIWN1cnJlbnRBbGVydD8uaWQgfHwgYWxlcnQ/LmlkICE9PSBjdXJyZW50QWxlcnQuaWQgfHwgKGlzSGlkZGVuICYmIHNob3cpKSkge1xuICAgICAgICAgICAgaWYgKGFsZXJ0ICYmIGFsZXJ0LmlkICE9PSBudWxsICYmICFsb2FkaW5nICYmICFmZXRjaEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaWQgPSBhbGVydC5pZCB8fCAwO1xuICAgICAgICAgICAgICAgIGZldGNoUmVzb3VyY2UoaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFpc0VkaXRNb2RlICYmXG4gICAgICAgICAgICAoIWN1cnJlbnRBbGVydCB8fCBjdXJyZW50QWxlcnQuaWQgfHwgKGlzSGlkZGVuICYmIHNob3cpKSkge1xuICAgICAgICAgICAgc2V0Q3VycmVudEFsZXJ0KHsgLi4uREVGQVVMVF9BTEVSVCB9KTtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKFtdKTtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKCdhY3RpdmUnKTtcbiAgICAgICAgfVxuICAgIH0sIFthbGVydF0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChyZXNvdXJjZSkge1xuICAgICAgICAgICAgLy8gQWRkIG5vdGlmaWNhdGlvbiBzZXR0aW5nc1xuICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSAocmVzb3VyY2UucmVjaXBpZW50cyB8fCBbXSkubWFwKHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHR5cGVvZiBzZXR0aW5nLnJlY2lwaWVudF9jb25maWdfanNvbiA9PT0gJ3N0cmluZydcbiAgICAgICAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKHNldHRpbmcucmVjaXBpZW50X2NvbmZpZ19qc29uKVxuICAgICAgICAgICAgICAgICAgICA6IHt9O1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogc2V0dGluZy50eXBlLFxuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlOiBUeXBlIG5vdCBhc3NpZ25hYmxlXG4gICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHM6IGNvbmZpZy50YXJnZXQgfHwgc2V0dGluZy5yZWNpcGllbnRfY29uZmlnX2pzb24sXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IGFsbG93ZWROb3RpZmljYXRpb25NZXRob2RzLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvblNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvbkFkZFN0YXRlKHNldHRpbmdzLmxlbmd0aCA9PT0gYWxsb3dlZE5vdGlmaWNhdGlvbk1ldGhvZHMubGVuZ3RoXG4gICAgICAgICAgICAgICAgPyAnaGlkZGVuJ1xuICAgICAgICAgICAgICAgIDogJ2FjdGl2ZScpO1xuICAgICAgICAgICAgc2V0Q29udGVudFR5cGUocmVzb3VyY2UuY2hhcnQgPyAnY2hhcnQnIDogJ2Rhc2hib2FyZCcpO1xuICAgICAgICAgICAgc2V0UmVwb3J0Rm9ybWF0KHJlc291cmNlLmNoYXJ0XG4gICAgICAgICAgICAgICAgPyByZXNvdXJjZS5yZXBvcnRfZm9ybWF0IHx8IERFRkFVTFRfTk9USUZJQ0FUSU9OX0ZPUk1BVFxuICAgICAgICAgICAgICAgIDogREVGQVVMVF9OT1RJRklDQVRJT05fRk9STUFUKTtcbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRvckNvbmZpZyA9IHR5cGVvZiByZXNvdXJjZS52YWxpZGF0b3JfY29uZmlnX2pzb24gPT09ICdzdHJpbmcnXG4gICAgICAgICAgICAgICAgPyBKU09OLnBhcnNlKHJlc291cmNlLnZhbGlkYXRvcl9jb25maWdfanNvbilcbiAgICAgICAgICAgICAgICA6IHJlc291cmNlLnZhbGlkYXRvcl9jb25maWdfanNvbjtcbiAgICAgICAgICAgIHNldENvbmRpdGlvbk5vdE51bGwocmVzb3VyY2UudmFsaWRhdG9yX3R5cGUgPT09ICdub3QgbnVsbCcpO1xuICAgICAgICAgICAgaWYgKHJlc291cmNlLmNoYXJ0KSB7XG4gICAgICAgICAgICAgICAgc2V0Q2hhcnRWaXpUeXBlKHJlc291cmNlLmNoYXJ0LnZpel90eXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldEN1cnJlbnRBbGVydCh7XG4gICAgICAgICAgICAgICAgLi4ucmVzb3VyY2UsXG4gICAgICAgICAgICAgICAgY2hhcnQ6IHJlc291cmNlLmNoYXJ0XG4gICAgICAgICAgICAgICAgICAgID8gZ2V0Q2hhcnREYXRhKHJlc291cmNlLmNoYXJ0KSB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcmVzb3VyY2UuY2hhcnQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogcmVzb3VyY2UuY2hhcnQuc2xpY2VfbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmQ6IHJlc291cmNlLmRhc2hib2FyZFxuICAgICAgICAgICAgICAgICAgICA/IGdldERhc2hib2FyZERhdGEocmVzb3VyY2UuZGFzaGJvYXJkKSB8fCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcmVzb3VyY2UuZGFzaGJvYXJkLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHJlc291cmNlLmRhc2hib2FyZC5kYXNoYm9hcmRfdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgZGF0YWJhc2U6IHJlc291cmNlLmRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgID8gZ2V0U291cmNlRGF0YShyZXNvdXJjZS5kYXRhYmFzZSkgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJlc291cmNlLmRhdGFiYXNlLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHJlc291cmNlLmRhdGFiYXNlLmRhdGFiYXNlX25hbWUsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgb3duZXJzOiAocmVzb3VyY2Uub3duZXJzIHx8IFtdKS5tYXAob3duZXIgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG93bmVyLmlkLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogYCR7b3duZXIuZmlyc3RfbmFtZX0gJHtvd25lci5sYXN0X25hbWV9YCxcbiAgICAgICAgICAgICAgICB9KSksXG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZTogVHlwZSBub3QgYXNzaWduYWJsZVxuICAgICAgICAgICAgICAgIHZhbGlkYXRvcl9jb25maWdfanNvbjogcmVzb3VyY2UudmFsaWRhdG9yX3R5cGUgPT09ICdub3QgbnVsbCdcbiAgICAgICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcDogJ25vdCBudWxsJyxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA6IHZhbGlkYXRvckNvbmZpZyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwgW3Jlc291cmNlXSk7XG4gICAgLy8gVmFsaWRhdGlvblxuICAgIGNvbnN0IGN1cnJlbnRBbGVydFNhZmUgPSBjdXJyZW50QWxlcnQgfHwge307XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgdmFsaWRhdGUoKTtcbiAgICB9LCBbXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUubmFtZSxcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS5vd25lcnMsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuZGF0YWJhc2UsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuc3FsLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLnZhbGlkYXRvcl9jb25maWdfanNvbixcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS5jcm9udGFiLFxuICAgICAgICBjdXJyZW50QWxlcnRTYWZlLndvcmtpbmdfdGltZW91dCxcbiAgICAgICAgY3VycmVudEFsZXJ0U2FmZS5kYXNoYm9hcmQsXG4gICAgICAgIGN1cnJlbnRBbGVydFNhZmUuY2hhcnQsXG4gICAgICAgIGNvbnRlbnRUeXBlLFxuICAgICAgICBub3RpZmljYXRpb25TZXR0aW5ncyxcbiAgICAgICAgY29uZGl0aW9uTm90TnVsbCxcbiAgICBdKTtcbiAgICAvLyBTaG93L2hpZGVcbiAgICBpZiAoaXNIaWRkZW4gJiYgc2hvdykge1xuICAgICAgICBzZXRJc0hpZGRlbihmYWxzZSk7XG4gICAgfVxuICAgIHJldHVybiAoPFN0eWxlZE1vZGFsIGNsYXNzTmFtZT1cIm5vLWNvbnRlbnQtcGFkZGluZ1wiIHJlc3BvbnNpdmUgZGlzYWJsZVByaW1hcnlCdXR0b249e2Rpc2FibGVTYXZlfSBvbkhhbmRsZWRQcmltYXJ5QWN0aW9uPXtvblNhdmV9IG9uSGlkZT17aGlkZX0gcHJpbWFyeUJ1dHRvbk5hbWU9e2lzRWRpdE1vZGUgPyB0KCdTYXZlJykgOiB0KCdBZGQnKX0gc2hvdz17c2hvd30gd2lkdGg9XCIxMDAlXCIgbWF4V2lkdGg9XCIxNDUwcHhcIiB0aXRsZT17PGg0IGRhdGEtdGVzdD1cImFsZXJ0LXJlcG9ydC1tb2RhbC10aXRsZVwiPlxuICAgICAgICAgIHtpc0VkaXRNb2RlID8gKDxJY29ucy5FZGl0QWx0IGNzcz17U3R5bGVkSWNvbn0vPikgOiAoPEljb25zLlBsdXNMYXJnZSBjc3M9e1N0eWxlZEljb259Lz4pfVxuICAgICAgICAgIHtpc0VkaXRNb2RlXG4gICAgICAgICAgICAgICAgPyB0KGBFZGl0ICR7aXNSZXBvcnQgPyAnUmVwb3J0JyA6ICdBbGVydCd9YClcbiAgICAgICAgICAgICAgICA6IHQoYEFkZCAke2lzUmVwb3J0ID8gJ1JlcG9ydCcgOiAnQWxlcnQnfWApfVxuICAgICAgICA8L2g0Pn0+XG4gICAgICA8U3R5bGVkU2VjdGlvbkNvbnRhaW5lcj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFkZXItc2VjdGlvblwiPlxuICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICB7aXNSZXBvcnQgPyB0KCdSZXBvcnQgbmFtZScpIDogdCgnQWxlcnQgbmFtZScpfVxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJuYW1lXCIgdmFsdWU9e2N1cnJlbnRBbGVydCA/IGN1cnJlbnRBbGVydC5uYW1lIDogJyd9IHBsYWNlaG9sZGVyPXtpc1JlcG9ydCA/IHQoJ1JlcG9ydCBuYW1lJykgOiB0KCdBbGVydCBuYW1lJyl9IG9uQ2hhbmdlPXtvblRleHRDaGFuZ2V9Lz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgIHt0KCdPd25lcnMnKX1cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtdGVzdD1cIm93bmVycy1zZWxlY3RcIiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgPFNlbGVjdCBhcmlhTGFiZWw9e3QoJ093bmVycycpfSBhbGxvd0NsZWFyIG5hbWU9XCJvd25lcnNcIiBtb2RlPVwibXVsdGlwbGVcIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py5vd25lcnMgfHwgW119IG9wdGlvbnM9e2xvYWRPd25lck9wdGlvbnN9IG9uQ2hhbmdlPXtvbk93bmVyc0NoYW5nZX0vPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj57dCgnRGVzY3JpcHRpb24nKX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJkZXNjcmlwdGlvblwiIHZhbHVlPXtjdXJyZW50QWxlcnQgPyBjdXJyZW50QWxlcnQuZGVzY3JpcHRpb24gfHwgJycgOiAnJ30gcGxhY2Vob2xkZXI9e3QoJ0Rlc2NyaXB0aW9uJyl9IG9uQ2hhbmdlPXtvblRleHRDaGFuZ2V9Lz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgPFN0eWxlZFN3aXRjaENvbnRhaW5lcj5cbiAgICAgICAgICAgIDxTd2l0Y2ggb25DaGFuZ2U9e29uQWN0aXZlU3dpdGNofSBjaGVja2VkPXtjdXJyZW50QWxlcnQgPyBjdXJyZW50QWxlcnQuYWN0aXZlIDogdHJ1ZX0vPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzd2l0Y2gtbGFiZWxcIj5BY3RpdmU8L2Rpdj5cbiAgICAgICAgICA8L1N0eWxlZFN3aXRjaENvbnRhaW5lcj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sdW1uLXNlY3Rpb25cIj5cbiAgICAgICAgICB7IWlzUmVwb3J0ICYmICg8ZGl2IGNsYXNzTmFtZT1cImNvbHVtbiBjb25kaXRpb25cIj5cbiAgICAgICAgICAgICAgPFN0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgICA8aDQ+e3QoJ0FsZXJ0IGNvbmRpdGlvbicpfTwvaDQ+XG4gICAgICAgICAgICAgIDwvU3R5bGVkU2VjdGlvblRpdGxlPlxuICAgICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAgICB7dCgnRGF0YWJhc2UnKX1cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgPFNlbGVjdCBhcmlhTGFiZWw9e3QoJ0RhdGFiYXNlJyl9IG5hbWU9XCJzb3VyY2VcIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py5kYXRhYmFzZT8ubGFiZWwgJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxlcnQ/LmRhdGFiYXNlPy52YWx1ZVxuICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY3VycmVudEFsZXJ0LmRhdGFiYXNlLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogY3VycmVudEFsZXJ0LmRhdGFiYXNlLmxhYmVsLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZH0gb3B0aW9ucz17bG9hZFNvdXJjZU9wdGlvbnN9IG9uQ2hhbmdlPXtvblNvdXJjZUNoYW5nZX0vPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICA8U3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAgICB7dCgnU1FMIFF1ZXJ5Jyl9XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPFRleHRBcmVhQ29udHJvbCBuYW1lPVwic3FsXCIgbGFuZ3VhZ2U9XCJzcWxcIiBvZmZlckVkaXRJbk1vZGFsPXtmYWxzZX0gbWluTGluZXM9ezE1fSBtYXhMaW5lcz17MTV9IG9uQ2hhbmdlPXtvblNRTENoYW5nZX0gcmVhZE9ubHk9e2ZhbHNlfSBpbml0aWFsVmFsdWU9e3Jlc291cmNlPy5zcWx9IGtleT17Y3VycmVudEFsZXJ0Py5pZH0vPlxuICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlubGluZS1jb250YWluZXIgd3JhcFwiPlxuICAgICAgICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnVHJpZ2dlciBBbGVydCBJZi4uLicpfVxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdDb25kaXRpb24nKX0gb25DaGFuZ2U9e29uQ29uZGl0aW9uQ2hhbmdlfSBwbGFjZWhvbGRlcj1cIkNvbmRpdGlvblwiIHZhbHVlPXtjdXJyZW50QWxlcnQ/LnZhbGlkYXRvcl9jb25maWdfanNvbj8ub3AgfHwgdW5kZWZpbmVkfSBvcHRpb25zPXtDT05ESVRJT05TfS8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiPlxuICAgICAgICAgICAgICAgICAgICB7dCgnVmFsdWUnKX1cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG5hbWU9XCJ0aHJlc2hvbGRcIiBkaXNhYmxlZD17Y29uZGl0aW9uTm90TnVsbH0gdmFsdWU9e2N1cnJlbnRBbGVydCAmJlxuICAgICAgICAgICAgICAgIGN1cnJlbnRBbGVydC52YWxpZGF0b3JfY29uZmlnX2pzb24gJiZcbiAgICAgICAgICAgICAgICBjdXJyZW50QWxlcnQudmFsaWRhdG9yX2NvbmZpZ19qc29uLnRocmVzaG9sZCAhPT1cbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgPyBjdXJyZW50QWxlcnQudmFsaWRhdG9yX2NvbmZpZ19qc29uLnRocmVzaG9sZFxuICAgICAgICAgICAgICAgIDogJyd9IHBsYWNlaG9sZGVyPXt0KCdWYWx1ZScpfSBvbkNoYW5nZT17b25UaHJlc2hvbGRDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvU3R5bGVkSW5wdXRDb250YWluZXI+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+KX1cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbHVtbiBzY2hlZHVsZVwiPlxuICAgICAgICAgICAgPFN0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgPGg0PlxuICAgICAgICAgICAgICAgIHtpc1JlcG9ydFxuICAgICAgICAgICAgPyB0KCdSZXBvcnQgc2NoZWR1bGUnKVxuICAgICAgICAgICAgOiB0KCdBbGVydCBjb25kaXRpb24gc2NoZWR1bGUnKX1cbiAgICAgICAgICAgICAgPC9oND5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgPC9TdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICA8QWxlcnRSZXBvcnRDcm9uU2NoZWR1bGVyIHZhbHVlPXtjdXJyZW50QWxlcnQ/LmNyb250YWIgfHwgREVGQVVMVF9DUk9OX1ZBTFVFfSBvbkNoYW5nZT17bmV3VmFsID0+IHVwZGF0ZUFsZXJ0U3RhdGUoJ2Nyb250YWInLCBuZXdWYWwpfS8+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj57dCgnVGltZXpvbmUnKX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtY29udGFpbmVyXCIgY3NzPXsodGhlbWUpID0+IHRpbWV6b25lSGVhZGVyU3R5bGUodGhlbWUpfT5cbiAgICAgICAgICAgICAgPFRpbWV6b25lU2VsZWN0b3Igb25UaW1lem9uZUNoYW5nZT17b25UaW1lem9uZUNoYW5nZX0gdGltZXpvbmU9e2N1cnJlbnRBbGVydD8udGltZXpvbmV9Lz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPFN0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgPGg0Pnt0KCdTY2hlZHVsZSBzZXR0aW5ncycpfTwvaDQ+XG4gICAgICAgICAgICA8L1N0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgIDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250cm9sLWxhYmVsXCI+XG4gICAgICAgICAgICAgICAge3QoJ0xvZyByZXRlbnRpb24nKX1cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgIDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdMb2cgcmV0ZW50aW9uJyl9IHBsYWNlaG9sZGVyPXt0KCdMb2cgcmV0ZW50aW9uJyl9IG9uQ2hhbmdlPXtvbkxvZ1JldGVudGlvbkNoYW5nZX0gdmFsdWU9e2N1cnJlbnRBbGVydD8ubG9nX3JldGVudGlvbiB8fCBERUZBVUxUX1JFVEVOVElPTn0gb3B0aW9ucz17UkVURU5USU9OX09QVElPTlN9Lz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgPFN0eWxlZElucHV0Q29udGFpbmVyPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj5cbiAgICAgICAgICAgICAgICB7dCgnV29ya2luZyB0aW1lb3V0Jyl9XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVxdWlyZWRcIj4qPC9zcGFuPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG1pbj1cIjFcIiBuYW1lPVwid29ya2luZ190aW1lb3V0XCIgdmFsdWU9e2N1cnJlbnRBbGVydD8ud29ya2luZ190aW1lb3V0IHx8ICcnfSBwbGFjZWhvbGRlcj17dCgnVGltZSBpbiBzZWNvbmRzJyl9IG9uQ2hhbmdlPXtvblRpbWVvdXRWZXJpZnlDaGFuZ2V9Lz5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJpbnB1dC1sYWJlbFwiPnNlY29uZHM8L3NwYW4+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9TdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgIHshaXNSZXBvcnQgJiYgKDxTdHlsZWRJbnB1dENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2wtbGFiZWxcIj57dCgnR3JhY2UgcGVyaW9kJyl9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgbWluPVwiMVwiIG5hbWU9XCJncmFjZV9wZXJpb2RcIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py5ncmFjZV9wZXJpb2QgfHwgJyd9IHBsYWNlaG9sZGVyPXt0KCdUaW1lIGluIHNlY29uZHMnKX0gb25DaGFuZ2U9e29uVGltZW91dFZlcmlmeUNoYW5nZX0vPlxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaW5wdXQtbGFiZWxcIj5zZWNvbmRzPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L1N0eWxlZElucHV0Q29udGFpbmVyPil9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2x1bW4gbWVzc2FnZVwiPlxuICAgICAgICAgICAgPFN0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgICAgPGg0Pnt0KCdNZXNzYWdlIGNvbnRlbnQnKX08L2g0PlxuICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPio8L3NwYW4+XG4gICAgICAgICAgICA8L1N0eWxlZFNlY3Rpb25UaXRsZT5cbiAgICAgICAgICAgIDxSYWRpby5Hcm91cCBvbkNoYW5nZT17b25Db250ZW50VHlwZUNoYW5nZX0gdmFsdWU9e2NvbnRlbnRUeXBlfT5cbiAgICAgICAgICAgICAgPFN0eWxlZFJhZGlvIHZhbHVlPVwiZGFzaGJvYXJkXCI+e3QoJ0Rhc2hib2FyZCcpfTwvU3R5bGVkUmFkaW8+XG4gICAgICAgICAgICAgIDxTdHlsZWRSYWRpbyB2YWx1ZT1cImNoYXJ0XCI+e3QoJ0NoYXJ0Jyl9PC9TdHlsZWRSYWRpbz5cbiAgICAgICAgICAgIDwvUmFkaW8uR3JvdXA+XG4gICAgICAgICAgICA8U2VsZWN0IGFyaWFMYWJlbD17dCgnQ2hhcnQnKX0gY3NzPXt7XG4gICAgICAgICAgICBkaXNwbGF5OiBjb250ZW50VHlwZSA9PT0gJ2NoYXJ0JyA/ICdpbmxpbmUnIDogJ25vbmUnLFxuICAgICAgICB9fSBuYW1lPVwiY2hhcnRcIiB2YWx1ZT17Y3VycmVudEFsZXJ0Py5jaGFydD8ubGFiZWwgJiYgY3VycmVudEFsZXJ0Py5jaGFydD8udmFsdWVcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBjdXJyZW50QWxlcnQuY2hhcnQudmFsdWUsXG4gICAgICAgICAgICAgICAgbGFiZWw6IGN1cnJlbnRBbGVydC5jaGFydC5sYWJlbCxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDogdW5kZWZpbmVkfSBvcHRpb25zPXtsb2FkQ2hhcnRPcHRpb25zfSBvbkNoYW5nZT17b25DaGFydENoYW5nZX0vPlxuICAgICAgICAgICAgPFNlbGVjdCBhcmlhTGFiZWw9e3QoJ0Rhc2hib2FyZCcpfSBjc3M9e3tcbiAgICAgICAgICAgIGRpc3BsYXk6IGNvbnRlbnRUeXBlID09PSAnZGFzaGJvYXJkJyA/ICdpbmxpbmUnIDogJ25vbmUnLFxuICAgICAgICB9fSBuYW1lPVwiZGFzaGJvYXJkXCIgdmFsdWU9e2N1cnJlbnRBbGVydD8uZGFzaGJvYXJkPy5sYWJlbCAmJiBjdXJyZW50QWxlcnQ/LmRhc2hib2FyZD8udmFsdWVcbiAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBjdXJyZW50QWxlcnQuZGFzaGJvYXJkLnZhbHVlLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBjdXJyZW50QWxlcnQuZGFzaGJvYXJkLmxhYmVsLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiB1bmRlZmluZWR9IG9wdGlvbnM9e2xvYWREYXNoYm9hcmRPcHRpb25zfSBvbkNoYW5nZT17b25EYXNoYm9hcmRDaGFuZ2V9Lz5cbiAgICAgICAgICAgIHtmb3JtYXRPcHRpb25FbmFibGVkICYmICg8ZGl2IGNsYXNzTmFtZT1cImlubGluZS1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICA8U3R5bGVkUmFkaW9Hcm91cCBvbkNoYW5nZT17b25Gb3JtYXRDaGFuZ2V9IHZhbHVlPXtyZXBvcnRGb3JtYXR9PlxuICAgICAgICAgICAgICAgICAgPFN0eWxlZFJhZGlvIHZhbHVlPVwiUE5HXCI+e3QoJ1NlbmQgYXMgUE5HJyl9PC9TdHlsZWRSYWRpbz5cbiAgICAgICAgICAgICAgICAgIDxTdHlsZWRSYWRpbyB2YWx1ZT1cIkNTVlwiPnt0KCdTZW5kIGFzIENTVicpfTwvU3R5bGVkUmFkaW8+XG4gICAgICAgICAgICAgICAgICB7VEVYVF9CQVNFRF9WSVNVQUxJWkFUSU9OX1RZUEVTLmluY2x1ZGVzKGNoYXJ0Vml6VHlwZSkgJiYgKDxTdHlsZWRSYWRpbyB2YWx1ZT1cIlRFWFRcIj57dCgnU2VuZCBhcyB0ZXh0Jyl9PC9TdHlsZWRSYWRpbz4pfVxuICAgICAgICAgICAgICAgIDwvU3R5bGVkUmFkaW9Hcm91cD5cbiAgICAgICAgICAgICAgPC9kaXY+KX1cbiAgICAgICAgICAgIDxTdHlsZWRTZWN0aW9uVGl0bGU+XG4gICAgICAgICAgICAgIDxoND57dCgnTm90aWZpY2F0aW9uIG1ldGhvZCcpfTwvaDQ+XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlcXVpcmVkXCI+Kjwvc3Bhbj5cbiAgICAgICAgICAgIDwvU3R5bGVkU2VjdGlvblRpdGxlPlxuICAgICAgICAgICAge25vdGlmaWNhdGlvblNldHRpbmdzLm1hcCgobm90aWZpY2F0aW9uU2V0dGluZywgaSkgPT4gKDxOb3RpZmljYXRpb25NZXRob2Qgc2V0dGluZz17bm90aWZpY2F0aW9uU2V0dGluZ30gaW5kZXg9e2l9IGtleT17YE5vdGlmaWNhdGlvbk1ldGhvZC0ke2l9YH0gb25VcGRhdGU9e3VwZGF0ZU5vdGlmaWNhdGlvblNldHRpbmd9IG9uUmVtb3ZlPXtyZW1vdmVOb3RpZmljYXRpb25TZXR0aW5nfS8+KSl9XG4gICAgICAgICAgICA8Tm90aWZpY2F0aW9uTWV0aG9kQWRkIGRhdGEtdGVzdD1cIm5vdGlmaWNhdGlvbi1hZGRcIiBzdGF0dXM9e25vdGlmaWNhdGlvbkFkZFN0YXRlfSBvbkNsaWNrPXtvbk5vdGlmaWNhdGlvbkFkZH0vPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvU3R5bGVkU2VjdGlvbkNvbnRhaW5lcj5cbiAgICA8L1N0eWxlZE1vZGFsPik7XG59O1xuZXhwb3J0IGRlZmF1bHQgd2l0aFRvYXN0cyhBbGVydFJlcG9ydE1vZGFsKTtcbiJdfQ== */\"),\n    name: \"dashboard\", value: currentAlert != null && (_currentAlert$dashboa2 = currentAlert.dashboard) != null && _currentAlert$dashboa2.label && currentAlert != null && (_currentAlert$dashboa3 = currentAlert.dashboard) != null && _currentAlert$dashboa3.value ?\n    {\n      value: currentAlert.dashboard.value,\n      label: currentAlert.dashboard.label } :\n\n    undefined, options: loadDashboardOptions, onChange: onDashboardChange }),\n  formatOptionEnabled && ___EmotionJSX(\"div\", { className: \"inline-container\" },\n  ___EmotionJSX(StyledRadioGroup, { onChange: onFormatChange, value: reportFormat },\n  ___EmotionJSX(StyledRadio, { value: \"PNG\" }, t('Send as PNG')),\n  ___EmotionJSX(StyledRadio, { value: \"CSV\" }, t('Send as CSV')),\n  TEXT_BASED_VISUALIZATION_TYPES.includes(chartVizType) && ___EmotionJSX(StyledRadio, { value: \"TEXT\" }, t('Send as text')))),\n\n\n  ___EmotionJSX(StyledSectionTitle, null,\n  ___EmotionJSX(\"h4\", null, t('Notification method')),\n  ___EmotionJSX(\"span\", { className: \"required\" }, \"*\")),\n\n  notificationSettings.map((notificationSetting, i) => ___EmotionJSX(NotificationMethod, { setting: notificationSetting, index: i, key: `NotificationMethod-${i}`, onUpdate: updateNotificationSetting, onRemove: removeNotificationSetting })),\n  ___EmotionJSX(NotificationMethodAdd, { status: notificationAddState, onClick: onNotificationAdd })))));\n\n\n\n\n};\nexport default withToasts(AlertReportModal);","map":null,"metadata":{},"sourceType":"module"}