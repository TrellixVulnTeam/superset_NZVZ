{"ast":null,"code":"import _extends from \"@babel/runtime-corejs3/helpers/extends\";var _jsxFileName = \"/home/ubuntu/my_plugin/superset/superset-frontend/src/components/ErrorMessage/ParameterErrorMessage.tsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t, tn } from '@superset-ui/core';\nimport levenshtein from 'js-levenshtein';\nimport IssueCode from './IssueCode';\nimport ErrorAlert from './ErrorAlert';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst maxDistanceForSuggestion = 2;\nconst findMatches = (undefinedParameters, templateKeys) => {\n  const matches = {};\n  undefinedParameters.forEach((undefinedParameter) => {\n    templateKeys.forEach((templateKey) => {\n      if (levenshtein(undefinedParameter, templateKey) <= maxDistanceForSuggestion) {\n        if (!matches[undefinedParameter]) {\n          matches[undefinedParameter] = [];\n        }\n        matches[undefinedParameter].push(`\"${templateKey}\"`);\n      }\n    });\n  });\n  return matches;\n};\nfunction ParameterErrorMessage({ error, source = 'sqllab', subtitle }) {\n  const { extra = { issue_codes: [] }, level, message } = error;\n  const triggerMessage = tn('This was triggered by:', 'This may be triggered by:', extra.issue_codes.length);\n  const matches = findMatches(extra.undefined_parameters || [], Object.keys(extra.template_parameters || {}));\n  const body = ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(\"p\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 44, columnNumber: 7 } },\n  Object.keys(matches).length > 0 && ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(\"p\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 46, columnNumber: 13 } }, t('Did you mean:')),\n  ___EmotionJSX(\"ul\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 47, columnNumber: 13 } },\n  Object.entries(matches).map(([undefinedParameter, templateKeys]) => ___EmotionJSX(\"li\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 48, columnNumber: 85 } },\n  tn('%(suggestion)s instead of \"%(undefinedParameter)s?\"', '%(firstSuggestions)s or %(lastSuggestion)s instead of \"%(undefinedParameter)s\"?', templateKeys.length, {\n    suggestion: templateKeys.join(', '),\n    firstSuggestions: templateKeys.slice(0, -1).join(', '),\n    lastSuggestion: templateKeys[templateKeys.length - 1],\n    undefinedParameter })))),\n\n\n\n  ___EmotionJSX(\"br\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 57, columnNumber: 13 } })),\n\n  triggerMessage,\n  ___EmotionJSX(\"br\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 60, columnNumber: 9 } }),\n  extra.issue_codes.length > 0 &&\n  extra.issue_codes.\n  map((issueCode) => ___EmotionJSX(IssueCode, _extends({}, issueCode, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 63, columnNumber: 35 } }))).\n  reduce((prev, curr) => [prev, ___EmotionJSX(\"br\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 64, columnNumber: 48 } }), curr])));\n\n\n  const copyText = `${message}\n${triggerMessage}\n${extra.issue_codes.map((issueCode) => issueCode.message).join('\\n')}`;\n  return ___EmotionJSX(ErrorAlert, { title: t('Parameter error'), subtitle: subtitle, level: level, source: source, copyText: copyText, body: body, __self: this, __source: { fileName: _jsxFileName, lineNumber: 70, columnNumber: 13 } });\n}const _default =\nParameterErrorMessage;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(maxDistanceForSuggestion, \"maxDistanceForSuggestion\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/components/ErrorMessage/ParameterErrorMessage.tsx\");reactHotLoader.register(findMatches, \"findMatches\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/components/ErrorMessage/ParameterErrorMessage.tsx\");reactHotLoader.register(ParameterErrorMessage, \"ParameterErrorMessage\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/components/ErrorMessage/ParameterErrorMessage.tsx\");reactHotLoader.register(_default, \"default\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/components/ErrorMessage/ParameterErrorMessage.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/ubuntu/my_plugin/superset/superset-frontend/src/components/ErrorMessage/ParameterErrorMessage.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t, tn } from '@superset-ui/core';\nimport levenshtein from 'js-levenshtein';\n\nimport { ErrorMessageComponentProps } from './types';\nimport IssueCode from './IssueCode';\nimport ErrorAlert from './ErrorAlert';\n\ninterface ParameterErrorExtra {\n  undefined_parameters?: string[];\n  template_parameters?: object;\n  issue_codes: {\n    code: number;\n    message: string;\n  }[];\n}\n\nconst maxDistanceForSuggestion = 2;\nconst findMatches = (undefinedParameters: string[], templateKeys: string[]) => {\n  const matches: { [undefinedParameter: string]: string[] } = {};\n  undefinedParameters.forEach(undefinedParameter => {\n    templateKeys.forEach(templateKey => {\n      if (\n        levenshtein(undefinedParameter, templateKey) <= maxDistanceForSuggestion\n      ) {\n        if (!matches[undefinedParameter]) {\n          matches[undefinedParameter] = [];\n        }\n        matches[undefinedParameter].push(`\"${templateKey}\"`);\n      }\n    });\n  });\n  return matches;\n};\n\nfunction ParameterErrorMessage({\n  error,\n  source = 'sqllab',\n  subtitle,\n}: ErrorMessageComponentProps<ParameterErrorExtra>) {\n  const { extra = { issue_codes: [] }, level, message } = error;\n\n  const triggerMessage = tn(\n    'This was triggered by:',\n    'This may be triggered by:',\n    extra.issue_codes.length,\n  );\n\n  const matches = findMatches(\n    extra.undefined_parameters || [],\n    Object.keys(extra.template_parameters || {}),\n  );\n\n  const body = (\n    <>\n      <p>\n        {Object.keys(matches).length > 0 && (\n          <>\n            <p>{t('Did you mean:')}</p>\n            <ul>\n              {Object.entries(matches).map(\n                ([undefinedParameter, templateKeys]) => (\n                  <li>\n                    {tn(\n                      '%(suggestion)s instead of \"%(undefinedParameter)s?\"',\n                      '%(firstSuggestions)s or %(lastSuggestion)s instead of \"%(undefinedParameter)s\"?',\n                      templateKeys.length,\n                      {\n                        suggestion: templateKeys.join(', '),\n                        firstSuggestions: templateKeys.slice(0, -1).join(', '),\n                        lastSuggestion: templateKeys[templateKeys.length - 1],\n                        undefinedParameter,\n                      },\n                    )}\n                  </li>\n                ),\n              )}\n            </ul>\n            <br />\n          </>\n        )}\n        {triggerMessage}\n        <br />\n        {extra.issue_codes.length > 0 &&\n          extra.issue_codes\n            .map<React.ReactNode>(issueCode => <IssueCode {...issueCode} />)\n            .reduce((prev, curr) => [prev, <br />, curr])}\n      </p>\n    </>\n  );\n\n  const copyText = `${message}\n${triggerMessage}\n${extra.issue_codes.map(issueCode => issueCode.message).join('\\n')}`;\n\n  return (\n    <ErrorAlert\n      title={t('Parameter error')}\n      subtitle={subtitle}\n      level={level}\n      source={source}\n      copyText={copyText}\n      body={body}\n    />\n  );\n}\n\nexport default ParameterErrorMessage;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}