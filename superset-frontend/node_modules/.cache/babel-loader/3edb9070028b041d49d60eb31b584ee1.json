{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport componentIsResizable from './componentIsResizable';\nimport shouldWrapChildInRow from './shouldWrapChildInRow';\nimport newComponentFactory from './newComponentFactory';\nimport getComponentWidthFromDrop from './getComponentWidthFromDrop';\n\nimport { ROW_TYPE, TABS_TYPE, TAB_TYPE } from './componentTypes';\n\nexport default function newEntitiesFromDrop({ dropResult, layout }) {\n  const { dragging, destination } = dropResult;\n\n  const dragType = dragging.type;\n  const dropEntity = layout[destination.id];\n  const dropType = dropEntity.type;\n  let newDropChild = newComponentFactory(dragType, dragging.meta);\n  newDropChild.parents = (dropEntity.parents || []).concat(dropEntity.id);\n\n  if (componentIsResizable(dragging)) {\n    newDropChild.meta.width = // don't set a 0 width\n    getComponentWidthFromDrop({ dropResult, layout }) || undefined;\n  }\n\n  const wrapChildInRow = shouldWrapChildInRow({\n    parentType: dropType,\n    childType: dragType });\n\n\n  const newEntities = {\n    [newDropChild.id]: newDropChild };\n\n\n  if (wrapChildInRow) {\n    const rowWrapper = newComponentFactory(ROW_TYPE);\n    rowWrapper.children = [newDropChild.id];\n    rowWrapper.parents = (dropEntity.parents || []).concat(dropEntity.id);\n    newEntities[rowWrapper.id] = rowWrapper;\n    newDropChild.parents = rowWrapper.parents.concat(rowWrapper.id);\n    newDropChild = rowWrapper;\n  } else if (dragType === TABS_TYPE) {\n    // create a new tab component\n    const tabChild = newComponentFactory(TAB_TYPE);\n    tabChild.parents = (dropEntity.parents || []).concat(dropEntity.id);\n    newDropChild.children = [tabChild.id];\n    newEntities[tabChild.id] = tabChild;\n  }\n\n  const nextDropChildren = [...dropEntity.children];\n  nextDropChildren.splice(destination.index, 0, newDropChild.id);\n\n  newEntities[destination.id] = {\n    ...dropEntity,\n    children: nextDropChildren };\n\n\n  return newEntities;\n};(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(newEntitiesFromDrop, \"newEntitiesFromDrop\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/util/newEntitiesFromDrop.js\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/util/newEntitiesFromDrop.js"],"names":["componentIsResizable","shouldWrapChildInRow","newComponentFactory","getComponentWidthFromDrop","ROW_TYPE","TABS_TYPE","TAB_TYPE","newEntitiesFromDrop","dropResult","layout","dragging","destination","dragType","type","dropEntity","id","dropType","newDropChild","meta","parents","concat","width","undefined","wrapChildInRow","parentType","childType","newEntities","rowWrapper","children","tabChild","nextDropChildren","splice","index"],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport componentIsResizable from './componentIsResizable';\nimport shouldWrapChildInRow from './shouldWrapChildInRow';\nimport newComponentFactory from './newComponentFactory';\nimport getComponentWidthFromDrop from './getComponentWidthFromDrop';\n\nimport { ROW_TYPE, TABS_TYPE, TAB_TYPE } from './componentTypes';\n\nexport default function newEntitiesFromDrop({ dropResult, layout }) {\n  const { dragging, destination } = dropResult;\n\n  const dragType = dragging.type;\n  const dropEntity = layout[destination.id];\n  const dropType = dropEntity.type;\n  let newDropChild = newComponentFactory(dragType, dragging.meta);\n  newDropChild.parents = (dropEntity.parents || []).concat(dropEntity.id);\n\n  if (componentIsResizable(dragging)) {\n    newDropChild.meta.width = // don't set a 0 width\n      getComponentWidthFromDrop({ dropResult, layout }) || undefined;\n  }\n\n  const wrapChildInRow = shouldWrapChildInRow({\n    parentType: dropType,\n    childType: dragType,\n  });\n\n  const newEntities = {\n    [newDropChild.id]: newDropChild,\n  };\n\n  if (wrapChildInRow) {\n    const rowWrapper = newComponentFactory(ROW_TYPE);\n    rowWrapper.children = [newDropChild.id];\n    rowWrapper.parents = (dropEntity.parents || []).concat(dropEntity.id);\n    newEntities[rowWrapper.id] = rowWrapper;\n    newDropChild.parents = rowWrapper.parents.concat(rowWrapper.id);\n    newDropChild = rowWrapper;\n  } else if (dragType === TABS_TYPE) {\n    // create a new tab component\n    const tabChild = newComponentFactory(TAB_TYPE);\n    tabChild.parents = (dropEntity.parents || []).concat(dropEntity.id);\n    newDropChild.children = [tabChild.id];\n    newEntities[tabChild.id] = tabChild;\n  }\n\n  const nextDropChildren = [...dropEntity.children];\n  nextDropChildren.splice(destination.index, 0, newDropChild.id);\n\n  newEntities[destination.id] = {\n    ...dropEntity,\n    children: nextDropChildren,\n  };\n\n  return newEntities;\n}\n"]},"metadata":{},"sourceType":"module"}