{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { styled, t, css } from '@superset-ui/core';\nimport Popover from 'src/components/Popover';\nimport Icons from 'src/components/Icons';\nimport { Pill } from 'src/dashboard/components/FiltersBadge/Styles';\nimport FilterControl from 'src/dashboard/components/nativeFilters/FilterBar/FilterControls/FilterControl';\nimport CascadeFilterControl from 'src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadeFilterControl';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst StyledTitleBox = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  background-color: ${({ theme }) => theme.colors.grayscale.light4};\n  margin: ${({ theme }) => theme.gridUnit * -1}px\n    ${({ theme }) => theme.gridUnit * -4}px; // to override default antd padding\n  padding: ${({ theme }) => theme.gridUnit * 2}px\n    ${({ theme }) => theme.gridUnit * 4}px;\n\n  & > *:last-child {\n    cursor: pointer;\n  }\n`;\nconst StyledTitle = styled.h4`\n  display: flex;\n  align-items: center;\n  color: ${({ theme }) => theme.colors.grayscale.dark1};\n  margin: 0;\n  padding: 0;\n`;\nconst IconStyles = (theme) => css`\n  margin-right: ${theme.gridUnit}px;\n  color: ${theme.colors.grayscale.dark1};\n  width: ${theme.gridUnit * 4}px;\n`;\nconst StyledPill = styled(Pill)`\n  padding: ${({ theme }) => theme.gridUnit}px\n    ${({ theme }) => theme.gridUnit * 2}px;\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  background: ${({ theme }) => theme.colors.grayscale.light1};\n`;\nconst ContentWrapper = styled.div`\n  max-height: 700px;\n  overflow-y: auto;\n`;\nconst CascadePopover = ({ dataMaskSelected, filter, visible, onVisibleChange, onFilterSelectionChange, directPathToChild, inView }) => {var _filter$cascadeChildr;\n  const [currentPathToChild, setCurrentPathToChild] = useState();\n  const dataMask = dataMaskSelected[filter.id];\n  useEffect(() => {\n    setCurrentPathToChild(directPathToChild);\n    // clear local copy of directPathToChild after 500ms\n    // to prevent triggering multiple focus\n    const timeout = setTimeout(() => setCurrentPathToChild(undefined), 500);\n    return () => clearTimeout(timeout);\n  }, [directPathToChild, setCurrentPathToChild]);\n  const getActiveChildren = useCallback((filter) => {var _dataMask$filterState;\n    const children = filter.cascadeChildren || [];\n    const currentValue = dataMask == null ? void 0 : (_dataMask$filterState = dataMask.filterState) == null ? void 0 : _dataMask$filterState.value;\n    const activeChildren = children.flatMap((childFilter) => getActiveChildren(childFilter) || []);\n    if (activeChildren.length > 0) {\n      return activeChildren;\n    }\n    if (currentValue !== undefined && currentValue !== null) {\n      return [filter];\n    }\n    return null;\n  }, [dataMask]);\n  const getAllFilters = (filter) => {\n    const children = filter.cascadeChildren || [];\n    const allChildren = children.flatMap(getAllFilters);\n    return [filter, ...allChildren];\n  };\n  const allFilters = getAllFilters(filter);\n  const activeFilters = useMemo(() => getActiveChildren(filter) || [filter], [\n  filter,\n  getActiveChildren]);\n\n  useEffect(() => {\n    const focusedFilterId = currentPathToChild == null ? void 0 : currentPathToChild[0];\n    // filters not directly displayed in the Filter Bar\n    const inactiveFilters = allFilters.filter((filterEl) => !activeFilters.includes(filterEl));\n    const focusedInactiveFilter = inactiveFilters.some((cascadeChild) => cascadeChild.id === focusedFilterId);\n    if (focusedInactiveFilter) {\n      onVisibleChange(true);\n    }\n  }, [currentPathToChild]);\n  if (!((_filter$cascadeChildr = filter.cascadeChildren) != null && _filter$cascadeChildr.length)) {\n    return ___EmotionJSX(FilterControl, { dataMaskSelected: dataMaskSelected, filter: filter, directPathToChild: directPathToChild, onFilterSelectionChange: onFilterSelectionChange, inView: inView, __self: this, __source: { fileName: _jsxFileName, lineNumber: 105, columnNumber: 17 } });\n  }\n  const title = ___EmotionJSX(StyledTitleBox, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 107, columnNumber: 20 } },\n  ___EmotionJSX(StyledTitle, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 108, columnNumber: 7 } },\n  ___EmotionJSX(Icons.Edit, { iconSize: \"l\", css: (theme) => IconStyles(theme), __self: this, __source: { fileName: _jsxFileName, lineNumber: 109, columnNumber: 9 } }),\n  t('Select parent filters'), \" (\", allFilters.length, \")\"),\n\n  ___EmotionJSX(Icons.Close, { iconSize: \"l\", css: (theme) => IconStyles(theme), onClick: () => onVisibleChange(false), __self: this, __source: { fileName: _jsxFileName, lineNumber: 112, columnNumber: 7 } }));\n\n  const content = ___EmotionJSX(ContentWrapper, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 114, columnNumber: 22 } },\n  ___EmotionJSX(CascadeFilterControl, { dataMaskSelected: dataMaskSelected, \"data-test\": \"cascade-filters-control\", key: filter.id, filter: filter, directPathToChild: visible ? currentPathToChild : undefined, onFilterSelectionChange: onFilterSelectionChange, __self: this, __source: { fileName: _jsxFileName, lineNumber: 115, columnNumber: 7 } }));\n\n  return ___EmotionJSX(Popover, { content: content, title: title, trigger: \"click\", visible: visible, onVisibleChange: onVisibleChange, placement: \"rightTop\", id: filter.id, overlayStyle: { width: '400px' }, __self: this, __source: { fileName: _jsxFileName, lineNumber: 117, columnNumber: 13 } },\n  ___EmotionJSX(\"div\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 118, columnNumber: 7 } },\n  activeFilters.map((activeFilter) => ___EmotionJSX(FilterControl, { dataMaskSelected: dataMaskSelected, key: activeFilter.id, filter: activeFilter, onFilterSelectionChange: onFilterSelectionChange, directPathToChild: currentPathToChild, inView: inView, icon: ___EmotionJSX(React.Fragment, null,\n    filter.cascadeChildren.length !== 0 && ___EmotionJSX(StyledPill, { onClick: () => onVisibleChange(true), __self: this, __source: { fileName: _jsxFileName, lineNumber: 120, columnNumber: 58 } },\n    ___EmotionJSX(Icons.Filter, { iconSize: \"m\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 121, columnNumber: 21 } }), \" \", allFilters.length)), __self: this, __source: { fileName: _jsxFileName, lineNumber: 119, columnNumber: 45 } }))));\n\n\n\n\n};__signature__(CascadePopover, \"useState{[currentPathToChild, setCurrentPathToChild]}\\nuseEffect{}\\nuseCallback{getActiveChildren}\\nuseMemo{activeFilters}\\nuseEffect{}\");const _default =\nCascadePopover;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(StyledTitleBox, \"StyledTitleBox\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx\");reactHotLoader.register(StyledTitle, \"StyledTitle\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx\");reactHotLoader.register(IconStyles, \"IconStyles\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx\");reactHotLoader.register(StyledPill, \"StyledPill\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx\");reactHotLoader.register(ContentWrapper, \"ContentWrapper\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx\");reactHotLoader.register(CascadePopover, \"CascadePopover\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx\");reactHotLoader.register(_default, \"default\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/ubuntu/my_plugin/superset/superset-frontend/src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadePopover/index.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { styled, t, DataMask, css, SupersetTheme } from '@superset-ui/core';\nimport Popover from 'src/components/Popover';\nimport Icons from 'src/components/Icons';\nimport { Pill } from 'src/dashboard/components/FiltersBadge/Styles';\nimport { DataMaskStateWithId } from 'src/dataMask/types';\nimport FilterControl from 'src/dashboard/components/nativeFilters/FilterBar/FilterControls/FilterControl';\nimport CascadeFilterControl from 'src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/CascadeFilterControl';\nimport { CascadeFilter } from 'src/dashboard/components/nativeFilters/FilterBar/CascadeFilters/types';\nimport { Filter } from 'src/dashboard/components/nativeFilters/types';\n\ninterface CascadePopoverProps {\n  dataMaskSelected: DataMaskStateWithId;\n  filter: CascadeFilter;\n  visible: boolean;\n  directPathToChild?: string[];\n  inView?: boolean;\n  onVisibleChange: (visible: boolean) => void;\n  onFilterSelectionChange: (filter: Filter, dataMask: DataMask) => void;\n}\n\nconst StyledTitleBox = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  background-color: ${({ theme }) => theme.colors.grayscale.light4};\n  margin: ${({ theme }) => theme.gridUnit * -1}px\n    ${({ theme }) => theme.gridUnit * -4}px; // to override default antd padding\n  padding: ${({ theme }) => theme.gridUnit * 2}px\n    ${({ theme }) => theme.gridUnit * 4}px;\n\n  & > *:last-child {\n    cursor: pointer;\n  }\n`;\n\nconst StyledTitle = styled.h4`\n  display: flex;\n  align-items: center;\n  color: ${({ theme }) => theme.colors.grayscale.dark1};\n  margin: 0;\n  padding: 0;\n`;\n\nconst IconStyles = (theme: SupersetTheme) => css`\n  margin-right: ${theme.gridUnit}px;\n  color: ${theme.colors.grayscale.dark1};\n  width: ${theme.gridUnit * 4}px;\n`;\n\nconst StyledPill = styled(Pill)`\n  padding: ${({ theme }) => theme.gridUnit}px\n    ${({ theme }) => theme.gridUnit * 2}px;\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  background: ${({ theme }) => theme.colors.grayscale.light1};\n`;\n\nconst ContentWrapper = styled.div`\n  max-height: 700px;\n  overflow-y: auto;\n`;\n\nconst CascadePopover: React.FC<CascadePopoverProps> = ({\n  dataMaskSelected,\n  filter,\n  visible,\n  onVisibleChange,\n  onFilterSelectionChange,\n  directPathToChild,\n  inView,\n}) => {\n  const [currentPathToChild, setCurrentPathToChild] = useState<string[]>();\n  const dataMask = dataMaskSelected[filter.id];\n\n  useEffect(() => {\n    setCurrentPathToChild(directPathToChild);\n    // clear local copy of directPathToChild after 500ms\n    // to prevent triggering multiple focus\n    const timeout = setTimeout(() => setCurrentPathToChild(undefined), 500);\n    return () => clearTimeout(timeout);\n  }, [directPathToChild, setCurrentPathToChild]);\n\n  const getActiveChildren = useCallback(\n    (filter: CascadeFilter): CascadeFilter[] | null => {\n      const children = filter.cascadeChildren || [];\n      const currentValue = dataMask?.filterState?.value;\n\n      const activeChildren = children.flatMap(\n        childFilter => getActiveChildren(childFilter) || [],\n      );\n\n      if (activeChildren.length > 0) {\n        return activeChildren;\n      }\n\n      if (currentValue !== undefined && currentValue !== null) {\n        return [filter];\n      }\n\n      return null;\n    },\n    [dataMask],\n  );\n\n  const getAllFilters = (filter: CascadeFilter): CascadeFilter[] => {\n    const children = filter.cascadeChildren || [];\n    const allChildren = children.flatMap(getAllFilters);\n    return [filter, ...allChildren];\n  };\n\n  const allFilters = getAllFilters(filter);\n  const activeFilters = useMemo(() => getActiveChildren(filter) || [filter], [\n    filter,\n    getActiveChildren,\n  ]);\n\n  useEffect(() => {\n    const focusedFilterId = currentPathToChild?.[0];\n    // filters not directly displayed in the Filter Bar\n    const inactiveFilters = allFilters.filter(\n      filterEl => !activeFilters.includes(filterEl),\n    );\n    const focusedInactiveFilter = inactiveFilters.some(\n      cascadeChild => cascadeChild.id === focusedFilterId,\n    );\n\n    if (focusedInactiveFilter) {\n      onVisibleChange(true);\n    }\n  }, [currentPathToChild]);\n\n  if (!filter.cascadeChildren?.length) {\n    return (\n      <FilterControl\n        dataMaskSelected={dataMaskSelected}\n        filter={filter}\n        directPathToChild={directPathToChild}\n        onFilterSelectionChange={onFilterSelectionChange}\n        inView={inView}\n      />\n    );\n  }\n\n  const title = (\n    <StyledTitleBox>\n      <StyledTitle>\n        <Icons.Edit\n          iconSize=\"l\"\n          css={(theme: SupersetTheme) => IconStyles(theme)}\n        />\n        {t('Select parent filters')} ({allFilters.length})\n      </StyledTitle>\n      <Icons.Close\n        iconSize=\"l\"\n        css={(theme: SupersetTheme) => IconStyles(theme)}\n        onClick={() => onVisibleChange(false)}\n      />\n    </StyledTitleBox>\n  );\n\n  const content = (\n    <ContentWrapper>\n      <CascadeFilterControl\n        dataMaskSelected={dataMaskSelected}\n        data-test=\"cascade-filters-control\"\n        key={filter.id}\n        filter={filter}\n        directPathToChild={visible ? currentPathToChild : undefined}\n        onFilterSelectionChange={onFilterSelectionChange}\n      />\n    </ContentWrapper>\n  );\n\n  return (\n    <Popover\n      content={content}\n      title={title}\n      trigger=\"click\"\n      visible={visible}\n      onVisibleChange={onVisibleChange}\n      placement=\"rightTop\"\n      id={filter.id}\n      overlayStyle={{ width: '400px' }}\n    >\n      <div>\n        {activeFilters.map(activeFilter => (\n          <FilterControl\n            dataMaskSelected={dataMaskSelected}\n            key={activeFilter.id}\n            filter={activeFilter}\n            onFilterSelectionChange={onFilterSelectionChange}\n            directPathToChild={currentPathToChild}\n            inView={inView}\n            icon={\n              <>\n                {filter.cascadeChildren.length !== 0 && (\n                  <StyledPill onClick={() => onVisibleChange(true)}>\n                    <Icons.Filter iconSize=\"m\" /> {allFilters.length}\n                  </StyledPill>\n                )}\n              </>\n            }\n          />\n        ))}\n      </div>\n    </Popover>\n  );\n};\n\nexport default CascadePopover;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}