{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/my_plugin/superset/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState } from 'react';\nimport { ensureIsArray, styled, t } from '@superset-ui/core';\nimport SyntaxHighlighter from 'react-syntax-highlighter/dist/cjs/light';\nimport github from 'react-syntax-highlighter/dist/cjs/styles/hljs/github';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport Loading from 'src/components/Loading';\nimport { CopyButton } from 'src/explore/components/DataTableControl';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { getChartDataRequest } from 'src/chart/chartAction';\nimport markdownSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/markdown';\nimport htmlSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/htmlbars';\nimport sqlSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/sql';\nimport jsonSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/json';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst CopyButtonViewQuery = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\nSyntaxHighlighter.registerLanguage('markdown', markdownSyntax);\nSyntaxHighlighter.registerLanguage('html', htmlSyntax);\nSyntaxHighlighter.registerLanguage('sql', sqlSyntax);\nSyntaxHighlighter.registerLanguage('json', jsonSyntax);\nconst StyledSyntaxContainer = styled.div`\n  height: 100%;\n`;\nconst StyledSyntaxHighlighter = styled(SyntaxHighlighter)`\n  height: calc(100% - 26px); // 100% - clipboard height\n`;\nconst ViewQueryModal = (props) => {\n  const [result, setResult] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const loadChartData = (resultType) => {\n    setIsLoading(true);\n    getChartDataRequest({\n      formData: props.latestQueryFormData,\n      resultFormat: 'json',\n      resultType }).\n\n    then(({ json }) => {\n      setResult(ensureIsArray(json.result));\n      setIsLoading(false);\n      setError(null);\n    }).\n    catch((response) => {\n      getClientErrorObject(response).then(({ error, message }) => {\n        setError(error ||\n        message ||\n        response.statusText ||\n        t('Sorry, An error occurred'));\n        setIsLoading(false);\n      });\n    });\n  };\n  useEffect(() => {\n    loadChartData('query');\n  }, [JSON.stringify(props.latestQueryFormData)]);\n  if (isLoading) {\n    return ___EmotionJSX(Loading, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 77, columnNumber: 16 } });\n  }\n  if (error) {\n    return ___EmotionJSX(\"pre\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 80, columnNumber: 16 } }, error);\n  }\n  return ___EmotionJSX(React.Fragment, null,\n  result.map((item) => item.query ? ___EmotionJSX(StyledSyntaxContainer, { key: item.query, __self: this, __source: { fileName: _jsxFileName, lineNumber: 83, columnNumber: 41 } },\n  ___EmotionJSX(CopyToClipboard, { text: item.query, shouldShowText: false, copyNode: ___EmotionJSX(CopyButtonViewQuery, { buttonSize: \"xsmall\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 84, columnNumber: 81 } },\n    ___EmotionJSX(\"i\", { className: \"fa fa-clipboard\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 85, columnNumber: 19 } })), __self: this, __source: { fileName: _jsxFileName, lineNumber: 84, columnNumber: 13 } }),\n\n  ___EmotionJSX(StyledSyntaxHighlighter, { language: item.language || undefined, style: github, __self: this, __source: { fileName: _jsxFileName, lineNumber: 87, columnNumber: 13 } },\n  item.query)) :\n\n  null));\n\n};__signature__(ViewQueryModal, \"useState{[result, setResult]([])}\\nuseState{[isLoading, setIsLoading](false)}\\nuseState{[error, setError](null)}\\nuseEffect{}\");const _default =\nViewQueryModal;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(CopyButtonViewQuery, \"CopyButtonViewQuery\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\");reactHotLoader.register(StyledSyntaxContainer, \"StyledSyntaxContainer\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\");reactHotLoader.register(StyledSyntaxHighlighter, \"StyledSyntaxHighlighter\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\");reactHotLoader.register(ViewQueryModal, \"ViewQueryModal\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\");reactHotLoader.register(_default, \"default\", \"/home/ubuntu/my_plugin/superset/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/home/ubuntu/my_plugin/superset/superset-frontend/src/explore/components/controls/ViewQueryModal.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState } from 'react';\nimport { ensureIsArray, styled, t } from '@superset-ui/core';\nimport SyntaxHighlighter from 'react-syntax-highlighter/dist/cjs/light';\nimport github from 'react-syntax-highlighter/dist/cjs/styles/hljs/github';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport Loading from 'src/components/Loading';\nimport { CopyButton } from 'src/explore/components/DataTableControl';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { getChartDataRequest } from 'src/chart/chartAction';\nimport markdownSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/markdown';\nimport htmlSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/htmlbars';\nimport sqlSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/sql';\nimport jsonSyntax from 'react-syntax-highlighter/dist/cjs/languages/hljs/json';\n\nconst CopyButtonViewQuery = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nSyntaxHighlighter.registerLanguage('markdown', markdownSyntax);\nSyntaxHighlighter.registerLanguage('html', htmlSyntax);\nSyntaxHighlighter.registerLanguage('sql', sqlSyntax);\nSyntaxHighlighter.registerLanguage('json', jsonSyntax);\n\ninterface Props {\n  latestQueryFormData: object;\n}\n\ntype Result = {\n  query: string;\n  language: string;\n};\n\nconst StyledSyntaxContainer = styled.div`\n  height: 100%;\n`;\n\nconst StyledSyntaxHighlighter = styled(SyntaxHighlighter)`\n  height: calc(100% - 26px); // 100% - clipboard height\n`;\n\nconst ViewQueryModal: React.FC<Props> = props => {\n  const [result, setResult] = useState<Result[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loadChartData = (resultType: string) => {\n    setIsLoading(true);\n    getChartDataRequest({\n      formData: props.latestQueryFormData,\n      resultFormat: 'json',\n      resultType,\n    })\n      .then(({ json }) => {\n        setResult(ensureIsArray(json.result));\n        setIsLoading(false);\n        setError(null);\n      })\n      .catch(response => {\n        getClientErrorObject(response).then(({ error, message }) => {\n          setError(\n            error ||\n              message ||\n              response.statusText ||\n              t('Sorry, An error occurred'),\n          );\n          setIsLoading(false);\n        });\n      });\n  };\n  useEffect(() => {\n    loadChartData('query');\n  }, [JSON.stringify(props.latestQueryFormData)]);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n  if (error) {\n    return <pre>{error}</pre>;\n  }\n  return (\n    <>\n      {result.map(item =>\n        item.query ? (\n          <StyledSyntaxContainer key={item.query}>\n            <CopyToClipboard\n              text={item.query}\n              shouldShowText={false}\n              copyNode={\n                <CopyButtonViewQuery buttonSize=\"xsmall\">\n                  <i className=\"fa fa-clipboard\" />\n                </CopyButtonViewQuery>\n              }\n            />\n            <StyledSyntaxHighlighter\n              language={item.language || undefined}\n              style={github}\n            >\n              {item.query}\n            </StyledSyntaxHighlighter>\n          </StyledSyntaxContainer>\n        ) : null,\n      )}\n    </>\n  );\n};\n\nexport default ViewQueryModal;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}