{"ast":null,"code":"import { css as _css } from \"@emotion/react\"; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useRef, useCallback } from 'react';\nimport moment from 'moment-timezone';\nimport { t } from '@superset-ui/core';\nimport { Select } from 'src/components';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst DEFAULT_TIMEZONE = {\n  name: 'GMT Standard Time',\n  value: 'Africa/Abidjan' // timezones are deduped by the first alphabetical value\n};\nconst MIN_SELECT_WIDTH = '400px';\nconst offsetsToName = {\n  '-300-240': ['Eastern Standard Time', 'Eastern Daylight Time'],\n  '-360-300': ['Central Standard Time', 'Central Daylight Time'],\n  '-420-360': ['Mountain Standard Time', 'Mountain Daylight Time'],\n  '-420-420': [\n  'Mountain Standard Time - Phoenix',\n  'Mountain Standard Time - Phoenix'],\n\n  '-480-420': ['Pacific Standard Time', 'Pacific Daylight Time'],\n  '-540-480': ['Alaska Standard Time', 'Alaska Daylight Time'],\n  '-600-600': ['Hawaii Standard Time', 'Hawaii Daylight Time'],\n  '60120': ['Central European Time', 'Central European Daylight Time'],\n  '00': [DEFAULT_TIMEZONE.name, DEFAULT_TIMEZONE.name],\n  '060': ['GMT Standard Time - London', 'British Summer Time'] };\n\nconst currentDate = moment();\nconst JANUARY = moment([2021, 1]);\nconst JULY = moment([2021, 7]);\nconst getOffsetKey = (name) => JANUARY.tz(name).utcOffset().toString() +\nJULY.tz(name).utcOffset().toString();\nconst getTimezoneName = (name) => {var _offsetsToName$offset, _offsetsToName$offset2;\n  const offsets = getOffsetKey(name);\n  return (currentDate.tz(name).isDST() ? (_offsetsToName$offset =\n  offsetsToName[offsets]) == null ? void 0 : _offsetsToName$offset[1] : (_offsetsToName$offset2 =\n  offsetsToName[offsets]) == null ? void 0 : _offsetsToName$offset2[0]) || name;\n};\nconst ALL_ZONES = moment.tz.\ncountries().\nmap((country) => moment.tz.zonesForCountry(country, true)).\nflat();\nconst TIMEZONES = [];\nALL_ZONES.forEach((zone) => {\n  if (!TIMEZONES.find((option) => getOffsetKey(option.name) === getOffsetKey(zone.name))) {\n    TIMEZONES.push(zone); // dedupe zones by offsets\n  }\n});\nconst TIMEZONE_OPTIONS = TIMEZONES.sort(\n// sort by offset\n(a, b) => moment.tz(currentDate, a.name).utcOffset() -\nmoment.tz(currentDate, b.name).utcOffset()).map((zone) => ({\n  label: `GMT ${moment.\n  tz(currentDate, zone.name).\n  format('Z')} (${getTimezoneName(zone.name)})`,\n  value: zone.name,\n  offsets: getOffsetKey(zone.name) }));\n\nconst TimezoneSelector = ({ onTimezoneChange, timezone }) => {\n  const prevTimezone = useRef(timezone);\n  const matchTimezoneToOptions = (timezone) => {var _TIMEZONE_OPTIONS$fin;return ((_TIMEZONE_OPTIONS$fin = TIMEZONE_OPTIONS.find((option) => option.offsets === getOffsetKey(timezone))) == null ? void 0 : _TIMEZONE_OPTIONS$fin.\n    value) || DEFAULT_TIMEZONE.value;};\n  const updateTimezone = useCallback((tz) => {\n    // update the ref to track changes\n    prevTimezone.current = tz;\n    // the parent component contains the state for the value\n    onTimezoneChange(tz);\n  }, [onTimezoneChange]);\n  useEffect(() => {\n    const updatedTz = matchTimezoneToOptions(timezone || moment.tz.guess());\n    if (prevTimezone.current !== updatedTz) {\n      updateTimezone(updatedTz);\n    }\n  }, [timezone, updateTimezone]);\n  return ___EmotionJSX(Select, { ariaLabel: t('Timezone selector'), css: /*#__PURE__*/_css({ minWidth: MIN_SELECT_WIDTH }, process.env.NODE_ENV === \"production\" ? \"\" : \";label:TimezoneSelector;\", process.env.NODE_ENV === \"production\" ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9teV9wbHVnaW4vc3VwZXJzZXQvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2NvbXBvbmVudHMvVGltZXpvbmVTZWxlY3Rvci9pbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBeUZ1RCIsImZpbGUiOiIvaG9tZS91YnVudHUvbXlfcGx1Z2luL3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9jb21wb25lbnRzL1RpbWV6b25lU2VsZWN0b3IvaW5kZXgudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50LXRpbWV6b25lJztcbmltcG9ydCB7IHQgfSBmcm9tICdAc3VwZXJzZXQtdWkvY29yZSc7XG5pbXBvcnQgeyBTZWxlY3QgfSBmcm9tICdzcmMvY29tcG9uZW50cyc7XG5jb25zdCBERUZBVUxUX1RJTUVaT05FID0ge1xuICAgIG5hbWU6ICdHTVQgU3RhbmRhcmQgVGltZScsXG4gICAgdmFsdWU6ICdBZnJpY2EvQWJpZGphbicsIC8vIHRpbWV6b25lcyBhcmUgZGVkdXBlZCBieSB0aGUgZmlyc3QgYWxwaGFiZXRpY2FsIHZhbHVlXG59O1xuY29uc3QgTUlOX1NFTEVDVF9XSURUSCA9ICc0MDBweCc7XG5jb25zdCBvZmZzZXRzVG9OYW1lID0ge1xuICAgICctMzAwLTI0MCc6IFsnRWFzdGVybiBTdGFuZGFyZCBUaW1lJywgJ0Vhc3Rlcm4gRGF5bGlnaHQgVGltZSddLFxuICAgICctMzYwLTMwMCc6IFsnQ2VudHJhbCBTdGFuZGFyZCBUaW1lJywgJ0NlbnRyYWwgRGF5bGlnaHQgVGltZSddLFxuICAgICctNDIwLTM2MCc6IFsnTW91bnRhaW4gU3RhbmRhcmQgVGltZScsICdNb3VudGFpbiBEYXlsaWdodCBUaW1lJ10sXG4gICAgJy00MjAtNDIwJzogW1xuICAgICAgICAnTW91bnRhaW4gU3RhbmRhcmQgVGltZSAtIFBob2VuaXgnLFxuICAgICAgICAnTW91bnRhaW4gU3RhbmRhcmQgVGltZSAtIFBob2VuaXgnLFxuICAgIF0sXG4gICAgJy00ODAtNDIwJzogWydQYWNpZmljIFN0YW5kYXJkIFRpbWUnLCAnUGFjaWZpYyBEYXlsaWdodCBUaW1lJ10sXG4gICAgJy01NDAtNDgwJzogWydBbGFza2EgU3RhbmRhcmQgVGltZScsICdBbGFza2EgRGF5bGlnaHQgVGltZSddLFxuICAgICctNjAwLTYwMCc6IFsnSGF3YWlpIFN0YW5kYXJkIFRpbWUnLCAnSGF3YWlpIERheWxpZ2h0IFRpbWUnXSxcbiAgICAnNjAxMjAnOiBbJ0NlbnRyYWwgRXVyb3BlYW4gVGltZScsICdDZW50cmFsIEV1cm9wZWFuIERheWxpZ2h0IFRpbWUnXSxcbiAgICAnMDAnOiBbREVGQVVMVF9USU1FWk9ORS5uYW1lLCBERUZBVUxUX1RJTUVaT05FLm5hbWVdLFxuICAgICcwNjAnOiBbJ0dNVCBTdGFuZGFyZCBUaW1lIC0gTG9uZG9uJywgJ0JyaXRpc2ggU3VtbWVyIFRpbWUnXSxcbn07XG5jb25zdCBjdXJyZW50RGF0ZSA9IG1vbWVudCgpO1xuY29uc3QgSkFOVUFSWSA9IG1vbWVudChbMjAyMSwgMV0pO1xuY29uc3QgSlVMWSA9IG1vbWVudChbMjAyMSwgN10pO1xuY29uc3QgZ2V0T2Zmc2V0S2V5ID0gKG5hbWUpID0+IEpBTlVBUlkudHoobmFtZSkudXRjT2Zmc2V0KCkudG9TdHJpbmcoKSArXG4gICAgSlVMWS50eihuYW1lKS51dGNPZmZzZXQoKS50b1N0cmluZygpO1xuY29uc3QgZ2V0VGltZXpvbmVOYW1lID0gKG5hbWUpID0+IHtcbiAgICBjb25zdCBvZmZzZXRzID0gZ2V0T2Zmc2V0S2V5KG5hbWUpO1xuICAgIHJldHVybiAoKGN1cnJlbnREYXRlLnR6KG5hbWUpLmlzRFNUKClcbiAgICAgICAgPyBvZmZzZXRzVG9OYW1lW29mZnNldHNdPy5bMV1cbiAgICAgICAgOiBvZmZzZXRzVG9OYW1lW29mZnNldHNdPy5bMF0pIHx8IG5hbWUpO1xufTtcbmNvbnN0IEFMTF9aT05FUyA9IG1vbWVudC50elxuICAgIC5jb3VudHJpZXMoKVxuICAgIC5tYXAoY291bnRyeSA9PiBtb21lbnQudHouem9uZXNGb3JDb3VudHJ5KGNvdW50cnksIHRydWUpKVxuICAgIC5mbGF0KCk7XG5jb25zdCBUSU1FWk9ORVMgPSBbXTtcbkFMTF9aT05FUy5mb3JFYWNoKHpvbmUgPT4ge1xuICAgIGlmICghVElNRVpPTkVTLmZpbmQob3B0aW9uID0+IGdldE9mZnNldEtleShvcHRpb24ubmFtZSkgPT09IGdldE9mZnNldEtleSh6b25lLm5hbWUpKSkge1xuICAgICAgICBUSU1FWk9ORVMucHVzaCh6b25lKTsgLy8gZGVkdXBlIHpvbmVzIGJ5IG9mZnNldHNcbiAgICB9XG59KTtcbmNvbnN0IFRJTUVaT05FX09QVElPTlMgPSBUSU1FWk9ORVMuc29ydChcbi8vIHNvcnQgYnkgb2Zmc2V0XG4oYSwgYikgPT4gbW9tZW50LnR6KGN1cnJlbnREYXRlLCBhLm5hbWUpLnV0Y09mZnNldCgpIC1cbiAgICBtb21lbnQudHooY3VycmVudERhdGUsIGIubmFtZSkudXRjT2Zmc2V0KCkpLm1hcCh6b25lID0+ICh7XG4gICAgbGFiZWw6IGBHTVQgJHttb21lbnRcbiAgICAgICAgLnR6KGN1cnJlbnREYXRlLCB6b25lLm5hbWUpXG4gICAgICAgIC5mb3JtYXQoJ1onKX0gKCR7Z2V0VGltZXpvbmVOYW1lKHpvbmUubmFtZSl9KWAsXG4gICAgdmFsdWU6IHpvbmUubmFtZSxcbiAgICBvZmZzZXRzOiBnZXRPZmZzZXRLZXkoem9uZS5uYW1lKSxcbn0pKTtcbmNvbnN0IFRpbWV6b25lU2VsZWN0b3IgPSAoeyBvblRpbWV6b25lQ2hhbmdlLCB0aW1lem9uZSB9KSA9PiB7XG4gICAgY29uc3QgcHJldlRpbWV6b25lID0gdXNlUmVmKHRpbWV6b25lKTtcbiAgICBjb25zdCBtYXRjaFRpbWV6b25lVG9PcHRpb25zID0gKHRpbWV6b25lKSA9PiBUSU1FWk9ORV9PUFRJT05TLmZpbmQob3B0aW9uID0+IG9wdGlvbi5vZmZzZXRzID09PSBnZXRPZmZzZXRLZXkodGltZXpvbmUpKVxuICAgICAgICA/LnZhbHVlIHx8IERFRkFVTFRfVElNRVpPTkUudmFsdWU7XG4gICAgY29uc3QgdXBkYXRlVGltZXpvbmUgPSB1c2VDYWxsYmFjaygodHopID0+IHtcbiAgICAgICAgLy8gdXBkYXRlIHRoZSByZWYgdG8gdHJhY2sgY2hhbmdlc1xuICAgICAgICBwcmV2VGltZXpvbmUuY3VycmVudCA9IHR6O1xuICAgICAgICAvLyB0aGUgcGFyZW50IGNvbXBvbmVudCBjb250YWlucyB0aGUgc3RhdGUgZm9yIHRoZSB2YWx1ZVxuICAgICAgICBvblRpbWV6b25lQ2hhbmdlKHR6KTtcbiAgICB9LCBbb25UaW1lem9uZUNoYW5nZV0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRUeiA9IG1hdGNoVGltZXpvbmVUb09wdGlvbnModGltZXpvbmUgfHwgbW9tZW50LnR6Lmd1ZXNzKCkpO1xuICAgICAgICBpZiAocHJldlRpbWV6b25lLmN1cnJlbnQgIT09IHVwZGF0ZWRUeikge1xuICAgICAgICAgICAgdXBkYXRlVGltZXpvbmUodXBkYXRlZFR6KTtcbiAgICAgICAgfVxuICAgIH0sIFt0aW1lem9uZSwgdXBkYXRlVGltZXpvbmVdKTtcbiAgICByZXR1cm4gKDxTZWxlY3QgYXJpYUxhYmVsPXt0KCdUaW1lem9uZSBzZWxlY3RvcicpfSBjc3M9e3sgbWluV2lkdGg6IE1JTl9TRUxFQ1RfV0lEVEggfX0gLy8gc21hbGxlc3Qgc2l6ZSBmb3IgY3VycmVudCB2YWx1ZXNcbiAgICAgb25DaGFuZ2U9e29uVGltZXpvbmVDaGFuZ2V9IHZhbHVlPXt0aW1lem9uZSB8fCBERUZBVUxUX1RJTUVaT05FLnZhbHVlfSBvcHRpb25zPXtUSU1FWk9ORV9PUFRJT05TfS8+KTtcbn07XG5leHBvcnQgZGVmYXVsdCBUaW1lem9uZVNlbGVjdG9yO1xuIl19 */\") // smallest size for current values\n    , onChange: onTimezoneChange, value: timezone || DEFAULT_TIMEZONE.value, options: TIMEZONE_OPTIONS });\n};\nexport default TimezoneSelector;","map":null,"metadata":{},"sourceType":"module"}